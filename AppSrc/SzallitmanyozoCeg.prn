Compiling Program: C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\SzallitmanyozoCeg.src
Memory Available: 2147483646
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\dfallent.pkd)
75288>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardCommandBarSystem.pkg)
75288>>>// these are all the packages used in a standard MDI menubar/toolbar system
75288>>>
75288>>>Use cCJCommandBarSystem.pkg
75288>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardMenuItemClasses.pkg)
75288>>>>>Use Dfpanel.pkg
75288>>>>>Use cCJCommandBarSystem.pkg
75288>>>>>Use LanguageText.pkg
75288>>>>>
75288>>>>>
75288>>>>>Class cCJUndoMenuItem is a cCJMenuItem
75289>>>>>    
75289>>>>>    Procedure Construct_Object
75291>>>>>        Forward Send Construct_Object
75293>>>>>        Set psCaption   to C_$CaptionUndo
75294>>>>>        Set psToolTip to C_$ToolTipUndo
75295>>>>>        Set psDescription to C_$DescUndo
75296>>>>>        Set psImage to "ActionUndo.ico"
75297>>>>>        Set pbActiveUpdate to True
75298>>>>>        Set psCategory to C_$CategoryEdit
75299>>>>>        Set psShortcut to C_$Key_Ctrl_Z
75300>>>>>    End_Procedure
75301>>>>>
75301>>>>>    Procedure OnExecute Variant vCommandBarControl
75303>>>>>        Send Undo of (focus(Self))
75304>>>>>    End_Procedure
75305>>>>>    
75305>>>>>    Function IsEnabled Returns Boolean
75307>>>>>        Boolean bEnabled
75307>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
75308>>>>>        Function_Return bEnabled
75309>>>>>    End_Function
75310>>>>>         
75310>>>>>End_Class
75311>>>>>
75311>>>>>
75311>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
75312>>>>>    
75312>>>>>    Procedure Construct_Object
75314>>>>>        Forward Send Construct_Object
75316>>>>>        Set psCaption   to C_$CaptionDelete
75317>>>>>        Set psToolTip to C_$ToolTipDelete
75318>>>>>        Set psDescription to C_$DescDelete
75319>>>>>        Set psImage to "actionDelete.ico"
75320>>>>>        Set psShortcut to C_$Key_Delete
75321>>>>>        Set pbActiveUpdate to True
75322>>>>>        Set psCategory to C_$CategoryEdit
75323>>>>>    End_Procedure
75324>>>>>
75324>>>>>
75324>>>>>    Procedure OnExecute Variant vCommandBarControl
75326>>>>>        Send Delete of (focus(Self))
75327>>>>>    End_Procedure
75328>>>>>    
75328>>>>>    Function IsEnabled Returns Boolean
75330>>>>>        Boolean bEnabled
75330>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
75331>>>>>        Function_Return bEnabled
75332>>>>>    End_Function
75333>>>>>         
75333>>>>>End_Class
75334>>>>>
75334>>>>>
75334>>>>>Class cCJCutMenuItem is a cCJMenuItem
75335>>>>>    
75335>>>>>    Procedure Construct_Object
75337>>>>>        Forward Send Construct_Object
75339>>>>>        Set psCaption   to C_$CaptionCut
75340>>>>>        Set psToolTip to C_$TooltipCut
75341>>>>>        Set psDescription to C_$DescCut
75342>>>>>        Set psImage to "actionCut.ico"
75343>>>>>        Set psShortcut to C_$Key_Ctrl_X
75344>>>>>        Set pbActiveUpdate to True
75345>>>>>        Set psCategory to C_$CategoryEdit
75346>>>>>    End_Procedure
75347>>>>>
75347>>>>>
75347>>>>>    Procedure OnExecute Variant vCommandBarControl
75349>>>>>        Send Cut of (focus(Self))
75350>>>>>    End_Procedure
75351>>>>>    
75351>>>>>    Function IsEnabled Returns Boolean
75353>>>>>        Boolean bEnabled
75353>>>>>        Get CanCut of (Focus(Self)) to bEnabled
75354>>>>>        Function_Return bEnabled
75355>>>>>    End_Function
75356>>>>>         
75356>>>>>End_Class
75357>>>>>
75357>>>>>
75357>>>>>Class cCJCopyMenuItem is a cCJMenuItem
75358>>>>>    
75358>>>>>    Procedure Construct_Object
75360>>>>>        Forward Send Construct_Object
75362>>>>>        Set psCaption   to C_$CaptionCopy
75363>>>>>        Set psToolTip to C_$ToolTipCopy
75364>>>>>        Set psDescription to C_$DescCopy
75365>>>>>        Set psImage to "actionCopy.ico"
75366>>>>>        Set psShortcut to C_$Key_Ctrl_C
75367>>>>>        Set pbActiveUpdate to True
75368>>>>>        Set psCategory to C_$CategoryEdit
75369>>>>>    End_Procedure
75370>>>>>
75370>>>>>
75370>>>>>    Procedure OnExecute Variant vCommandBarControl
75372>>>>>        Send Copy of (focus(Self))
75373>>>>>    End_Procedure
75374>>>>>    
75374>>>>>    Function IsEnabled Returns Boolean
75376>>>>>        Boolean bEnabled
75376>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
75377>>>>>        Function_Return bEnabled
75378>>>>>    End_Function
75379>>>>>         
75379>>>>>End_Class
75380>>>>>
75380>>>>>
75380>>>>>Class cCJPasteMenuItem is a cCJMenuItem
75381>>>>>    
75381>>>>>    Procedure Construct_Object
75383>>>>>        Forward Send Construct_Object
75385>>>>>        Set psCaption   to C_$CaptionPaste
75386>>>>>        Set psToolTip to C_$ToolTipPaste
75387>>>>>        Set psDescription to C_$DescPaste
75388>>>>>        Set psImage to "actionPaste.ico"
75389>>>>>        Set pbActiveUpdate to True
75390>>>>>        Set psShortcut to C_$Key_Ctrl_V
75391>>>>>        Set psCategory to C_$CategoryEdit
75392>>>>>    End_Procedure
75393>>>>>
75393>>>>>
75393>>>>>    Procedure OnExecute Variant vCommandBarControl
75395>>>>>        Send Paste of (focus(Self))
75396>>>>>    End_Procedure
75397>>>>>    
75397>>>>>    Function IsEnabled Returns Boolean
75399>>>>>        Boolean bEnabled
75399>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
75400>>>>>        Function_Return bEnabled
75401>>>>>    End_Function
75402>>>>>         
75402>>>>>End_Class
75403>>>>>
75403>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
75404>>>>>    
75404>>>>>    Procedure Construct_Object
75406>>>>>        Forward Send Construct_Object
75408>>>>>        Set psCaption   to C_$CaptionSelectAll
75409>>>>>        Set psToolTip to C_$ToolTipSelectAll
75410>>>>>        Set psDescription to C_$DescSelectAll
75411>>>>>        Set pbActiveUpdate to True
75412>>>>>        Set psShortcut to C_$Key_Ctrl_A
75413>>>>>        Set psCategory to C_$CategoryEdit
75414>>>>>    End_Procedure
75415>>>>>
75415>>>>>
75415>>>>>    Procedure OnExecute Variant vCommandBarControl
75417>>>>>        Send Select_All of (focus(Self))
75418>>>>>    End_Procedure
75419>>>>>    
75419>>>>>    Function IsEnabled Returns Boolean
75421>>>>>        Boolean bEnabled
75421>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
75422>>>>>        Function_Return bEnabled
75423>>>>>    End_Function
75424>>>>>         
75424>>>>>End_Class
75425>>>>>
75425>>>>> 
75425>>>>>Class cCJExitMenuItem is a cCJMenuItem
75426>>>>>
75426>>>>>    Procedure Construct_Object
75428>>>>>        Forward Send Construct_Object
75430>>>>>        Set psCaption to C_$CaptionExit
75431>>>>>        Set psToolTip to C_$ToolTipExit
75432>>>>>        Set psDescription to C_$ToolTipExit
75433>>>>>        Set psShortcut to C_$Key_Alt_F4
75434>>>>>        Set psCategory to C_$CategoryFile
75435>>>>>    End_Procedure
75436>>>>>
75436>>>>>    Procedure OnExecute Variant vCommandBarControl
75438>>>>>        Send Exit_Application of Desktop
75439>>>>>    End_Procedure
75440>>>>>
75440>>>>>End_Class           
75441>>>>>
75441>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
75442>>>>>
75442>>>>>    Procedure Construct_Object
75444>>>>>        Forward Send Construct_Object
75446>>>>>        Set psCaption to C_$CaptionHelp
75447>>>>>        Set psDescription to C_$ToolTipHelp
75448>>>>>        Set psToolTip to C_$DescHelp
75449>>>>>        Set psImage to "ActionHelp.ico"
75450>>>>>        Set psShortcut to "F1"
75451>>>>>        Set psCategory to C_$CategoryHelp
75452>>>>>    End_Procedure
75453>>>>>    
75453>>>>>    Procedure OnExecute Variant vCommandBarControl
75455>>>>>        Send Help of (Focus(Self))
75456>>>>>    End_Procedure
75457>>>>>
75457>>>>>End_Class
75458>>>>>
75458>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
75459>>>>>
75459>>>>>    Procedure Construct_Object
75461>>>>>        Forward Send Construct_Object
75463>>>>>        Set psCaption to C_$CaptionAddStatusbar
75464>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
75465>>>>>        Set psDescription to  C_$DescAddStatusbar
75466>>>>>        Set psCategory to C_$CategoryWindow
75467>>>>>    End_Procedure
75468>>>>>
75468>>>>>    Procedure OnExecute Variant vCommandBarControl
75470>>>>>        Handle hoCommandBars hoClientArea
75470>>>>>        Get CommandBarSystemObject to hoCommandBars
75471>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75472>>>>>        If hoClientArea Begin
75474>>>>>            // the clientarea's parent panel has message
75474>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
75475>>>>>        End
75475>>>>>>
75475>>>>>    End_Procedure
75476>>>>>
75476>>>>>     Function IsChecked Returns Boolean
75478>>>>>        Boolean bOn
75478>>>>>        Handle hoCommandBars hoClientArea
75478>>>>>        Get CommandBarSystemObject to hoCommandBars
75479>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75480>>>>>        If hoClientArea Begin
75482>>>>>            // the clientarea's parent panel has message
75482>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
75483>>>>>        End
75483>>>>>>
75483>>>>>        Function_Return bOn
75484>>>>>     End_Function
75485>>>>>End_Class
75486>>>>>
75486>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
75487>>>>>
75487>>>>>    Procedure Construct_Object
75489>>>>>        Forward Send Construct_Object
75491>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
75492>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
75493>>>>>        Set psDescription to C_$DescAutoArrangeIcons
75494>>>>>        Set psCategory to C_$CategoryWindow
75495>>>>>    End_Procedure
75496>>>>>
75496>>>>>    Procedure OnExecute Variant vCommandBarControl
75498>>>>>        Handle hoCommandBars hoClientArea
75498>>>>>        Get CommandBarSystemObject to hoCommandBars
75499>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75500>>>>>        If hoClientArea Begin
75502>>>>>            // the clientarea's parent panel has message
75502>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
75503>>>>>        End
75503>>>>>>
75503>>>>>    End_Procedure
75504>>>>>    
75504>>>>>     Function IsChecked Returns Boolean
75506>>>>>        Boolean bOn
75506>>>>>        Handle hoCommandBars hoClientArea
75506>>>>>        Get CommandBarSystemObject to hoCommandBars
75507>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75508>>>>>        If hoClientArea Begin
75510>>>>>            // the clientarea's parent panel has message
75510>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
75511>>>>>        End
75511>>>>>>
75511>>>>>        Function_Return bOn
75512>>>>>     End_Function
75513>>>>>End_Class
75514>>>>>
75514>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
75515>>>>>
75515>>>>>    Procedure Construct_Object
75517>>>>>        Forward Send Construct_Object
75519>>>>>        Set psCaption to C_$CaptionRestoreMenus
75520>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
75521>>>>>        Set psDescription to C_$DescRestoreMenus
75522>>>>>        Set psCategory to C_$CategoryWindow
75523>>>>>    End_Procedure
75524>>>>>
75524>>>>>    Procedure OnExecute Variant vCommandBarControl
75526>>>>>        Handle hoCommandBars
75526>>>>>        Get CommandBarSystemObject to hoCommandBars
75527>>>>>        Send RestoreLayout of hoCommandBars
75528>>>>>    End_Procedure
75529>>>>>    
75529>>>>>End_Class
75530>>>>>
75530>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
75531>>>>>
75531>>>>>    Procedure Construct_Object
75533>>>>>        Forward Send Construct_Object
75535>>>>>        Set psCaption to C_$CaptionCascade
75536>>>>>        Set psToolTip to C_$ToolTipCascade
75537>>>>>        Set psDescription to  C_$DescCascade
75538>>>>>        Set psImage to "ActionCascade.ico"
75539>>>>>        Set psCategory to C_$CategoryWindow
75540>>>>>    End_Procedure
75541>>>>>    
75541>>>>>    Procedure OnExecute Variant vCommandBarControl
75543>>>>>        Handle hoCommandBars hoClientArea
75543>>>>>        Get CommandBarSystemObject to hoCommandBars
75544>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75545>>>>>        If hoClientArea Begin
75547>>>>>            Send Cascade_Windows of hoClientArea
75548>>>>>        End
75548>>>>>>
75548>>>>>    End_Procedure
75549>>>>>End_Class
75550>>>>>
75550>>>>>Class cCJTileHorizontally is a cCJMenuItem
75551>>>>>
75551>>>>>    Procedure Construct_Object
75553>>>>>        Forward Send Construct_Object
75555>>>>>        Set psCaption to C_$CaptionTileHorizontally 
75556>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
75557>>>>>        Set psDescription to  C_$DescTileHorizontally
75558>>>>>        Set psImage to "ActionTileHorizontally.ico"
75559>>>>>        Set psCategory to C_$CategoryWindow
75560>>>>>    End_Procedure
75561>>>>>
75561>>>>>    Procedure OnExecute Variant vCommandBarControl
75563>>>>>        Handle hoCommandBars hoClientArea
75563>>>>>        Get CommandBarSystemObject to hoCommandBars
75564>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75565>>>>>        If hoClientArea Begin
75567>>>>>            Send Tile_Windows_Horizontal of hoClientArea
75568>>>>>        End
75568>>>>>>
75568>>>>>    End_Procedure
75569>>>>>End_Class
75570>>>>>
75570>>>>>Class cCJTileVertically is a cCJMenuItem
75571>>>>>
75571>>>>>    Procedure Construct_Object
75573>>>>>        Forward Send Construct_Object
75575>>>>>        Set psCaption to C_$CaptionTileVertically  
75576>>>>>        Set psToolTip to C_$ToolTipTileVertically
75577>>>>>        Set psDescription to  C_$DescTileVertically
75578>>>>>        Set psImage to "ActionTileVertically.ico"
75579>>>>>        Set psCategory to C_$CategoryWindow
75580>>>>>    End_Procedure
75581>>>>>
75581>>>>>    Procedure OnExecute Variant vCommandBarControl
75583>>>>>        Handle hoCommandBars hoClientArea
75583>>>>>        Get CommandBarSystemObject to hoCommandBars
75584>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75585>>>>>        If hoClientArea Begin
75587>>>>>            Send Tile_Windows_Vertical of hoClientArea
75588>>>>>        End
75588>>>>>>
75588>>>>>    End_Procedure
75589>>>>>End_Class
75590>>>>>
75590>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
75591>>>>>
75591>>>>>    Procedure Construct_Object
75593>>>>>        Forward Send Construct_Object
75595>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
75596>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
75597>>>>>        Set psDescription to  C_$DescMinimizeWindows
75598>>>>>        Set psCategory to C_$CategoryWindow
75599>>>>>    End_Procedure
75600>>>>>
75600>>>>>    Procedure OnExecute Variant vCommandBarControl
75602>>>>>        Handle hoCommandBars hoClientArea
75602>>>>>        Get CommandBarSystemObject to hoCommandBars
75603>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75604>>>>>        If hoClientArea Begin
75606>>>>>            // the clientarea's parent panel has message
75606>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
75607>>>>>        End
75607>>>>>>
75607>>>>>    End_Procedure
75608>>>>>End_Class
75609>>>>>
75609>>>>>
75609>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
75610>>>>>
75610>>>>>    Procedure Construct_Object
75612>>>>>        Forward Send Construct_Object
75614>>>>>        Set psCaption to C_$CaptionRestoreWindows
75615>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
75616>>>>>        Set psDescription to  C_$DescRestoreWindows
75617>>>>>        Set psCategory to C_$CategoryWindow
75618>>>>>    End_Procedure
75619>>>>>
75619>>>>>    Procedure OnExecute Variant vCommandBarControl
75621>>>>>        Handle hoCommandBars hoClientArea
75621>>>>>        Get CommandBarSystemObject to hoCommandBars
75622>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75623>>>>>        If hoClientArea Begin
75625>>>>>            // the clientarea's parent panel has message
75625>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
75626>>>>>        End
75626>>>>>>
75626>>>>>    End_Procedure
75627>>>>>End_Class
75628>>>>>
75628>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
75629>>>>>
75629>>>>>    Procedure Construct_Object
75631>>>>>        Forward Send Construct_Object
75633>>>>>        Set psCaption to C_$CaptionArrangeIcons  
75634>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
75635>>>>>        Set psDescription to  C_$DescArrangeIcons
75636>>>>>        Set psCategory to C_$CategoryWindow
75637>>>>>    End_Procedure
75638>>>>>
75638>>>>>    Procedure OnExecute Variant vCommandBarControl
75640>>>>>        Handle hoCommandBars hoClientArea
75640>>>>>        Get CommandBarSystemObject to hoCommandBars
75641>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75642>>>>>        If hoClientArea Begin
75644>>>>>            Send Arrange_Icons of hoClientArea
75645>>>>>        End
75645>>>>>>
75645>>>>>    End_Procedure
75646>>>>>
75646>>>>>End_Class
75647>>>>>    
75647>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJAboutMenuItem.pkg)
75647>>>>>Use cCJCommandBarSystem.pkg
75647>>>>>Use LanguageText.pkg
75647>>>>>
75647>>>>>// It is expected that if you use this class that you provide an about object that is
75647>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
75647>>>>>// because you may wish to create your own custom about package.
75647>>>>>
75647>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
75648>>>>>
75648>>>>>    Procedure Construct_Object
75650>>>>>        Forward Send Construct_Object
75652>>>>>        Set psCaption to C_$CaptionAbout
75653>>>>>        Set psDescription to C_$ToolTipAbout
75654>>>>>        Set psToolTip to C_$DescAbout
75655>>>>>        Set psImage to "ActionAbout.ico"
75656>>>>>        Set psCategory to C_$CategoryHelp
75657>>>>>    End_Procedure
75658>>>>>    
75658>>>>>    Procedure OnExecute Variant vCommandBarControl
75660>>>>>        Handle hoCommandBars hoClientArea
75660>>>>>        Get CommandBarSystemObject to hoCommandBars
75661>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75662>>>>>        If hoClientArea Begin
75664>>>>>            Send Activate_About of hoClientArea
75665>>>>>        End
75665>>>>>>
75665>>>>>    End_Procedure
75666>>>>>
75666>>>>>End_Class
75667>>>>>
75667>>>>>
75667>>>Use cCJDeoMenuItemClasses.pkg
75667>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJMDIWindowsMenuItem.pkg)
75667>>>>>Use cCJCommandBarSystem.pkg
75667>>>>>
75667>>>>>Register_Function Client_ID Returns Integer
75667>>>>>
75667>>>>>// only used by cCJMDIWIndowsMenuItem
75667>>>>>Class cCJMDIWindowItem is a cCJMenuItem
75668>>>>>
75668>>>>>    Procedure Construct_Object
75670>>>>>        Forward Send Construct_Object
75672>>>>>        Property Handle phWindow 0 // object id of view
75673>>>>>        Set pbControlFlagNoMovable to True
75674>>>>>        Set pbActiveUpdate to True
75675>>>>>    End_Procedure
75676>>>>>    
75676>>>>>    Procedure OnExecute Variant vCommandBarControl
75678>>>>>        Handle hWindow
75678>>>>>        Get phWindow to hWindow
75679>>>>>        Send Activate_View of hWindow
75680>>>>>    End_Procedure
75681>>>>>    
75681>>>>>End_Class                
75682>>>>>
75682>>>>>
75682>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
75683>>>>>    
75683>>>>>    Procedure Construct_Object
75685>>>>>        Forward Send Construct_Object
75687>>>>>        Property Handle[] phArrayOfWindows
75688>>>>>        Set peControlType to xtpControlPopup
75689>>>>>        Set psCategory to C_$CategoryWindow
75690>>>>>    End_Procedure
75691>>>>>    
75691>>>>>     // This adds MDI windows to the existing menu items.
75691>>>>>     // This removes any existing windows menus and always adds a new set to the end
75691>>>>>
75691>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
75693>>>>>        Handle  hClientArea hView
75693>>>>>        String  sLabel
75693>>>>>        Integer i iWindows
75693>>>>>        Handle[] hArrayOfWindows
75694>>>>>        Variant vItem
75694>>>>>        
75694>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
75694>>>>>        // also assume that destroying an action removes all menu instances of that action
75694>>>>>        Get phArrayOfWindows to hArrayOfWindows
75695>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
75696>>>>>        For i from 0 to (iWindows-1)
75702>>>>>>
75702>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
75703>>>>>        Loop
75704>>>>>>
75704>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
75705>>>>>
75705>>>>>        // Add all views to this menu. Create the action and add the item
75705>>>>>        Move 0 to i
75706>>>>>        Get Client_Id to hClientArea // object id of client area
75707>>>>>        If (hClientArea > 0) Begin
75709>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
75710>>>>>            While (hView <> 0)
75714>>>>>                If (Active_State(hView)) Begin
75716>>>>>                    // create the action
75716>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
75717>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
75718>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
75719>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
75720>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
75722>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
75723>>>>>                    End
75723>>>>>>
75723>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
75724>>>>>                    If (i=0) Begin
75726>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
75727>>>>>                    End
75727>>>>>>
75727>>>>>                    // Create a menu item for this action
75727>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
75728>>>>>                    Increment i
75729>>>>>                End
75729>>>>>>
75729>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
75730>>>>>            Loop
75731>>>>>>
75731>>>>>        End
75731>>>>>>
75731>>>>>
75731>>>>>        Set phArrayOfWindows to hArrayOfWindows
75732>>>>>
75732>>>>>     End_Procedure
75733>>>>>     
75733>>>>>End_Class
75734>>>>>
75734>
75734>Object oHtmlHelp is a cHtmlHelp
75736>End_Object
75737>
75737>Object oApplication is a cApplication
75739>    Set peHelpType to htHtmlHelp
75740>End_Object
75741>
75741>Object oToolTipController is a cToolTipController
75743>    Move Self to ghoToolTipController
75744>End_Object
75745>
75745>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oEditContextMenu.pkg)
75745>>>Use cCJStandardMenuItemClasses.pkg
75745>>>
75745>>>Object oEditContextMenu is a cCJContextMenu
75747>>>    
75747>>>    Move Self to Default_Form_Floating_Menu_ID
75748>>>    
75748>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75750>>>    End_Object
75751>>>    
75751>>>    Object oCutMenuItem is a cCJCutMenuItem
75753>>>        Set pbControlBeginGroup to True
75754>>>    End_Object
75755>>>    
75755>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75757>>>    End_Object
75758>>>
75758>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75760>>>    End_Object
75761>>>
75761>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75763>>>    End_Object
75764>>>
75764>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75766>>>        Set pbControlBeginGroup to True
75767>>>    End_Object
75768>>>
75768>>>End_Object
75769>>>
75769>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oDEOEditContextMenu17.pkg)
75769>>>Use Windows.pkg
75769>>>Use cCJStandardMenuItemClasses.pkg
75769>>>Use cCJDeoMenuItemClasses.pkg
75769>>>
75769>>>
75769>>>Object oDEOEditContextMenu17 is a cCJContextMenu
75771>>>    
75771>>>    Move Self to Default_dbFloating_Menu_ID
75772>>>    
75772>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75774>>>    End_Object
75775>>>    
75775>>>    Object oCutMenuItem is a cCJCutMenuItem
75777>>>        Set pbControlBeginGroup to True
75778>>>    End_Object
75779>>>    
75779>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75781>>>    End_Object
75782>>>
75782>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75784>>>    End_Object
75785>>>
75785>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75787>>>    End_Object
75788>>>
75788>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75790>>>        Set pbControlBeginGroup to True
75791>>>    End_Object
75792>>>
75792>>>    Object oPromptMenuItem is a cCJPromptMenuItem
75794>>>        Set pbControlBeginGroup to True
75795>>>    End_Object
75796>>>
75796>>>    Object oFindNextMenu is a cCJFindNextMenuItem
75798>>>        Set pbControlBeginGroup to True
75799>>>    End_Object
75800>>>
75800>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75802>>>    End_Object
75803>>>
75803>>>    Object oClearMenuItem is a cCJClearMenuItem
75805>>>        Set pbControlBeginGroup to True
75806>>>    End_Object
75807>>>
75807>>>    Object oClearAllMenu is a cCJClearAllMenuItem
75809>>>    End_Object
75810>>>
75810>>>    Object oSaveMenu is a cCJSaveMenuItem
75812>>>    End_Object
75813>>>    
75813>>>    Object oDeleteMenu is a cCJDeleteMenuItem
75815>>>    End_Object
75816>>>
75816>>>    Object oRememberitem is a cCJRememberFieldMenuItem
75818>>>        Set pbControlBeginGroup to True
75819>>>    End_Object
75820>>>
75820>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
75822>>>    End_Object
75823>>>
75823>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
75825>>>    End_Object
75826>>>
75826>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
75828>>>    End_Object
75829>>>
75829>>>End_Object
75830>
75830>Object oMain is a Panel
75832>    Set Label to "Fuvaroz s management"
75833>    Set Location to 4 3
75834>    Set Size to 300 450
75835>
75835>    Object oCommandBarSystem is a cCJCommandBarSystem
75837>        Set pbTimerUpdate to True
75838>
75838>        Procedure OnCreateCommandBars
75841>            Handle hoOptions
75841>            Get OptionsObject to hoOptions
75842>            Forward Send OnCreateCommandBars
75844>        End_Procedure
75845>
75845>        Object oMenuBar is a cCJMenuBar
75847>
75847>            Object oFileMenu is a cCJMenuItem
75849>                Set peControlType to xtpControlPopup          
75850>                Set psCaption   to "&File"
75851>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
75852>                Set psCategory to "Menus"
75853>
75853>                Object oClearMenuItem is a cCJClearMenuItem
75855>                    Set pbAddToDesignerMenu to True
75856>                End_Object
75857>
75857>                Object oClearAllMenu is a cCJClearAllMenuItem
75859>                    Set pbAddToDesignerMenu to True
75860>                End_Object
75861>
75861>                Object oPromptMenuItem is a cCJPromptMenuItem
75863>                    Set pbAddToDesignerMenu to True
75864>                    Set pbControlBeginGroup to True
75865>                End_Object
75866>
75866>                Object oFindMenuItem is a cCJFindMenuItem
75868>                    Set pbAddToDesignerMenu to True
75869>                    Set pbControlBeginGroup to True
75870>                End_Object
75871>
75871>                Object oFindNextMenu is a cCJFindNextMenuItem
75873>                    Set pbAddToDesignerMenu to True
75874>                End_Object
75875>
75875>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75877>                    Set pbAddToDesignerMenu to True
75878>                End_Object
75879>
75879>                Object oFindFirstMenu is a cCJFindFirstMenuItem
75881>                    Set pbAddToDesignerMenu to True
75882>                End_Object
75883>
75883>                Object oFindLastMenu is a cCJFindLastMenuItem
75885>                    Set pbAddToDesignerMenu to True
75886>                End_Object
75887>
75887>                Object oSaveMenuItem is a cCJSaveMenuItem
75889>                    Set pbAddToDesignerMenu to True
75890>                    Set pbControlBeginGroup to True
75891>                End_Object
75892>
75892>                Object oDeleteMenuItem is a cCJDeleteMenuItem
75894>                    Set pbAddToDesignerMenu to True
75895>                End_Object
75896>
75896>                Object oExitMenu is a cCJExitMenuItem
75898>                    Set pbControlBeginGroup to True
75899>                End_Object
75900>
75900>            End_Object
75901>
75901>            Object oViewMenu is a cCJMenuItem
75903>                Set peControlType to xtpControlPopup
75904>                Set psCaption to "&View"
75905>                Set psToolTip to "View"
75906>                Set psDescription to "Available Views"
75907>
75907>                Object oAutoEntryMenuItem is a cCJMenuItem
75909>                    Set psCaption to "AutoEntry"
75910>                    Set psTooltip to "AutoEntry"
75911>                
75911>                    Procedure OnExecute Variant vCommandBarControl
75914>                        Handle hoClient
75914>                        Get Client_Id to hoClient
75915>                        Send Activate_oAutoEntry of hoClient
75916>                    End_Procedure
75917>                End_Object
75918>
75918>                Object oSoforEntryMenuItem is a cCJMenuItem
75920>                    Set psCaption to "SoforEntry"
75921>                    Set psTooltip to "SoforEntry"
75922>                
75922>                    Procedure OnExecute Variant vCommandBarControl
75925>                        Handle hoClient
75925>                        Get Client_Id to hoClient
75926>                        Send Activate_oSoforEntry of hoClient
75927>                    End_Procedure
75928>                End_Object
75929>
75929>                Object oTermkMenuItem is a cCJMenuItem
75931>                    Set psCaption to "Term‚k"
75932>                    Set psTooltip to "Term‚k"
75933>                
75933>                    Procedure OnExecute Variant vCommandBarControl
75936>                        Handle hoClient
75936>                        Get Client_Id to hoClient
75937>                        Send Activate_oTermekEntry of hoClient
75938>                    End_Procedure
75939>                End_Object
75940>
75940>                Object oFuvarlevlMenuItem is a cCJMenuItem
75942>                    Set psCaption to "Fuvarlev‚l"
75943>                    Set psTooltip to "Fuvarlev‚l"
75944>                
75944>                    Procedure OnExecute Variant vCommandBarControl
75947>                        Handle hoClient
75947>                        Get Client_Id to hoClient
75948>                        Send Activate_oFuvarLevelEntry of hoClient
75949>                    End_Procedure
75950>                End_Object
75951>
75951>                Object oFuvarlevlttelMenuItem is a cCJMenuItem
75953>                    Set psCaption to "Fuvarlev‚l t‚tel"
75954>                    Set psTooltip to "Fuvarlev‚l t‚tel"
75955>                
75955>                    Procedure OnExecute Variant vCommandBarControl
75958>                        Handle hoClient
75958>                        Get Client_Id to hoClient
75959>                        Send Activate_oFuvarlevelTetelEntry of hoClient
75960>                    End_Procedure
75961>                End_Object
75962>            End_Object
75963>            
75963>            Object oReportMenu is a cCJMenuItem
75965>                Set peControlType to xtpControlPopup          
75966>                Set psCaption to "&Report"
75967>                Set psToolTip to "Report"
75968>                Set psDescription to "Available Reports"
75969>            End_Object
75970>
75970>            Object oNavigateMenu is a cCJMenuItem
75972>                Set peControlType to xtpControlPopup      
75973>                Set psCaption to "&Navigate"    
75974>                Set psTooltip to "Navigate"    
75975>                Set psDescription to "Move to different areas of the application"
75976>
75976>                Object oNextAreaMenu is a cCJNextAreaMenu
75978>                End_Object
75979>
75979>                Object oPriorAreaMenu is a cCJPriorAreaMenu
75981>                End_Object
75982>
75982>                Object oNextViewMenu is a cCJNextViewMenu
75984>                End_Object
75985>
75985>                Object oPriorViewMenu is a cCJPriorViewMenu
75987>                End_Object
75988>
75988>                Object oPromptMenu is a cCJPromptMenuItem
75990>                    Set pbControlBeginGroup to True
75991>                End_Object
75992>
75992>                Object oZoomMenu is a cCJZoomMenuItem
75994>                End_Object
75995>
75995>            End_Object
75996>
75996>            Object oWindowMenu is a cCJMDIWindowsMenuItem
75998>                Set peControlType to xtpControlPopup
75999>                Set psCaption to "&Window"
76000>                Set psToolTip to "Window"
76001>                Set psDescription to "Display Current Views and set other display options."    
76002>
76002>                // These are the static windows items. More will be created in onInitPopup 
76002>                Object oDisplayOptionsMenu is a cCJMenuItem
76004>                    Set peControlType to xtpControlPopup          
76005>                    Set psCaption to "&Display Options"
76006>                    Set psToolTip to "Display Options"
76007>                    Set psDescription to "Set display options"
76008>
76008>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
76010>                    End_Object
76011>
76011>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
76013>                    End_Object
76014>
76014>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
76016>                        Set pbControlBeginGroup to True
76017>                    End_Object
76018>
76018>                End_Object
76019>
76019>                Object oCascadeMenu is a cCJCascadeMenuItem
76021>                    Set pbControlBeginGroup to True
76022>                End_Object
76023>
76023>                Object oHorizTile is a cCJTileHorizontally
76025>                End_Object
76026>
76026>                Object oVertTile is a cCJTileVertically
76028>                End_Object
76029>
76029>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
76031>                    Set pbControlBeginGroup to True
76032>                End_Object
76033>
76033>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
76035>                End_Object
76036>
76036>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
76038>                    Set pbControlBeginGroup to True
76039>                End_Object
76040>
76040>            End_Object
76041>
76041>            Object oHelpMenu is a cCJMenuItem
76043>                Set peControlType to xtpControlPopup    
76044>                Set psCaption to "&Help"
76045>                Set psDescription to "Access Information for learning and using this DataFlex application."
76046>                Set psToolTip to "Help"
76047>
76047>                Object oHelpMenuItem is a cCJHelpMenuItem 
76049>                End_Object
76050>
76050>                Object oAboutMenuItem is a cCJAboutMenuItem
76052>                End_Object
76053>
76053>            End_Object
76054>
76054>        End_Object
76055>
76055>        Object oFindToolBar is a cCJToolbar
76057>            Set psTitle to "Finding Toolbar"
76058>
76058>            Object oFindFirstTool is a cCJFindFirstMenuItem
76060>            End_Object
76061>
76061>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
76063>            End_Object
76064>
76064>            Object oFindMenuTool is a cCJFindMenuItem
76066>            End_Object
76067>
76067>            Object oFindNextTool is a cCJFindNextMenuItem
76069>            End_Object
76070>
76070>            Object oFindLastTool is a cCJFindLastMenuItem
76072>            End_Object
76073>
76073>            Object oPromptToolItem is a cCJPromptMenuItem
76075>                Set pbControlBeginGroup to True
76076>            End_Object
76077>
76077>        End_Object
76078>
76078>        Object oFileToolBar is a cCJToolbar
76080>            Set psTitle to "Data Entry Toolbar"
76081>
76081>            Object oClearToolItem is a cCJClearMenuItem
76083>                Set peControlStyle to xtpButtonIconAndCaption
76084>            End_Object
76085>
76085>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
76087>                Set peControlStyle to xtpButtonIconAndCaption
76088>            End_Object
76089>
76089>            Object oSaveToolItem is a cCJSaveMenuItem
76091>                Set peControlStyle to xtpButtonIconAndCaption
76092>                Set pbControlBeginGroup to True
76093>            End_Object
76094>
76094>            Object oDeleteToolItem is a cCJDeleteMenuItem
76096>                Set peControlStyle to xtpButtonIconAndCaption
76097>            End_Object
76098>
76098>        End_Object
76099>
76099>        Object oEditToolBar is a cCJToolbar
76101>            Set psTitle to "Edit Toolbar"
76102>
76102>            Object oCutToolbarItem is a cCJCutMenuItem
76104>            End_Object
76105>
76105>            Object oCopyToolbarItem is a cCJCopyMenuItem
76107>            End_Object
76108>
76108>            Object oPasteToolbarItem is a cCJPasteMenuItem
76110>            End_Object
76111>
76111>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
76113>                Set pbControlBeginGroup to True
76114>            End_Object
76115>
76115>        End_Object
76116>
76116>        Object oRememberToolbar is a cCJToolbar
76118>            Set psTitle to C_$Remember
76119>
76119>            Object oRememberItems is a cCJMenuItem
76121>
76121>                Set peControlType to xtpControlPopup
76122>                Set peControlStyle to xtpButtonCaption
76123>                Set psCaption to C_$Remember
76124>                
76124>                Object oMenuItem is a cCJRememberFieldMenuItem
76126>                    Set peControlStyle to xtpButtonIconAndCaption
76127>                End_Object
76128>                
76128>                Object oMenuItem is a cCJRememberLastFieldMenuItem
76130>                    Set peControlStyle to xtpButtonIconAndCaption
76131>                End_Object
76132>                
76132>                Object oMenuItem is a cCJUnRememberFieldMenuItem
76134>                    Set peControlStyle to xtpButtonIconAndCaption
76135>                End_Object
76136>                
76136>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
76138>                    Set peControlStyle to xtpButtonIconAndCaption
76139>                End_Object
76140>
76140>            End_Object
76141>            
76141>        End_Object
76142>        
76142>        Object oStatusBar is a cCJStatusBar
76144>
76144>            Object oStatusPane1 is a cCJStatusBarPane
76146>                Set piID to sbpIDIdlePane
76147>                Set pbStyleStretch to True
76148>            End_Object
76149>
76149>            Object oStatusPane2 is a cCJStatusBarPane
76151>                Set phoViewPane to Self
76152>                Set pbStyleStretch to True
76153>            End_Object
76154>
76154>        End_Object
76155>
76155>    End_Object
76156>
76156>    Object oClientArea is a ClientArea
76158>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\StdAbout.pkg)
76158>>>//************************************************************************
76158>>>// Confidential Trade Secret.
76158>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76158>>>// as an unpublished work.  All rights reserved.
76158>>>// DataFlex is a registered trademark of Data Access Corporation.
76158>>>//
76158>>>//************************************************************************
76158>>>//************************************************************************
76158>>>//
76158>>>// $File name  : StdAbout.pkg
76158>>>// $File title : Standard about object package for VDF
76158>>>// Notice      :
76158>>>// $Author(s)  : John Tuohy
76158>>>//
76158>>>// $Rev History
76158>>>//
76158>>>// JT 06/27/97   File created
76158>>>//************************************************************************
76158>>>
76158>>>// This provides a quick and simple way to create an about package for a program.
76158>>>// You need to create a message inside you client area called Activate_About.
76158>>>// Within this message you should send the message DoAbout passing needed
76158>>>// string information.
76158>>>//
76158>>>//       Procedure Activate_About
76158>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
76158>>>//       End_Procedure
76158>>>//    where: sTitle =     Name of application. If none provided, uses caption
76158>>>//                        bar title
76158>>>//           sVersion   = Version Line. If none provided, will be blank
76158>>>//           sCopyRight = Copyright Line. If none provided, will be blank
76158>>>//           sAuthor    = Author name, blank if none provided
76158>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
76158>>>//                        is used.
76158>>>// It is expected that you will place this in your own object package. For
76158>>>// example an order about package may look like this:
76158>>>//
76158>>>//   // OrderAbout.pkg
76158>>>//   Use StdAbout.pkg
76158>>>//   Procedure Activate_About
76158>>>//      String sTitle sCopyright sVersion sAuthor
76158>>>//      Move "My Order Entry System" to sTitle
76158>>>//      Move "Version 2.1" to sVersion
76158>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
76158>>>//      Move "John Smith"  to sAuthor
76158>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
76158>>>//   end_procedure
76158>>>//   // end of file.
76158>>>
76158>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\Dfabout.pkg)
76158>>>>>//************************************************************************
76158>>>>>// Confidential Trade Secret.
76158>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76158>>>>>// as an unpublished work.  All rights reserved.
76158>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
76158>>>>>//
76158>>>>>//************************************************************************
76158>>>>>//************************************************************************
76158>>>>>//
76158>>>>>// $File name  : DfAbout.pkg
76158>>>>>// $File title : About class support
76158>>>>>// Notice      :
76158>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
76158>>>>>//
76158>>>>>// $Rev History
76158>>>>>//
76158>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
76158>>>>>//                Windows for the size first. 
76158>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
76158>>>>>//                with anchor technique. Removed unnessary property in the
76158>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
76158>>>>>//                object To better look in Windows XP. Repositioned the close
76158>>>>>//                button in the sysinfo dialog To line up with the display area
76158>>>>>//                Replaced obsolete code and techniques. Removed dead code.
76158>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
76158>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
76158>>>>>//                the global Workspace object, if it is present
76158>>>>>// JJT 11/05/98   Added version information
76158>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
76158>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
76158>>>>>//                workspace package.
76158>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
76158>>>>>//                class can create this object.
76158>>>>>//                Cleaned up the interface (used correct classes and messages)
76158>>>>>//                Added workspace reporting support To sys-info.
76158>>>>>//                Turned off wrapping in the sys-info editor.
76158>>>>>// KR  ??/??/96   File created
76158>>>>>//************************************************************************
76158>>>>>Use LanguageText.pkg
76158>>>>>Use Windows.pkg
76158>>>>>Use DFbitmap.pkg
76158>>>>>Use GlobalFunctionsProcedures.pkg
76158>>>>>Use cTextEdit.pkg
76158>>>>>
76158>>>>>Use cli.pkg
Including file: cli.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cli.pkg)
76158>>>>>>>//*****************************************************************************
76158>>>>>>>//*** CLI.PKG                                                               ***
76158>>>>>>>//***                                                                       ***
76158>>>>>>>//*** Author: Ben Weijers                                                   ***
76158>>>>>>>//***         Data Access Nederland                                         ***
76158>>>>>>>//***         10 September 1998                                             ***
76158>>>>>>>//***                                                                       ***
76158>>>>>>>//*** Purpose:                                                              ***
76158>>>>>>>//***   CLI specific functionality. There are several connectivity kits     ***
76158>>>>>>>//***   based on  SQL/92 CLI. Those are:                                    ***
76158>>>>>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
76158>>>>>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
76158>>>>>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
76158>>>>>>>//***                                                                       ***
76158>>>>>>>//***   This package defines the common functionality for all CLI based     ***
76158>>>>>>>//***   drivers.                                                            ***
76158>>>>>>>//***                                                                       ***
76158>>>>>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
76158>>>>>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
76158>>>>>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
76158>>>>>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
76158>>>>>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
76158>>>>>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
76158>>>>>>>//***             Added SQLSERVER2012CLIENT return value for                ***
76158>>>>>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
76158>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
76158>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
76158>>>>>>>//***             mssqldrv.pkg                                              ***
76158>>>>>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
76158>>>>>>>//***             Added type mappings attributes                            ***
76158>>>>>>>//***   Updated:  october 11, 2013 (Current CK build: 6.0.0.18)             ***
76158>>>>>>>//***             Added DF_FILE_SQL_FILTER_EQ attribute                     ***
76158>>>>>>>//*****************************************************************************
76158>>>>>>>
76158>>>>>>>//*** We are not using ifndef below because that is not supported in Character Mode
76158>>>>>>>//*** Driver attributes
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>//------------------------------------------------------------
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>//-------------------------------------
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>//*** Replacement for logical column number that indicates all columns
76158>>>>>>>
76158>>>>>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
76158>>>>>>>
76158>>>>>>>//*** Possible DF_FIELD_READ_ONLY values
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
76158>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
76158>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>// Moved to Mssqldrv.pkg
76158>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
76158>>>>>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
76158>>>>>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
76158>>>>>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
76158>>>>>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
76158>>>>>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
76158>>>>>>>
76158>>>>>>>//*** Possible SQL Column type values
76158>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
76158>>>>>>>Define SQL_CHAR           For    1
76158>>>>>>>Define SQL_NUMERIC        For    2
76158>>>>>>>Define SQL_DECIMAL        For    3
76158>>>>>>>Define SQL_INTEGER        For    4
76158>>>>>>>Define SQL_SMALLINT       For    5
76158>>>>>>>Define SQL_FLOAT          For    6
76158>>>>>>>Define SQL_REAL           For    7
76158>>>>>>>Define SQL_DOUBLE         For    8
76158>>>>>>>Define SQL_DATETIME       For    9
76158>>>>>>>Define SQL_VARCHAR        For   12
76158>>>>>>>Define SQL_TYPE_DATE      For   91
76158>>>>>>>Define SQL_TYPE_TIME      For   92
76158>>>>>>>Define SQL_TYPE_TIMESTAMP for   93
76158>>>>>>>// Moved to mssqldrv.pkg
76158>>>>>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>Define SQL_DATE           For    9
76158>>>>>>>Define SQL_INTERVAL       For   10
76158>>>>>>>Define SQL_TIME           For   10
76158>>>>>>>Define SQL_TIMESTAMP      For   11
76158>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
76158>>>>>>>Define SQL_BINARY         For  (-2)
76158>>>>>>>Define SQL_VARBINARY      For  (-3)
76158>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
76158>>>>>>>Define SQL_BIGINT         For  (-5)
76158>>>>>>>Define SQL_TINYINT        For  (-6)
76158>>>>>>>Define SQL_BIT            For  (-7)
76158>>>>>>>Define SQL_WCHAR          For  (-8)
76158>>>>>>>Define SQL_WVARCHAR       For  (-9)
76158>>>>>>>Define SQL_WLONGVARCHAR   For (-10)
76158>>>>>>>Define SQL_GUID           For (-11)
76158>>>>>>>
76158>>>>>>>//*** Driver level attributes
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>//*** Error number constants
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>//*** Call driver function identifiers
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>//*** Init data source types
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>//*** Dummy strings used in the commands
76158>>>>>>>    String  CLI$StrDummy 255
76158>>>>>>>    Integer CLI$IntDummy
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>//*****************************************************************************
76158>>>>>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
76158>>>>>>>//***                                                                       ***
76158>>>>>>>//***   Setup a constraint for a file.                                      ***
76158>>>>>>>//*****************************************************************************
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>//*****************************************************************************
76158>>>>>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
76158>>>>>>>//***                                                                       ***
76158>>>>>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
76158>>>>>>>//*** will be set for the remainder of the session or until set again. To   ***
76158>>>>>>>//*** permanently set driver level attributes change the driver             ***
76158>>>>>>>//*** configuration file.                                                   ***
76158>>>>>>>//*****************************************************************************
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>
76158>>>>>>>//*****************************************************************************
76158>>>>>>>//*** Class  : cCLIHandler                                                  ***
76158>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76158>>>>>>>//***          call several CLI releated methods.                           ***
76158>>>>>>>//*****************************************************************************
76158>>>>>>>
76158>>>>>>>Class cCLIHandler Is An Array
76159>>>>>>>
76159>>>>>>>    Procedure Construct_Object Integer iImage
76161>>>>>>>        Forward Send Construct_object iImage
76163>>>>>>>
76163>>>>>>>        Property String  psDriverID       Public ""
76164>>>>>>>    End_Procedure // Construct_Object
76165>>>>>>>
76165>>>>>>>
76165>>>>>>>
76165>>>>>>>    //***
76165>>>>>>>    //*** Fucntion: CKRevsion
76165>>>>>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
76165>>>>>>>    //***
76165>>>>>>>
76165>>>>>>>    Function CKRevision Returns String
76167>>>>>>>        Local String  sDriverID
76167>>>>>>>        Local String  sRevision
76167>>>>>>>        Local String  sVoid
76167>>>>>>>        Local Integer iRetval
76167>>>>>>>
76167>>>>>>>        Get psDriverID To sDriverID
76168>>>>>>>        If (sDRiverID <> "") Begin
76170>>>>>>>            Move (Repeat(" ", 255)) To sRevision
76171>>>>>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76176>>>>>>>        End
76176>>>>>>>>
76176>>>>>>>
76176>>>>>>>        Function_Return sRevision
76177>>>>>>>    End_Function // CKRevision
76178>>>>>>>
76178>>>>>>>
76178>>>>>>>
76178>>>>>>>    //***
76178>>>>>>>    //*** Function: ExtractPartFromRevision
76178>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76178>>>>>>>    //***
76178>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76178>>>>>>>    //***
76178>>>>>>>
76178>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76180>>>>>>>        Local Integer iPartRev
76180>>>>>>>        Local Integer iCurrentPart
76180>>>>>>>        Local Integer iSeparatorPos
76180>>>>>>>
76180>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76183>>>>>>>
76183>>>>>>>        Move 0 To iCurrentPart
76184>>>>>>>        Repeat
76184>>>>>>>>
76184>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76185>>>>>>>            If (iSeparatorPos > 0) Begin
76187>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76188>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76189>>>>>>>                Increment iCurrentPart
76190>>>>>>>            End
76190>>>>>>>>
76190>>>>>>>            Else If (sRevision <> "") Begin
76193>>>>>>>                Move sRevision To iPartRev
76194>>>>>>>                Move "" To sRevision
76195>>>>>>>                Increment iCurrentPart
76196>>>>>>>            End
76196>>>>>>>>
76196>>>>>>>            Else ;                Move -1 To iPartRev
76198>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76200>>>>>>>
76200>>>>>>>        Function_Return iPartRev
76201>>>>>>>    End_Function // EcxtractPartFromRevision
76202>>>>>>>
76202>>>>>>>
76202>>>>>>>
76202>>>>>>>    //***
76202>>>>>>>    //*** Function: CKMajorRevision
76202>>>>>>>    //*** Purpose : Returns the major revision of the CK
76202>>>>>>>    //***
76202>>>>>>>
76202>>>>>>>    Function CKMajorRevision Returns Integer
76204>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76205>>>>>>>    End_Function // CKMajorRevision
76206>>>>>>>
76206>>>>>>>
76206>>>>>>>
76206>>>>>>>    //***
76206>>>>>>>    //*** Function: CKMinorRevision
76206>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76206>>>>>>>    //***
76206>>>>>>>
76206>>>>>>>    Function CKMinorRevision Returns Integer
76208>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76209>>>>>>>    End_Function // CKMinorRevision
76210>>>>>>>
76210>>>>>>>
76210>>>>>>>
76210>>>>>>>    //***
76210>>>>>>>    //*** Function: CKReleaseRevision
76210>>>>>>>    //*** Purpose : Returns the release revision of the CK
76210>>>>>>>    //***
76210>>>>>>>
76210>>>>>>>    Function CKReleaseRevision Returns Integer
76212>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76213>>>>>>>    End_Function // CKReleaseRevision
76214>>>>>>>
76214>>>>>>>
76214>>>>>>>
76214>>>>>>>    //***
76214>>>>>>>    //*** Function: CKBuildRevision
76214>>>>>>>    //*** Purpose : Returns the major revision of the CK
76214>>>>>>>    //***
76214>>>>>>>
76214>>>>>>>    Function CKBuildRevision Returns Integer
76216>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76217>>>>>>>    End_Function // CKBuildRevision
76218>>>>>>>
76218>>>>>>>
76218>>>>>>>
76218>>>>>>>    //***
76218>>>>>>>    //*** Function: IsMinimalRevision
76218>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76218>>>>>>>    //***
76218>>>>>>>
76218>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76220>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76223>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76226>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76229>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76232>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76235>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76239>>>>>>>            End
76239>>>>>>>>
76239>>>>>>>        End
76239>>>>>>>>
76239>>>>>>>
76239>>>>>>>        Function_Return (FALSE)
76240>>>>>>>    End_Function // IsMinimalRevision
76241>>>>>>>
76241>>>>>>>
76241>>>>>>>
76241>>>>>>>    //***
76241>>>>>>>    //*** Function: RegistrationName
76241>>>>>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
76241>>>>>>>    //***
76241>>>>>>>
76241>>>>>>>    Function RegistrationName Returns String
76243>>>>>>>        Local String  sRegistration
76243>>>>>>>        Local String  sDRiverId
76243>>>>>>>        Local String  sVoid
76243>>>>>>>        Local Integer iRetval
76243>>>>>>>
76243>>>>>>>        Get psDriverID To sDriverID
76244>>>>>>>        If (sDRiverID <> "") Begin
76246>>>>>>>            Move (Repeat(" ", 255)) To sRegistration
76247>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
76252>>>>>>>        End
76252>>>>>>>>
76252>>>>>>>
76252>>>>>>>        Function_Return sRegistration
76253>>>>>>>    End_Function // RegistrationName
76254>>>>>>>
76254>>>>>>>
76254>>>>>>>
76254>>>>>>>    //***
76254>>>>>>>    //*** Function: SerialNumber
76254>>>>>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
76254>>>>>>>    //***
76254>>>>>>>
76254>>>>>>>    Function SerialNumber Returns Integer
76256>>>>>>>        Local String  sDRiverId
76256>>>>>>>        Local String  sVoid
76256>>>>>>>        Local Integer iRetval
76256>>>>>>>
76256>>>>>>>        Get psDriverID To sDriverID
76257>>>>>>>        If (sDRiverID <> "") Begin
76259>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
76264>>>>>>>        End
76264>>>>>>>>
76264>>>>>>>
76264>>>>>>>        Function_Return iRetval
76265>>>>>>>    End_Function // SerialNumber
76266>>>>>>>
76266>>>>>>>
76266>>>>>>>
76266>>>>>>>    //***
76266>>>>>>>    //*** Function: MaxUsers
76266>>>>>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
76266>>>>>>>    //***
76266>>>>>>>
76266>>>>>>>    Function MaxUsers Returns Integer
76268>>>>>>>        Local String  sDRiverId
76268>>>>>>>        Local String  sVoid
76268>>>>>>>        Local Integer iRetval
76268>>>>>>>
76268>>>>>>>        Get psDriverID To sDriverID
76269>>>>>>>        If (sDRiverID <> "") Begin
76271>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
76276>>>>>>>        End
76276>>>>>>>>
76276>>>>>>>
76276>>>>>>>        Function_Return iRetval
76277>>>>>>>    End_Function // MaxUsers
76278>>>>>>>
76278>>>>>>>
76278>>>>>>>
76278>>>>>>>    //***
76278>>>>>>>    //*** Procedure: DumpStatus
76278>>>>>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
76278>>>>>>>    //***
76278>>>>>>>
76278>>>>>>>    Procedure DumpStatus String sFileName
76280>>>>>>>        Local String  sVoid
76280>>>>>>>        Local String  sDriverID
76280>>>>>>>        Local Integer iVoid
76280>>>>>>>
76280>>>>>>>        Get psDriverID To sDriverID
76281>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
76288>>>>>>>    End_Procedure // DumpStatus
76289>>>>>>>
76289>>>>>>>
76289>>>>>>>
76289>>>>>>>    //***
76289>>>>>>>    //*** Procedure: ReadConfiguration
76289>>>>>>>    //*** Purpose  : Reset all driver level configurable attributes to the
76289>>>>>>>    //***            default value and then reread the configuration.
76289>>>>>>>    //***
76289>>>>>>>
76289>>>>>>>    Procedure ReadConfiguration
76291>>>>>>>        Local String  sVoid
76291>>>>>>>        Local String  sDriverID
76291>>>>>>>        Local Integer iVoid
76291>>>>>>>
76291>>>>>>>        Get psDriverID To sDriverID
76292>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
76299>>>>>>>    End_Procedure // ReadConfiguration
76300>>>>>>>
76300>>>>>>>
76300>>>>>>>
76300>>>>>>>    //***
76300>>>>>>>    //*** Function: TextToRIMValue
76300>>>>>>>    //*** Purpose : Convert a text to the corresponding
76300>>>>>>>    //***           Generate_Record_ID_Method attribute value
76300>>>>>>>    //***
76300>>>>>>>
76300>>>>>>>    Function TextToRIMValue String sText Returns Integer
76302>>>>>>>        If (sText = "None") ;            Function_return RIM_NONE
76305>>>>>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
76309>>>>>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
76313>>>>>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
76317>>>>>>>    End_Function // TextToRIMValue
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>    //***
76318>>>>>>>    //*** Function: RIMValueTotext
76318>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76318>>>>>>>    //***           corresponding text.
76318>>>>>>>    //***
76318>>>>>>>
76318>>>>>>>    Function RIMValueToText Integer iAttrValue Returns String
76320>>>>>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
76323>>>>>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
76327>>>>>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
76331>>>>>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
76335>>>>>>>    End_Function // RIMValueToText
76336>>>>>>>
76336>>>>>>>
76336>>>>>>>
76336>>>>>>>    //***
76336>>>>>>>    //*** Function: TextToROValue
76336>>>>>>>    //*** Purpose : Convert a text to the corresponding
76336>>>>>>>    //***           Generate_Record_ID_Method attribute value
76336>>>>>>>    //***
76336>>>>>>>
76336>>>>>>>    Function TextToROValue String sText Returns Integer
76338>>>>>>>        If (sText = "No") ;            Function_return RO_NO
76341>>>>>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
76345>>>>>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
76349>>>>>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
76353>>>>>>>    End_Function // TextToRIMValue
76354>>>>>>>
76354>>>>>>>
76354>>>>>>>
76354>>>>>>>    //***
76354>>>>>>>    //*** Function: ROValueTotext
76354>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76354>>>>>>>    //***           corresponding text.
76354>>>>>>>    //***
76354>>>>>>>
76354>>>>>>>    Function ROValueToText Integer iAttrValue Returns String
76356>>>>>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
76359>>>>>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
76363>>>>>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
76367>>>>>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
76371>>>>>>>    End_Function // RIMValueToText
76372>>>>>>>
76372>>>>>>>
76372>>>>>>>
76372>>>>>>>    //***
76372>>>>>>>    //*** Function: LastDriverError
76372>>>>>>>    //*** Purpose : Return the text f the last error geneated by the driver.
76372>>>>>>>    //***
76372>>>>>>>
76372>>>>>>>    Function LastDriverError Returns String
76374>>>>>>>        Local String  sDriverID
76374>>>>>>>        Local String  sLastError
76374>>>>>>>        Local String  sLastErrorLength
76374>>>>>>>        Local Integer iLastErrorLength
76374>>>>>>>        Local Integer iVoid
76374>>>>>>>
76374>>>>>>>        //*** Initialize
76374>>>>>>>        Move "" To sLastError
76375>>>>>>>
76375>>>>>>>        Get psDriverID To sDriverID
76376>>>>>>>        If (sDriverID <> "") Begin
76378>>>>>>>            //*** Get the text of the last error
76378>>>>>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
76379>>>>>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
76384>>>>>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
76385>>>>>>>
76385>>>>>>>            If (iLastErrorLength > 0) Begin
76387>>>>>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
76388>>>>>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
76393>>>>>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
76394>>>>>>>            End
76394>>>>>>>>
76394>>>>>>>        End
76394>>>>>>>>
76394>>>>>>>
76394>>>>>>>        Function_Return sLastError
76395>>>>>>>    End_Function // LastDriverError
76396>>>>>>>
76396>>>>>>>
76396>>>>>>>
76396>>>>>>>    //***
76396>>>>>>>    //*** Function: EnumerateTables
76396>>>>>>>    //*** Purpose : Enumerate the tables in a database
76396>>>>>>>    //***
76396>>>>>>>
76396>>>>>>>    Function EnumerateTables String sLogin Returns Integer
76398>>>>>>>        Local String  sDriver
76398>>>>>>>        Local String  sVoid
76398>>>>>>>        Local Integer iNumTables
76398>>>>>>>        Local Integer iVoid
76398>>>>>>>
76398>>>>>>>        Get psDriverID To sDriver
76399>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
76406>>>>>>>
76406>>>>>>>        Function_Return iNumTables
76407>>>>>>>    End_Function // EnumerateTables
76408>>>>>>>
76408>>>>>>>
76408>>>>>>>
76408>>>>>>>    //***
76408>>>>>>>    //*** Function: TableName
76408>>>>>>>    //*** Purpose : Returns the name of the table enumerated at the given position
76408>>>>>>>    //***
76408>>>>>>>
76408>>>>>>>    Function TableName Integer iIndex Returns String
76410>>>>>>>        Local String  sDriver
76410>>>>>>>        Local String  sTableName
76410>>>>>>>        Local String  sVoid
76410>>>>>>>        Local Integer iVoid
76410>>>>>>>
76410>>>>>>>        Get psDriverID To sDriver
76411>>>>>>>        If (sDriver <> "") Begin
76413>>>>>>>            Move (Repeat(" ", 255)) To sTableName
76414>>>>>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
76419>>>>>>>        End
76419>>>>>>>>
76419>>>>>>>
76419>>>>>>>        Function_Return sTableName
76420>>>>>>>    End_Function // TableName
76421>>>>>>>
76421>>>>>>>
76421>>>>>>>
76421>>>>>>>    //***
76421>>>>>>>    //*** Function: SchemaName
76421>>>>>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
76421>>>>>>>    //***
76421>>>>>>>
76421>>>>>>>    Function SchemaName Integer iIndex Returns String
76423>>>>>>>        Local String  sDriver
76423>>>>>>>        Local String  sSchemaName
76423>>>>>>>        Local String  sVoid
76423>>>>>>>        Local Integer iVoid
76423>>>>>>>
76423>>>>>>>        Get psDriverID To sDriver
76424>>>>>>>        If (sDriver <> "") Begin
76426>>>>>>>            Move (Repeat(" ", 255)) To sSchemaName
76427>>>>>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
76432>>>>>>>        End
76432>>>>>>>>
76432>>>>>>>
76432>>>>>>>        Function_Return sSchemaName
76433>>>>>>>    End_Function // SchemaName
76434>>>>>>>
76434>>>>>>>
76434>>>>>>>
76434>>>>>>>    //***
76434>>>>>>>    //*** Function: TableType
76434>>>>>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
76434>>>>>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
76434>>>>>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
76434>>>>>>>    //***
76434>>>>>>>
76434>>>>>>>    Function TableType Integer iIndex Returns String
76436>>>>>>>        Local String  sDriver
76436>>>>>>>        Local String  sTableType
76436>>>>>>>        Local String  sVoid
76436>>>>>>>        Local Integer iVoid
76436>>>>>>>
76436>>>>>>>        Get psDriverID To sDriver
76437>>>>>>>        If (sDriver <> "") Begin
76439>>>>>>>            Move (Repeat(" ", 25)) To sTableType
76440>>>>>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
76445>>>>>>>        End
76445>>>>>>>>
76445>>>>>>>
76445>>>>>>>        Function_Return sTableType
76446>>>>>>>    End_Function // TableType
76447>>>>>>>
76447>>>>>>>
76447>>>>>>>
76447>>>>>>>    //***
76447>>>>>>>    //*** Function: TableComment
76447>>>>>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
76447>>>>>>>    //***
76447>>>>>>>
76447>>>>>>>    Function TableComment Integer iIndex Returns String
76449>>>>>>>        Local String  sDriver
76449>>>>>>>        Local String  sTableComment
76449>>>>>>>        Local String  sVoid
76449>>>>>>>        Local Integer iVoid
76449>>>>>>>
76449>>>>>>>        Get psDriverID To sDriver
76450>>>>>>>        If (sDriver <> "") Begin
76452>>>>>>>            Move (Repeat(" ", 255)) To sTableComment
76453>>>>>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
76458>>>>>>>        End
76458>>>>>>>>
76458>>>>>>>
76458>>>>>>>        Function_Return sTableComment
76459>>>>>>>    End_Function // TableComment
76460>>>>>>>
76460>>>>>>>
76460>>>>>>>
76460>>>>>>>    //***
76460>>>>>>>    //*** Function: EnumerateColumns
76460>>>>>>>    //*** Purpose : Enumerate the columns in a table
76460>>>>>>>    //***
76460>>>>>>>
76460>>>>>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
76462>>>>>>>        Local String  sDriver
76462>>>>>>>        Local Integer iNumColumns
76462>>>>>>>        Local Integer iVoid
76462>>>>>>>
76462>>>>>>>        Get psDriverID To sDriver
76463>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
76470>>>>>>>
76470>>>>>>>        Function_Return iNumColumns
76471>>>>>>>    End_Function // EnumerateColumns
76472>>>>>>>
76472>>>>>>>
76472>>>>>>>
76472>>>>>>>    //***
76472>>>>>>>    //*** Function: ColumnName
76472>>>>>>>    //*** Purpose : Returns the name of the column enumerated at the given position
76472>>>>>>>    //***
76472>>>>>>>
76472>>>>>>>    Function ColumnName Integer iIndex Returns String
76474>>>>>>>        Local String  sDriver
76474>>>>>>>        Local String  sColumnName
76474>>>>>>>        Local String  sVoid
76474>>>>>>>        Local Integer iVoid
76474>>>>>>>
76474>>>>>>>        Get psDriverID To sDriver
76475>>>>>>>        If (sDriver <> "") Begin
76477>>>>>>>            Move (Repeat(" ", 255)) To sColumnName
76478>>>>>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
76483>>>>>>>        End
76483>>>>>>>>
76483>>>>>>>
76483>>>>>>>        Function_Return sColumnName
76484>>>>>>>    End_Function // ColumnName
76485>>>>>>>
76485>>>>>>>
76485>>>>>>>
76485>>>>>>>    //***
76485>>>>>>>    //*** Function: CLIDFDateToSQLDate
76485>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
76485>>>>>>>    //***
76485>>>>>>>
76485>>>>>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
76487>>>>>>>        Local String sSQLDate
76487>>>>>>>        Local Integer iOrgDateFmt
76487>>>>>>>        Local Integer iOrgDateSep
76487>>>>>>>
76487>>>>>>>        //*** Change date format to military, SQL dates are military dates
76487>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76490>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76493>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76496>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76499>>>>>>>
76499>>>>>>>        //*** We only need to convert if the date is 0
76499>>>>>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
76508>>>>>>>        Else ;            Move dDFDate To sSQLDate
76510>>>>>>>
76510>>>>>>>        //*** Change date format back to original
76510>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76513>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76516>>>>>>>
76516>>>>>>>        Function_Return sSQLDate
76517>>>>>>>    End_Function // CLIDFDateToSQLDate
76518>>>>>>>
76518>>>>>>>
76518>>>>>>>
76518>>>>>>>    //***
76518>>>>>>>    //*** Function: CLISQLDateToDFDate
76518>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
76518>>>>>>>    //***
76518>>>>>>>
76518>>>>>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
76520>>>>>>>        Local Date dDFDate
76520>>>>>>>        Local String sDummyDateValue
76520>>>>>>>        Local Integer iOrgDateFmt
76520>>>>>>>        Local Integer iOrgDateSep
76520>>>>>>>
76520>>>>>>>        //*** Change date format to military, SQL dates are military dates
76520>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76523>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76526>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76529>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76532>>>>>>>
76532>>>>>>>        //*** We only need to convert if the date is the dummy zero date value
76532>>>>>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
76539>>>>>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
76542>>>>>>>        Else ;            Move sSQLDate To dDFDate
76544>>>>>>>
76544>>>>>>>        //*** Change date format back to original
76544>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76547>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76550>>>>>>>
76550>>>>>>>        Function_Return dDFDate
76551>>>>>>>    End_Function // CLISQLDateToDFDate
76552>>>>>>>
76552>>>>>>>
76552>>>>>>>
76552>>>>>>>    //***
76552>>>>>>>    //*** Function: RedirectConnection
76552>>>>>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
76552>>>>>>>    //***           will point to another database but all tables will stay
76552>>>>>>>    //***           open!
76552>>>>>>>    //***
76552>>>>>>>
76552>>>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
76554>>>>>>>        Local String  sDriver
76554>>>>>>>        Local String  sVoid
76554>>>>>>>        Local Integer iResult
76554>>>>>>>        Local Integer iVoid
76554>>>>>>>
76554>>>>>>>        Get psDriverID To sDriver
76555>>>>>>>        If (sDriver <> "") Begin
76557>>>>>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
76562>>>>>>>        End
76562>>>>>>>>
76562>>>>>>>        Function_Return iResult
76563>>>>>>>    End_Function // RedirectConnect
76564>>>>>>>
76564>>>>>>>
76564>>>>>>>
76564>>>>>>>    //***
76564>>>>>>>    //*** Function: CreateConnectionID
76564>>>>>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
76564>>>>>>>    //***
76564>>>>>>>
76564>>>>>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
76566>>>>>>>        Local String  sDriver
76566>>>>>>>        Local Integer iResult
76566>>>>>>>        Local Integer iOptions
76566>>>>>>>
76566>>>>>>>        Get psDriverID to sDriver
76567>>>>>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
76570>>>>>>>        Else ;            Move iOpt to iOptions
76572>>>>>>>        If (sDriver <> "") Begin
76574>>>>>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
76579>>>>>>>        End
76579>>>>>>>>
76579>>>>>>>        Function_Return iResult
76580>>>>>>>    End_Function // CreateConnectionID
76581>>>>>>>
76581>>>>>>>
76581>>>>>>>
76581>>>>>>>    //***
76581>>>>>>>    //*** Function: DeleteConnectionID
76581>>>>>>>    //*** Purpose : Delete a DataFlex side connection id.
76581>>>>>>>    //***
76581>>>>>>>
76581>>>>>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
76583>>>>>>>        Local String  sDriver
76583>>>>>>>        Local Integer iResult
76583>>>>>>>        Local String sVoid
76583>>>>>>>
76583>>>>>>>        Get psDriverID To sDriver
76584>>>>>>>        If (sDriver <> "") Begin
76586>>>>>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
76591>>>>>>>        End
76591>>>>>>>>
76591>>>>>>>        Function_Return iResult
76592>>>>>>>    End_Function // DeleteConnectionID
76593>>>>>>>
76593>>>>>>>End_Class // cCLIHandler
76594>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 18.2\Pkg\DFBTRDRV.PKG)
76594>>>>>>>//****************************************************************************
76594>>>>>>>//
76594>>>>>>>// $File name  : DFBTRDRV.PKG
76594>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
76594>>>>>>>// Notice      : This package contains constants and commands, used to call
76594>>>>>>>//               specific functions in the DFBTRDRV.
76594>>>>>>>// $Author(s)  : Eddy Kleinjan
76594>>>>>>>//
76594>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
76594>>>>>>>// Created     : 01-07-97 @ 12:00:00
76594>>>>>>>//
76594>>>>>>>// Changed     : 04-04-2001.
76594>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
76594>>>>>>>//
76594>>>>>>>// Changed     : June 6, 2001
76594>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
76594>>>>>>>//
76594>>>>>>>//               Added DFBTR_DDF_OWNER command.
76594>>>>>>>//
76594>>>>>>>// Changed     : June 12, 2001
76594>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
76594>>>>>>>//
76594>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
76594>>>>>>>//
76594>>>>>>>// Changed     : August 4, 2004
76594>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
76594>>>>>>>//
76594>>>>>>>//               Added cDfbtrdrvHandler class.
76594>>>>>>>//               New functions in this class:
76594>>>>>>>//                  Function CKRevision Returns String
76594>>>>>>>//                  Function CkUsesUri Returns Integer
76594>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76594>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76594>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76594>>>>>>>//
76594>>>>>>>// Changed     : September 30, 2005
76594>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
76594>>>>>>>//
76594>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
76594>>>>>>>//****************************************************************************
76594>>>>>>>Use Ui
76594>>>>>>>//
76594>>>>>>>// Driver Indentification
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>//*** Driver attributes
76594>>>>>>>//
76594>>>>>>>// Call_Driver functions ID's
76594>>>>>>>//
76594>>>>>>>//
76594>>>>>>>// DFBTRFN_CONVERT_FILE options
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// DFBTRFN_SET_OWNER options
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to create all vars which may be needed
76594>>>>>>>// in other commands.
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to set the owner of a Btrieve file.
76594>>>>>>>// File must have been opened.
76594>>>>>>>// Filenumber needs to be passed.
76594>>>>>>>// To clear set the owner to "".
76594>>>>>>>// Examples:
76594>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
76594>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
76594>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
76594>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
76594>>>>>>>// To clear:
76594>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to parse DFBTR_SET_OWNVER
76594>>>>>>>// options.
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to parse for Callback
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to clear the owner of a Btrieve file.
76594>>>>>>>// File must have been opened.
76594>>>>>>>// Filenumber needs to be passed.
76594>>>>>>>// Examples:
76594>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to add a owner name to the internal list of ownernames
76594>>>>>>>// which will be tries when opening files.
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to remove all owners from the internal list of ownernames
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to set the owner name to be used when opening the DDF files.
76594>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
76594>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
76594>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to change the transaction type.
76594>>>>>>>// Valid types are:
76594>>>>>>>//     DFBTRTT_NONE
76594>>>>>>>//     DFBTRTT_EXCLUSIVE
76594>>>>>>>//     DFBTRTT_CONCURRENT
76594>>>>>>>//
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to get the current transaction type.
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to set explicit_locking
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to get explicit locking
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>//
76594>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
76594>>>>>>>//
76594>>>>>>>
76594>>>>>>>//*****************************************************************************
76594>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
76594>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76594>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
76594>>>>>>>//*****************************************************************************
76594>>>>>>>
76594>>>>>>>Class cDFBtrDrvHandler Is An Array
76595>>>>>>>
76595>>>>>>>    Procedure Construct_Object Integer iImage
76597>>>>>>>        Forward Send Construct_object iImage
76599>>>>>>>
76599>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
76600>>>>>>>    End_Procedure // Construct_Object
76601>>>>>>>
76601>>>>>>>
76601>>>>>>>
76601>>>>>>>    //***
76601>>>>>>>    //*** Function: CKRevsion
76601>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
76601>>>>>>>    //***
76601>>>>>>>
76601>>>>>>>    Function CKRevision Returns String
76603>>>>>>>        Local String  sDriverID
76603>>>>>>>        Local String  sRevision
76603>>>>>>>        Local String  sVoid
76603>>>>>>>        Local Integer iRetval
76603>>>>>>>
76603>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76603>>>>>>>        // This error would otherwise be raised when we have an older
76603>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76603>>>>>>>        Send Ignore_error To Error_object_Id 20491
76604>>>>>>>        Get psDriverID To sDriverID
76605>>>>>>>        Move (Repeat(" ", 255)) To sRevision
76606>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76611>>>>>>>        Send Trap_Error To Error_object_Id 20491
76612>>>>>>>        If (Trim(sRevision) = "") Begin
76614>>>>>>>            // Unable to get the revision. return all zeroes.
76614>>>>>>>            Move "0.0.0.0" To sRevision
76615>>>>>>>        End
76615>>>>>>>>
76615>>>>>>>        Function_Return sRevision
76616>>>>>>>    End_Function // CKRevision
76617>>>>>>>
76617>>>>>>>    Function CkUsesUri Returns Integer
76619>>>>>>>        Local String  sDriverID
76619>>>>>>>        Local String  sVoid1
76619>>>>>>>        Local String  sVoid2
76619>>>>>>>        Local Integer iRetval
76619>>>>>>>
76619>>>>>>>        Get psDriverID To sDriverID
76620>>>>>>>
76620>>>>>>>        Move 0 To iRetval
76621>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76621>>>>>>>        // This error would otherwise be raised when we have an older
76621>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
76621>>>>>>>        Send Ignore_error To Error_object_Id 20491
76622>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
76627>>>>>>>        Send Trap_Error To Error_object_Id 20491
76628>>>>>>>
76628>>>>>>>        Function_Return iRetval
76629>>>>>>>    End_Function // CKUsesUri
76630>>>>>>>
76630>>>>>>>
76630>>>>>>>
76630>>>>>>>    //***
76630>>>>>>>    //*** Function: ExtractPartFromRevsion
76630>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76630>>>>>>>    //***
76630>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76630>>>>>>>    //***
76630>>>>>>>
76630>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76632>>>>>>>        Local Integer iPartRev
76632>>>>>>>        Local Integer iCurrentPart
76632>>>>>>>        Local Integer iSeparatorPos
76632>>>>>>>
76632>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76635>>>>>>>
76635>>>>>>>        Move 0 To iCurrentPart
76636>>>>>>>        Repeat
76636>>>>>>>>
76636>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76637>>>>>>>            If (iSeparatorPos > 0) Begin
76639>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76640>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76641>>>>>>>                Increment iCurrentPart
76642>>>>>>>            End
76642>>>>>>>>
76642>>>>>>>            Else If (sRevision <> "") Begin
76645>>>>>>>                Move sRevision To iPartRev
76646>>>>>>>                Move "" To sRevision
76647>>>>>>>                Increment iCurrentPart
76648>>>>>>>            End
76648>>>>>>>>
76648>>>>>>>            Else ;                Move -1 To iPartRev
76650>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76652>>>>>>>
76652>>>>>>>        Function_Return iPartRev
76653>>>>>>>    End_Function // EcxtractPartFromRevision
76654>>>>>>>
76654>>>>>>>
76654>>>>>>>
76654>>>>>>>    //***
76654>>>>>>>    //*** Function: CKMajorRevision
76654>>>>>>>    //*** Purpose : Returns the major revision of the CK
76654>>>>>>>    //***
76654>>>>>>>
76654>>>>>>>    Function CKMajorRevision Returns Integer
76656>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76657>>>>>>>    End_Function // CKMajorRevision
76658>>>>>>>
76658>>>>>>>
76658>>>>>>>
76658>>>>>>>    //***
76658>>>>>>>    //*** Function: CKMinorRevision
76658>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76658>>>>>>>    //***
76658>>>>>>>
76658>>>>>>>    Function CKMinorRevision Returns Integer
76660>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76661>>>>>>>    End_Function // CKMinorRevision
76662>>>>>>>
76662>>>>>>>
76662>>>>>>>
76662>>>>>>>    //***
76662>>>>>>>    //*** Function: CKReleaseRevision
76662>>>>>>>    //*** Purpose : Returns the release revision of the CK
76662>>>>>>>    //***
76662>>>>>>>
76662>>>>>>>    Function CKReleaseRevision Returns Integer
76664>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76665>>>>>>>    End_Function // CKReleaseRevision
76666>>>>>>>
76666>>>>>>>
76666>>>>>>>
76666>>>>>>>    //***
76666>>>>>>>    //*** Function: CKBuildRevision
76666>>>>>>>    //*** Purpose : Returns the major revision of the CK
76666>>>>>>>    //***
76666>>>>>>>
76666>>>>>>>    Function CKBuildRevision Returns Integer
76668>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76669>>>>>>>    End_Function // CKBuildRevision
76670>>>>>>>
76670>>>>>>>
76670>>>>>>>
76670>>>>>>>    //***
76670>>>>>>>    //*** Function: IsMinimalRevision
76670>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76670>>>>>>>    //***
76670>>>>>>>
76670>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76672>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76675>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76678>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76681>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76684>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76687>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76691>>>>>>>            End
76691>>>>>>>>
76691>>>>>>>        End
76691>>>>>>>>
76691>>>>>>>
76691>>>>>>>        Function_Return (FALSE)
76692>>>>>>>    End_Function // IsMinimalRevision
76693>>>>>>>
76693>>>>>>>    //   Functions to query the Pervasive.SQL version:
76693>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
76693>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
76693>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
76693>>>>>>>    //
76693>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
76693>>>>>>>    //   in the following format:
76693>>>>>>>    //       <version>.<revision>.<type>
76693>>>>>>>    //   possible values for <type>:
76693>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
76693>>>>>>>    //         server using Workgroup authentication mode
76693>>>>>>>    //       C for client cache engine
76693>>>>>>>    //       D for DOS workstation
76693>>>>>>>    //       N for client Requester
76693>>>>>>>    //       S for NetWare server
76693>>>>>>>    //       T for 32-bit Windows server engine
76693>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
76693>>>>>>>    //
76693>>>>>>>    //   example:
76693>>>>>>>    //       8.50.T
76693>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
76693>>>>>>>    //   32-bits Windows server.
76693>>>>>>>    //
76693>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
76693>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
76693>>>>>>>    //
76693>>>>>>>    //   If the version information is not available or can not be obtained
76693>>>>>>>    //   the functions will return "0.0.0"
76693>>>>>>>
76693>>>>>>>
76693>>>>>>>    //***
76693>>>>>>>    //*** Function: PSQLRequesterVersionInfo
76693>>>>>>>    //*** Purpose : Returns the version information of the
76693>>>>>>>    //***           Pervasive.SQL Client requester.
76693>>>>>>>
76693>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76695>>>>>>>
76695>>>>>>>        Local String  sDriverID
76695>>>>>>>        Local String  sVersion
76695>>>>>>>        Local String  sVoid
76695>>>>>>>        Local Integer iRetval
76695>>>>>>>
76695>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76695>>>>>>>        // This error would otherwise be raised when we have an older
76695>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76695>>>>>>>        Send Ignore_error To Error_object_Id 20491
76696>>>>>>>        Get psDriverID To sDriverID
76697>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76698>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76703>>>>>>>        Send Trap_Error To Error_object_Id 20491
76704>>>>>>>        If (Trim(sVersion) = "") Begin
76706>>>>>>>            // Unable to get the revision. return all zeroes.
76706>>>>>>>            Move "0.0.0" To sVersion
76707>>>>>>>        End
76707>>>>>>>>
76707>>>>>>>        Function_Return sVersion
76708>>>>>>>    End_Function //  PSQLRequesterVersion
76709>>>>>>>
76709>>>>>>>    //***
76709>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
76709>>>>>>>    //*** Purpose : Returns the version information of the
76709>>>>>>>    //***           Pervasive.SQL Local Engine
76709>>>>>>>
76709>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76711>>>>>>>
76711>>>>>>>        Local String  sDriverID
76711>>>>>>>        Local String  sVersion
76711>>>>>>>        Local String  sVoid
76711>>>>>>>        Local Integer iRetval
76711>>>>>>>
76711>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76711>>>>>>>        // This error would otherwise be raised when we have an older
76711>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76711>>>>>>>        Send Ignore_error To Error_object_Id 20491
76712>>>>>>>        Get psDriverID To sDriverID
76713>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76714>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76719>>>>>>>        Send Trap_Error To Error_object_Id 20491
76720>>>>>>>        If (Trim(sVersion) = "") Begin
76722>>>>>>>            // Unable to get the revision. return all zeroes.
76722>>>>>>>            Move "0.0.0" To sVersion
76723>>>>>>>        End
76723>>>>>>>>
76723>>>>>>>        Function_Return sVersion
76724>>>>>>>    End_Function //  PSQLLocalEngineVersion
76725>>>>>>>
76725>>>>>>>    //***
76725>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
76725>>>>>>>    //*** Purpose : Returns the version information of the
76725>>>>>>>    //***           Pervasive.SQL Server Engine
76725>>>>>>>
76725>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76727>>>>>>>
76727>>>>>>>        Local String  sDriverID
76727>>>>>>>        Local String  sVersion
76727>>>>>>>        Local String  sVoid
76727>>>>>>>        Local Integer iRetval
76727>>>>>>>
76727>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76727>>>>>>>        // This error would otherwise be raised when we have an older
76727>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76727>>>>>>>        Send Ignore_error To Error_object_Id 20491
76728>>>>>>>        Get psDriverID To sDriverID
76729>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76730>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76735>>>>>>>        Send Trap_Error To Error_object_Id 20491
76736>>>>>>>        If (Trim(sVersion) = "") Begin
76738>>>>>>>            // Unable to get the revision. return all zeroes.
76738>>>>>>>            Move "0.0.0" To sVersion
76739>>>>>>>        End
76739>>>>>>>>
76739>>>>>>>        Function_Return sVersion
76740>>>>>>>    End_Function //  PSQLServerEngineVersion
76741>>>>>>>
76741>>>>>>>End_Class // cDfbtrdrvHandler
76742>>>>>>>
76742>>>>>
76742>>>>>
76742>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
76743>>>>>
76743>>>>>Register_Function phoWorkspace Returns Handle
76743>>>>>Register_Function Help_filename Returns String
76743>>>>>Register_Function GetHelpFile Returns String
76743>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
76743>>>>>
76743>>>>>//****************************************************************************
76743>>>>>// $Module type: FUNCTION
76743>>>>>// $Module name: Network_User_Name
76743>>>>>// $Author     : AK/VOO/KCR
76743>>>>>// Created     : 09-24-96 @ 19:17
76743>>>>>//
76743>>>>>// Description
76743>>>>>//    This function reads the current username Of windows and returns that
76743>>>>>//    name or an text unknown user
76743>>>>>//
76743>>>>>// $Rev History
76743>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
76743>>>>>//  07/25/2003  Replaced obsolete code
76743>>>>>//  09/24/1996  Module header created
76743>>>>>//****************************************************************************
76743>>>>>Function Network_User_Name for cDesktop Returns String
76745>>>>>    String sName
76745>>>>>    Integer iRetval iLength
76745>>>>>
76745>>>>>    Move 0 to iLength
76746>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
76747>>>>>    ZeroString iLength to sName
76748>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
76749>>>>>
76749>>>>>    If (iRetval = NO_ERROR) Begin
76751>>>>>        Function_Return (CString (sName))
76752>>>>>    End
76752>>>>>>
76752>>>>>    
76752>>>>>    Function_Return "User Unknown"
76753>>>>>End_Function
76754>>>>>
76754>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
76754>>>>>Type MEMORYSTATUS
76754>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
76754>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
76754>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
76754>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
76754>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
76754>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
76754>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
76754>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
76754>>>>>End_Type // MEMORYSTATUS
76754>>>>>
76754>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
76755>>>>>
76755>>>>>Struct tWinMemoryStatusEx
76755>>>>>    UInteger dwLength                
76755>>>>>    UInteger dwMemoryLoad          
76755>>>>>    UBigInt ullTotalPhys           
76755>>>>>    UBigInt ullAvailPhys           
76755>>>>>    UBigInt ullTotalPageFile       
76755>>>>>    UBigInt ullAvailPageFile       
76755>>>>>    UBigInt ullTotalVirtual        
76755>>>>>    UBigInt ullAvailVirtual        
76755>>>>>    UBigInt ullAvailExtendedVirtual
76755>>>>>End_Struct
76755>>>>>
76755>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
76756>>>>>
76756>>>>>Class SysinfoDisplay is a cTextEdit
76757>>>>>    Procedure Construct_Object
76759>>>>>        Forward Send Construct_Object
76761>>>>>
76761>>>>>        Set Location To 6 6
76762>>>>>        Set Size To 110 255
76763>>>>>        Set Read_Only_State To True
76764>>>>>        Set pbWrap to False
76765>>>>>    End_Procedure
76766>>>>>
76766>>>>>    //****************************************************************************
76766>>>>>    // $Module type: PROCEDURE
76766>>>>>    // $Module name: Show_Current_Directory
76766>>>>>    // $Author     : VOO
76766>>>>>    // Created     : 06-10-96 @ 15:24
76766>>>>>    //
76766>>>>>    // Description
76766>>>>>    //    This method will show the name Of the current directory in the system
76766>>>>>    //    information box
76766>>>>>    //
76766>>>>>    // $Rev History
76766>>>>>    //    06-10-96  Module header created
76766>>>>>    //****************************************************************************
76766>>>>>    Procedure Show_Current_Directory
76768>>>>>        String sDir
76768>>>>>
76768>>>>>        Get_Current_Directory To sDir
76769>>>>>
76769>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
76770>>>>>    End_Procedure
76771>>>>>
76771>>>>>    Procedure Show_Windows_Directory
76773>>>>>        String sWindir
76773>>>>>
76773>>>>>        Get_Windows_Directory To sWindir
76774>>>>>
76774>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
76775>>>>>    End_Procedure
76776>>>>>
76776>>>>>    Procedure Show_Current_User
76778>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
76779>>>>>    End_Procedure
76780>>>>>
76780>>>>>    Procedure Show_Number_Format
76782>>>>>        Integer iFormat
76782>>>>>        String sFormatText
76782>>>>>
76782>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
76785>>>>>        Move (Character (iFormat)) To sFormatText
76786>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
76787>>>>>
76787>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
76790>>>>>        Move (Character (iFormat)) to sFormatText
76791>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
76792>>>>>    End_Procedure
76793>>>>>
76793>>>>>    Procedure Show_Filelist_Name
76795>>>>>        String sFilename
76795>>>>>
76795>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
76798>>>>>
76798>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
76799>>>>>        Send AppendTextLn ""
76800>>>>>    End_Procedure
76801>>>>>
76801>>>>>    Procedure Show_Lock_Delay
76803>>>>>        Integer iLockdelay
76803>>>>>
76803>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
76806>>>>>
76806>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
76807>>>>>    End_Procedure
76808>>>>>
76808>>>>>    Procedure Show_Lock_Timeout
76810>>>>>        Integer iLockTimeout
76810>>>>>
76810>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
76813>>>>>
76813>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
76814>>>>>    End_Procedure
76815>>>>>
76815>>>>>    Procedure Show_Screen_Size
76817>>>>>        Integer iYscreensize iXscreensize
76817>>>>>
76817>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
76818>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
76819>>>>>
76819>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
76820>>>>>    End_Procedure
76821>>>>>
76821>>>>>    Procedure Show_Page_Size
76823>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
76824>>>>>    End_procedure
76825>>>>>
76825>>>>>    Procedure Show_Date
76827>>>>>        Date dToday
76827>>>>>
76827>>>>>        Sysdate dToday
76828>>>>>
76828>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
76829>>>>>    End_procedure
76830>>>>>
76830>>>>>    Procedure Show_Date_Format
76832>>>>>        Integer iDateFormat
76832>>>>>        String sDateFormat
76832>>>>>
76832>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
76835>>>>>        Case Begin
76835>>>>>            Case (iDateFormat = DF_DATE_USA)
76837>>>>>                Move C_$USA To sDateFormat
76838>>>>>                Case Break
76839>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
76842>>>>>                Move C_$European To sDateFormat
76843>>>>>                Case Break
76844>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
76847>>>>>                Move C_$Military To sDateFormat
76848>>>>>                Case Break
76849>>>>>            Case Else
76849>>>>>                Move C_$UnknownDateType To sDateFormat
76850>>>>>                Case Break
76851>>>>>        Case End
76851>>>>>
76851>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
76852>>>>>    End_Procedure
76853>>>>>
76853>>>>>    Procedure Show_Systemresources
76855>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76855>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76855>>>>>        Integer iRetval
76855>>>>>
76855>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
76856>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
76857>>>>>        If (iRetval = 0) Begin
76859>>>>>            Move (ShowLastError ()) to iRetval
76860>>>>>        End
76860>>>>>>
76860>>>>>
76860>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
76861>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
76862>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
76863>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
76864>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
76865>>>>>    End_Procedure
76866>>>>>
76866>>>>>    Procedure Show_Registration
76868>>>>>        String sRegName
76868>>>>>        Integer iSN iMaxUsers
76868>>>>>
76868>>>>>        Registration sRegName iSN
76869>>>>>>
76869>>>>>        
76869>>>>>        Get_Licensed_Max_Users to iMaxUsers
76870>>>>>
76870>>>>>        Send AppendTextLn ""
76871>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
76872>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
76873>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
76874>>>>>    End_Procedure
76875>>>>>
76875>>>>>    //****************************************************************************
76875>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
76875>>>>>    // To the workspace object passing the an object and message To send back
76875>>>>>    // To this object. It is expected that the workspace object will send this
76875>>>>>    // message for every line Of information it wants displayed (passing the
76875>>>>>    // information To be displayed
76875>>>>>    //****************************************************************************
76875>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
76875>>>>>
76875>>>>>    Procedure Show_ServicePack
76877>>>>>        String sKey sVersionDescription sVersion 
76877>>>>>        Handle hoRegistry
76877>>>>>        Boolean bExists bOpened
76877>>>>>        
76877>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
76878>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
76879>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
76880>>>>>
76880>>>>>        Move C_DFVersionRegistryRoot to sKey
76881>>>>>        Get KeyExists of hoRegistry sKey to bExists
76882>>>>>        If (bExists) Begin
76884>>>>>            Get OpenKey of hoRegistry sKey to bOpened
76885>>>>>            If (bOpened) Begin
76887>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
76888>>>>>                If (bExists) Begin
76890>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
76891>>>>>                End
76891>>>>>>
76891>>>>>                
76891>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
76892>>>>>                If (bExists) Begin
76894>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
76895>>>>>                End                
76895>>>>>>
76895>>>>>                Send CloseKey of hoRegistry
76896>>>>>            End
76896>>>>>>
76896>>>>>        End
76896>>>>>>
76896>>>>>        Send Destroy of hoRegistry
76897>>>>>
76897>>>>>        If (sVersionDescription <> "") Begin
76899>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
76900>>>>>           Send AppendTextLn ""
76901>>>>>        End
76901>>>>>>
76901>>>>>    End_Procedure
76902>>>>>    
76902>>>>>
76902>>>>>    Procedure Show_WorkspaceInformation
76904>>>>>        Integer hoWorkspace
76904>>>>>
76904>>>>>        If (ghoApplication <> 0) Begin
76906>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
76907>>>>>            If (hoWorkspace <> 0) Begin
76909>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
76910>>>>>                Send AppendTextLn ""
76911>>>>>            End
76911>>>>>>
76911>>>>>        End
76911>>>>>>
76911>>>>>    End_Procedure
76912>>>>>
76912>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
76914>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
76915>>>>>    End_Function
76916>>>>>
76916>>>>>    Procedure Show_Versions
76918>>>>>        Integer iVersion iRevision iBuild
76918>>>>>
76918>>>>>        Version_Information iVersion iRevision iBuild
76920>>>>>
76920>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
76921>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
76922>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
76923>>>>>    End_Procedure
76924>>>>>    
76924>>>>>    Function CKRevisionNumber String sDriverID Returns String
76926>>>>>        Handle hoCLIHandler
76926>>>>>        Handle hoDFBtrDrvHandler
76926>>>>>        String sCKRevision
76926>>>>>
76926>>>>>
76926>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
76928>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
76929>>>>>            Set psDriverID of hoCLIHandler to sDriverID
76930>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
76931>>>>>            Send Destroy of hoCLIHandler
76932>>>>>        End
76932>>>>>>
76932>>>>>        Else Begin
76933>>>>>            If (sDriverID = "DFBTRDRV") Begin
76935>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
76936>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
76937>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
76938>>>>>                Send Destroy of hoDFBtrDrvHandler
76939>>>>>            End
76939>>>>>>
76939>>>>>        End
76939>>>>>>
76939>>>>>        
76939>>>>>        Function_Return sCKRevision
76940>>>>>    End_Function
76941>>>>>    
76941>>>>>    
76941>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
76943>>>>>        
76943>>>>>        If (sDriverID = "DATAFLEX") Begin
76945>>>>>            Function_Return False
76946>>>>>        End
76946>>>>>>
76946>>>>>    
76946>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
76947>>>>>    End_Function    
76948>>>>>
76948>>>>>
76948>>>>>    //***
76948>>>>>    //*** BW
76948>>>>>    //*** Procedure: Show_Drivers
76948>>>>>    //*** Purpose  : Show loaded database drivers
76948>>>>>    //***
76948>>>>>
76948>>>>>    Procedure Show_Drivers
76950>>>>>        String sCurrentDriver sRevNumber
76950>>>>>        String sLoadedDrivers
76950>>>>>        Integer iNumberOfDrivers iCount
76950>>>>>        Boolean bOK
76950>>>>>
76950>>>>>        Move "" To sLoadedDrivers
76951>>>>>        Get_Attribute DF_NUMBER_DRIVERS To iNumberOfDrivers
76954>>>>>        For iCount From 1 To iNumberOfDrivers
76960>>>>>>
76960>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
76963>>>>>            If (sLoadedDrivers <> "") Begin
76965>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
76966>>>>>            End
76966>>>>>>
76966>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
76967>>>>>            If (bOK) Begin
76969>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
76970>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
76971>>>>>            End
76971>>>>>>
76971>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) To sLoadedDrivers
76972>>>>>        Loop
76973>>>>>>
76973>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
76974>>>>>    End_Procedure
76975>>>>>
76975>>>>>    Procedure Show_HelpFile
76977>>>>>        String sHelpFile
76977>>>>>        Integer eHelpType
76977>>>>>
76977>>>>>        If (ghoApplication <> 0) Begin
76979>>>>>            Get peHelpType Of ghoApplication To eHelpType
76980>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
76982>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
76983>>>>>            End
76983>>>>>>
76983>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
76986>>>>>                Get Help_filename Of Help_object_id To sHelpFile
76987>>>>>            End
76987>>>>>>
76987>>>>>            Else Begin
76988>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
76989>>>>>            End
76989>>>>>>
76989>>>>>
76989>>>>>            Send AppendTextLn ""
76990>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
76991>>>>>        End
76991>>>>>>
76991>>>>>    End_Procedure
76992>>>>>
76992>>>>>    Procedure Show_EnterAsTab
76994>>>>>        Boolean bEnterKeyAsTabKey
76994>>>>>        String sText
76994>>>>>
76994>>>>>        If (ghoApplication <> 0) Begin
76996>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
76997>>>>>            If (bEnterKeyAsTabKey) Begin
76999>>>>>                Move "True" To sText
77000>>>>>            End
77000>>>>>>
77000>>>>>            Else Begin
77001>>>>>                Move "False" To sText
77002>>>>>            End
77002>>>>>>
77002>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
77003>>>>>        End
77003>>>>>>
77003>>>>>    End_Procedure
77004>>>>>
77004>>>>>    //****************************************************************************
77004>>>>>    // $Module type: PROCEDURE
77004>>>>>    // $Module name: Add_Focus
77004>>>>>    // $Author     : VOO
77004>>>>>    // Created     : 24-09-96 @ 19:43
77004>>>>>    //
77004>>>>>    // Description
77004>>>>>    //    During activation we will remove the old information and add the newly
77004>>>>>    //    found systeminformation
77004>>>>>    //
77004>>>>>    // $Rev History
77004>>>>>    //    24-09-96  Module header created
77004>>>>>    //****************************************************************************
77004>>>>>    Procedure Add_Focus Integer hoRoot
77006>>>>>        Forward Send Add_Focus hoRoot
77008>>>>>
77008>>>>>        Send Delete_Data
77009>>>>>
77009>>>>>        Set Changed_State To False
77010>>>>>        Set Read_Only_State To True
77011>>>>>
77011>>>>>        Send Show_ServicePack
77012>>>>>        Send Show_Versions   
77013>>>>>        Send Show_Drivers         
77014>>>>>        Send Show_HelpFile
77015>>>>>        Send Show_Current_Directory
77016>>>>>        Send Show_Filelist_Name          
77017>>>>>        If (ghoApplication <> 0) Begin
77019>>>>>            Send Show_WorkSpaceInformation // added To show WS info
77020>>>>>        End
77020>>>>>>
77020>>>>>        Send Show_Current_User 
77021>>>>>        Send Show_Windows_Directory 
77022>>>>>        Send Show_Screen_Size
77023>>>>>        Send Show_Page_Size
77024>>>>>        Send Show_EnterAsTab        
77025>>>>>        Send Show_Number_Format
77026>>>>>        Send Show_Date_Format
77027>>>>>        Send Show_Lock_Delay
77028>>>>>        Send Show_Lock_Timeout
77029>>>>>        Send Show_Date
77030>>>>>        Send Show_Systemresources
77031>>>>>        Send Show_Registration
77032>>>>>        Send Beginning_of_Data
77033>>>>>
77033>>>>>        Set Icon to 'default.ico'
77034>>>>>    End_Procedure
77035>>>>>End_Class
77036>>>>>
77036>>>>>//****************************************************************************
77036>>>>>// $Module type: OBJECT
77036>>>>>// $Module name: Sysinfo_Dialog
77036>>>>>// $Author     : VOO
77036>>>>>// Created     : 24-09-96 @ 18:47
77036>>>>>//
77036>>>>>// Description
77036>>>>>//    This object shows the systeminformation on the screen
77036>>>>>//
77036>>>>>// $Rev History
77036>>>>>//    24-09-96  Module header created
77036>>>>>//****************************************************************************
77036>>>>>Class SysInfoDialog Is A ModalPanel
77037>>>>>    Procedure Construct_Object
77039>>>>>        Forward Send Construct_Object
77041>>>>>
77041>>>>>        Set Label to C_$SystemInformation
77042>>>>>        Set Size to 140 267
77043>>>>>        Set piMinSize to 140 267
77044>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77045>>>>>        Set Border_Style to Border_Thick
77046>>>>>
77046>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
77048>>>>>            Set peAnchors to anAll
77049>>>>>        End_Object
77050>>>>>
77050>>>>>        Object oCloseButton Is A Button
77052>>>>>            Set Label To C_$Close
77053>>>>>            Set Location To 120 210
77054>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
77055>>>>>            Set Default_State To True
77056>>>>>            Set peAnchors to anBottomRight
77057>>>>>        End_Object
77058>>>>>
77058>>>>>        On_Key kCancel Send Close_Panel
77059>>>>>    End_Procedure
77060>>>>>End_Class
77061>>>>>
77061>>>>>// Purpose:
77061>>>>>//
77061>>>>>// Ken Ross 12/17/96 5:16PM
77061>>>>>//
77061>>>>>Class AboutDialog Is A ModalPanel
77062>>>>>    Procedure Construct_Object
77064>>>>>        String sVdfRootDir
77064>>>>>
77064>>>>>        Forward Send Construct_Object
77066>>>>>
77066>>>>>        Set Label To C_$About
77067>>>>>        Set Size to 89 212
77068>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77069>>>>>
77069>>>>>        Object oSysInfoDialog Is A SysInfoDialog
77071>>>>>        End_Object
77072>>>>>
77072>>>>>        Object oBox Is A Container3d
77074>>>>>            Set Border_Style To Border_StaticEdge
77075>>>>>            Set Size to 63 202
77076>>>>>            Set Location To 4 5
77077>>>>>
77077>>>>>            Object oAboutGraphic Is A BitmapContainer
77079>>>>>                Set Border_Style To Border_None
77080>>>>>                Set Bitmap_Style To Bitmap_Center
77081>>>>>                Set Size To 48 48
77082>>>>>                Set Location To 7 2
77083>>>>>            End_Object
77084>>>>>
77084>>>>>            Object oProductName Is A TextBox
77086>>>>>                Set Label To C_$ProductName
77087>>>>>                Set Size To 10 45
77088>>>>>                Set Location To 8 53
77089>>>>>            End_Object
77090>>>>>
77090>>>>>            Object oVersion Is A TextBox
77092>>>>>                Set Label To C_$Version
77093>>>>>                Set Size To 10 25
77094>>>>>                Set Location To 21 53
77095>>>>>            End_Object
77096>>>>>
77096>>>>>            Object oCopyright Is A TextBox
77098>>>>>                Set Label To C_$Copyright
77099>>>>>                Set Size To 10 31
77100>>>>>                Set Location To 34 53
77101>>>>>            End_Object
77102>>>>>
77102>>>>>            Object oAuthor Is A TextBox
77104>>>>>                Set Label To C_$Author
77105>>>>>                Set Size To 10 22
77106>>>>>                Set Location To 46 53
77107>>>>>            End_Object
77108>>>>>        End_Object
77109>>>>>
77109>>>>>        Object oOKButton Is A Button
77111>>>>>            On_Item C_$OK Send Close_Panel
77112>>>>>            Set Size To 14 50
77113>>>>>            Set Location To 71 157
77114>>>>>        End_Object
77115>>>>>
77115>>>>>        Object oSysInfoButton Is A Button
77117>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
77118>>>>>            Set Size To 14 50
77119>>>>>            Set Location To 71 101
77120>>>>>        End_Object
77121>>>>>
77121>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
77122>>>>>
77122>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
77123>>>>>    End_Procedure
77124>>>>>
77124>>>>>    Procedure Set ProductName String sProductName
77126>>>>>        Set Label Of oProductName To sProductName
77127>>>>>    End_Procedure
77128>>>>>
77128>>>>>    Procedure Set Version String sVersion
77130>>>>>        Set Label Of oVersion To sVersion
77131>>>>>    End_Procedure
77132>>>>>
77132>>>>>    Procedure Set Copyright string sCopyright
77134>>>>>        Set Label Of oCopyright To sCopyright
77135>>>>>    End_Procedure
77136>>>>>
77136>>>>>    Procedure Set Author String sAuthor
77138>>>>>        Set Label Of oAuthor To sAuthor
77139>>>>>    End_Procedure
77140>>>>>
77140>>>>>    Procedure Set Logo string sLogo
77142>>>>>        // square bitmaps Of 42x42 work best
77142>>>>>        Set Bitmap Of oAboutGraphic To sLogo
77143>>>>>    End_Procedure
77144>>>>>
77144>>>>>    Procedure Show_Sysinfo
77146>>>>>        Send Popup_Modal Of oSysinfoDialog
77147>>>>>    End_Procedure
77148>>>>>
77148>>>>>    Procedure End_Construct_Object
77150>>>>>        Handle hoVersionInfo
77150>>>>>        Boolean bIncluded
77150>>>>>        Integer iMajor iMinor iRelease iBuild
77150>>>>>        String sLabel
77150>>>>>
77150>>>>>        Get Label Of oVersion To sLabel
77151>>>>>        If (sLabel = C_$VERSION) Begin
77153>>>>>            // set it To the version info Of the program, if available
77153>>>>>            If (ghoApplication <> 0) Begin
77155>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
77156>>>>>                If (hoVersionInfo <> 0) Begin
77158>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
77159>>>>>                    If (bIncluded) Begin
77161>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
77162>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
77163>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
77164>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
77165>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
77166>>>>>                        Set Version to sLabel
77167>>>>>                    End
77167>>>>>>
77167>>>>>                End
77167>>>>>>
77167>>>>>            End
77167>>>>>>
77167>>>>>        End
77167>>>>>>
77167>>>>>
77167>>>>>        Forward Send End_Construct_Object
77169>>>>>    End_Procedure
77170>>>>>End_Class
77171>>>
77171>>>// *************************************************************************
77171>>>//  Public message. This is the default message. It is expected that you will
77171>>>//   create your own message to override this
77171>>>// *************************************************************************
77171>>>
77171>>>Procedure Activate_About
77174>>>   Send DoAbout "" "" "" "" ""
77175>>>End_Procedure
77176>>>
77176>>>// *************************************************************************
77176>>>//  Public message. It is expected that you will send this message (most
77176>>>//  likely from Activate_About. This creates an about object, activates it
77176>>>//  and destroys it when done. It is not exepected that you will augment this.
77176>>>// *************************************************************************
77176>>>
77176>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
77179>>>        integer hoObj hoMain
77179>>>
77179>>>        // create object
77179>>>        Object About is an AboutDialog
77181>>>            // if no title passed use the label of the main panel
77181>>>            // (if a main panel exists).
77181>>>            if sTitle     eq '' Begin
77183>>>                Get Main_Window of desktop to hoMain
77184>>>                if hoMain Get Label of hoMain to sTitle
77187>>>            end
77187>>>>
77187>>>            set productname to sTitle
77188>>>            set version     to sVersion
77189>>>            set copyright   to sCopyRight
77190>>>            set author      to sAuthor
77191>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
77194>>>            Move self to hoObj // object Id
77195>>>        End_Object
77196>>>        Send Popup   of hoObj    // popup the about object
77197>>>        Send Destroy of hoObj // when done, it will be destroyed
77198>>>End_procedure
77199>        Use AutoEntry.vw
Including file: AutoEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\AutoEntry.vw)
77199>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\AutoEntry.vw
77199>>>// AutoEntry
77199>>>//
77199>>>
77199>>>Use DFClient.pkg
77199>>>Use DFEntry.pkg
77199>>>Use Dfcentry.PKG
77199>>>
77199>>>Use cAutoDataDictionary.dd
Including file: cAutoDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cAutoDataDictionary.dd)
77199>>>>>Use DataDict.pkg
77199>>>>>
77199>>>>>Open Auto
Including file: Auto.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\Auto.fd)
77201>>>>>Open Fuvarlevel
Including file: Fuvarlevel.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\Fuvarlevel.fd)
77203>>>>>
77203>>>>>Register_Object Auto_sl
77203>>>>>
77203>>>>>Class cAutoDataDictionary is a DataDictionary
77204>>>>>    
77204>>>>>    Procedure Construct_Object
77206>>>>>        Forward Send Construct_Object
77208>>>>>        Set Main_File to Auto.File_Number
77209>>>>>
77209>>>>>        Set Add_Client_File to Fuvarlevel.File_Number
77210>>>>>
77210>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77211>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77212>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77213>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77214>>>>>
77214>>>>>        Set Field_Option Field Auto.auto_rendszam DD_AUTOFIND to True
77215>>>>>        Set Field_Mask Field Auto.auto_rendszam to "@@@-###"
77216>>>>>        Set Key_Field_State Field Auto.auto_rendszam to True
77217>>>>>        Set Field_Label_Long Field Auto.auto_rendszam to "Rendsz m"
77218>>>>>        Set Field_Prompt_Object Field Auto.auto_rendszam to Auto_sl
77219>>>>>
77219>>>>>        Set Field_Option Field Auto.auto_tipus DD_AUTOFIND to True
77220>>>>>        Set Field_Label_Long Field Auto.auto_tipus to "Aut¢ t¡pus"
77221>>>>>        Set Field_Prompt_Object Field Auto.auto_tipus to Auto_sl
77222>>>>>
77222>>>>>    End_Procedure
77223>>>>>
77223>>>>>End_Class
77224>>>>>
77224>>>>>Use Auto.sl
Including file: Auto.sl    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\Auto.sl)
77224>>>>>>>// Auto.sl
77224>>>>>>>// Auto lista
77224>>>>>>>
77224>>>>>>>Use DFClient.pkg
77224>>>>>>>Use cDbCJGridPromptList.pkg
77224>>>>>>>Use cDbCJGridColumn.pkg
77224>>>>>>>Use Windows.pkg
77224>>>>>>>
77224>>>>>>>Use cAutoDataDictionary.dd
77224>>>>>>>
77224>>>>>>>CD_Popup_Object Auto_sl is a dbModalPanel
77242>>>>>>>>
77242>>>>>>>    Set Location to 5 5
77243>>>>>>>    Set Size to 134 214
77244>>>>>>>    Set Label To "Auto lista"
77245>>>>>>>    Set Border_Style to Border_Thick
77246>>>>>>>    Set Minimize_Icon to False
77247>>>>>>>
77247>>>>>>>
77247>>>>>>>    Object oAuto_DD is a cAutoDataDictionary
77249>>>>>>>    End_Object 
77250>>>>>>>
77250>>>>>>>    Set Main_DD To oAuto_DD
77251>>>>>>>    Set Server  To oAuto_DD
77252>>>>>>>
77252>>>>>>>
77252>>>>>>>
77252>>>>>>>    Object oSelList is a cDbCJGridPromptList
77254>>>>>>>        Set Size to 105 204
77255>>>>>>>        Set Location to 5 5
77256>>>>>>>        Set peAnchors to anAll
77257>>>>>>>        Set psLayoutSection to "Auto_sl_oSelList"
77258>>>>>>>        Set Ordering to 1
77259>>>>>>>        Set pbAutoServer to True
77260>>>>>>>
77260>>>>>>>        Object oAuto_auto_rendszam is a cDbCJGridColumn
77262>>>>>>>            Entry_Item Auto.auto_rendszam
77263>>>>>>>            Set piWidth to 88
77264>>>>>>>            Set psCaption to "Rendsz m"
77265>>>>>>>        End_Object 
77266>>>>>>>
77266>>>>>>>        Object oAuto_auto_tipus is a cDbCJGridColumn
77268>>>>>>>            Entry_Item Auto.auto_tipus
77269>>>>>>>            Set piWidth to 300
77270>>>>>>>            Set psCaption to "Aut¢ t¡pus"
77271>>>>>>>        End_Object 
77272>>>>>>>
77272>>>>>>>
77272>>>>>>>    End_Object 
77273>>>>>>>
77273>>>>>>>    Object oOk_bn is a Button
77275>>>>>>>        Set Label to "&Ok"
77276>>>>>>>        Set Location to 115 51
77277>>>>>>>        Set peAnchors to anBottomRight
77278>>>>>>>
77278>>>>>>>        Procedure OnClick
77281>>>>>>>            Send OK of oSelList
77282>>>>>>>        End_Procedure
77283>>>>>>>
77283>>>>>>>    End_Object 
77284>>>>>>>
77284>>>>>>>    Object oCancel_bn is a Button
77286>>>>>>>        Set Label to "&Cancel"
77287>>>>>>>        Set Location to 115 105
77288>>>>>>>        Set peAnchors to anBottomRight
77289>>>>>>>
77289>>>>>>>        Procedure OnClick
77292>>>>>>>            Send Cancel of oSelList
77293>>>>>>>        End_Procedure
77294>>>>>>>
77294>>>>>>>    End_Object 
77295>>>>>>>
77295>>>>>>>    Object oSearch_bn is a Button
77297>>>>>>>        Set Label to "&Search..."
77298>>>>>>>        Set Location to 115 159
77299>>>>>>>        Set peAnchors to anBottomRight
77300>>>>>>>
77300>>>>>>>        Procedure OnClick
77303>>>>>>>            Send Search of oSelList
77304>>>>>>>        End_Procedure
77305>>>>>>>
77305>>>>>>>    End_Object 
77306>>>>>>>
77306>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77307>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77308>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77309>>>>>>>
77309>>>>>>>
77309>>>>>>>CD_End_Object // Auto_sl
77311>>>>>>>>
77311>>>
77311>>>ACTIVATE_VIEW Activate_oAutoEntry FOR oAutoEntry
77321>>>>
77321>>>Object oAutoEntry is a dbView
77323>>>    Set Location to 5 5
77324>>>    Set Size to 38 247
77325>>>    Set Label to "Aut¢"
77326>>>    Set Border_Style to Border_Thick
77327>>>
77327>>>
77327>>>    Object oAuto_DD is a cAutoDataDictionary
77329>>>    End_Object 
77330>>>
77330>>>    Set Main_DD To oAuto_DD
77331>>>    Set Server  To oAuto_DD
77332>>>
77332>>>
77332>>>
77332>>>    Object oAutoauto_rendszam is a dbForm
77334>>>        Entry_Item Auto.auto_rendszam
77335>>>        Set Size to 13 48
77336>>>        Set Location to 5 56
77337>>>        Set peAnchors to anTopLeftRight
77338>>>        Set Label to "Rendsz m"
77339>>>        Set Label_Justification_mode to jMode_Left
77340>>>        Set Label_Col_Offset to 51
77341>>>        Set Label_row_Offset to 0
77342>>>    End_Object 
77343>>>
77343>>>    Object oAutoauto_tipus is a dbForm
77345>>>        Entry_Item Auto.auto_tipus
77346>>>        Set Size to 13 186
77347>>>        Set Location to 20 56
77348>>>        Set peAnchors to anTopLeftRight
77349>>>        Set Label to "T¡pus"
77350>>>        Set Label_Justification_mode to jMode_Left
77351>>>        Set Label_Col_Offset to 51
77352>>>        Set Label_row_Offset to 0
77353>>>    End_Object 
77354>>>
77354>>>
77354>>>End_Object 
77355>        Use SoforEntry.vw
Including file: SoforEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\SoforEntry.vw)
77355>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\SoforEntry.vw
77355>>>// SoforEntry
77355>>>//
77355>>>
77355>>>Use DFClient.pkg
77355>>>Use DFEntry.pkg
77355>>>Use Dfcentry.PKG
77355>>>
77355>>>Use cSoforDataDictionary.dd
Including file: cSoforDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cSoforDataDictionary.dd)
77355>>>>>Use DataDict.pkg
77355>>>>>
77355>>>>>Open Sofor
Including file: Sofor.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\Sofor.fd)
77357>>>>>Open Fuvarlevel
77359>>>>>Open system_table
Including file: system_table.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\system_table.fd)
77361>>>>>
77361>>>>>Register_Object Sofor_sl
77361>>>>>
77361>>>>>Class cSoforDataDictionary is a DataDictionary
77362>>>>>    
77362>>>>>    Procedure Construct_Object
77364>>>>>        Forward Send Construct_Object
77366>>>>>        Set Main_File to Sofor.File_Number
77367>>>>>
77367>>>>>        Set Add_Client_File to Fuvarlevel.File_Number
77368>>>>>
77368>>>>>        Set Add_System_File to system_table.File_Number DD_Lock_On_All
77369>>>>>
77369>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77370>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77371>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77372>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77373>>>>>
77373>>>>>        Set Field_Option Field Sofor.sofor_azonosito DD_AUTOFIND to True
77374>>>>>        Set Field_Auto_Increment Field Sofor.sofor_azonosito to File_Field system_table.sofor_azonosito
77375>>>>>        Set Key_Field_State Field Sofor.sofor_azonosito to True
77376>>>>>        Set Field_Label_Long Field Sofor.sofor_azonosito to "Sof‹r id"
77377>>>>>        Set Field_Label_Short Field Sofor.sofor_azonosito to "Azonos¡t¢"
77378>>>>>        Set Field_Prompt_Object Field Sofor.sofor_azonosito to Sofor_sl
77379>>>>>
77379>>>>>        Set Field_Label_Long Field Sofor.sofor_nev to "Sof‹r neve"
77380>>>>>        Set Field_Label_Short Field Sofor.sofor_nev to "N‚v"
77381>>>>>        Set Field_Prompt_Object Field Sofor.sofor_nev to Sofor_sl
77382>>>>>
77382>>>>>        Set Field_Label_Long Field Sofor.sofor_szigsz to "Szigsz."
77383>>>>>        Set Field_Prompt_Object Field Sofor.sofor_szigsz to Sofor_sl
77384>>>>>
77384>>>>>    End_Procedure
77385>>>>>
77385>>>>>End_Class
77386>>>>>
77386>>>>>Use Sofor.sl
Including file: Sofor.sl    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\Sofor.sl)
77386>>>>>>>// Sofor.sl
77386>>>>>>>// Sof‹r lista
77386>>>>>>>
77386>>>>>>>Use DFClient.pkg
77386>>>>>>>Use cDbCJGridPromptList.pkg
77386>>>>>>>Use cDbCJGridColumn.pkg
77386>>>>>>>Use Windows.pkg
77386>>>>>>>
77386>>>>>>>Use cSoforDataDictionary.dd
77386>>>>>>>
77386>>>>>>>CD_Popup_Object Sofor_sl is a dbModalPanel
77404>>>>>>>>
77404>>>>>>>    Set Location to 5 5
77405>>>>>>>    Set Size to 134 285
77406>>>>>>>    Set Label To "Sof‹r lista"
77407>>>>>>>    Set Border_Style to Border_Thick
77408>>>>>>>    Set Minimize_Icon to False
77409>>>>>>>
77409>>>>>>>
77409>>>>>>>    Object oSofor_DD is a cSoforDataDictionary
77411>>>>>>>    End_Object 
77412>>>>>>>
77412>>>>>>>    Set Main_DD To oSofor_DD
77413>>>>>>>    Set Server  To oSofor_DD
77414>>>>>>>
77414>>>>>>>
77414>>>>>>>
77414>>>>>>>    Object oSelList is a cDbCJGridPromptList
77416>>>>>>>        Set Size to 105 275
77417>>>>>>>        Set Location to 5 5
77418>>>>>>>        Set peAnchors to anAll
77419>>>>>>>        Set psLayoutSection to "Sofor_sl_oSelList"
77420>>>>>>>        Set Ordering to 1
77421>>>>>>>        Set pbAutoServer to True
77422>>>>>>>
77422>>>>>>>        Object oSofor_sofor_azonosito is a cDbCJGridColumn
77424>>>>>>>            Entry_Item Sofor.sofor_azonosito
77425>>>>>>>            Set piWidth to 86
77426>>>>>>>            Set psCaption to "Azonos¡t¢"
77427>>>>>>>        End_Object 
77428>>>>>>>
77428>>>>>>>        Object oSofor_sofor_nev is a cDbCJGridColumn
77430>>>>>>>            Entry_Item Sofor.sofor_nev
77431>>>>>>>            Set piWidth to 300
77432>>>>>>>            Set psCaption to "N‚v"
77433>>>>>>>        End_Object 
77434>>>>>>>
77434>>>>>>>        Object oSofor_sofor_szigsz is a cDbCJGridColumn
77436>>>>>>>            Entry_Item Sofor.sofor_szigsz
77437>>>>>>>            Set piWidth to 144
77438>>>>>>>            Set psCaption to "Szigsz."
77439>>>>>>>        End_Object 
77440>>>>>>>
77440>>>>>>>
77440>>>>>>>    End_Object 
77441>>>>>>>
77441>>>>>>>    Object oOk_bn is a Button
77443>>>>>>>        Set Label to "&Ok"
77444>>>>>>>        Set Location to 115 122
77445>>>>>>>        Set peAnchors to anBottomRight
77446>>>>>>>
77446>>>>>>>        Procedure OnClick
77449>>>>>>>            Send OK of oSelList
77450>>>>>>>        End_Procedure
77451>>>>>>>
77451>>>>>>>    End_Object 
77452>>>>>>>
77452>>>>>>>    Object oCancel_bn is a Button
77454>>>>>>>        Set Label to "&Cancel"
77455>>>>>>>        Set Location to 115 176
77456>>>>>>>        Set peAnchors to anBottomRight
77457>>>>>>>
77457>>>>>>>        Procedure OnClick
77460>>>>>>>            Send Cancel of oSelList
77461>>>>>>>        End_Procedure
77462>>>>>>>
77462>>>>>>>    End_Object 
77463>>>>>>>
77463>>>>>>>    Object oSearch_bn is a Button
77465>>>>>>>        Set Label to "&Search..."
77466>>>>>>>        Set Location to 115 230
77467>>>>>>>        Set peAnchors to anBottomRight
77468>>>>>>>
77468>>>>>>>        Procedure OnClick
77471>>>>>>>            Send Search of oSelList
77472>>>>>>>        End_Procedure
77473>>>>>>>
77473>>>>>>>    End_Object 
77474>>>>>>>
77474>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77475>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77476>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77477>>>>>>>
77477>>>>>>>
77477>>>>>>>CD_End_Object // Sofor_sl
77479>>>>>>>>
77479>>>
77479>>>ACTIVATE_VIEW Activate_oSoforEntry FOR oSoforEntry
77489>>>>
77489>>>Object oSoforEntry is a dbView
77491>>>    Set Location to 5 5
77492>>>    Set Size to 38 236
77493>>>    Set Label to "Sof‹r"
77494>>>    Set Border_Style to Border_Thick
77495>>>
77495>>>
77495>>>    Object oSofor_DD is a cSoforDataDictionary
77497>>>    End_Object 
77498>>>
77498>>>    Set Main_DD To oSofor_DD
77499>>>    Set Server  To oSofor_DD
77500>>>
77500>>>
77500>>>
77500>>>    Object oSoforsofor_nev is a dbForm
77502>>>        Entry_Item Sofor.sofor_nev
77503>>>        Set Size to 13 186
77504>>>        Set Location to 5 45
77505>>>        Set peAnchors to anTopLeftRight
77506>>>        Set Label to "Sof‹r neve"
77507>>>        Set Label_Justification_mode to jMode_Left
77508>>>        Set Label_Col_Offset to 40
77509>>>        Set Label_row_Offset to 0
77510>>>    End_Object 
77511>>>
77511>>>    Object oSoforsofor_szigsz is a dbForm
77513>>>        Entry_Item Sofor.sofor_szigsz
77514>>>        Set Size to 13 78
77515>>>        Set Location to 20 45
77516>>>        Set peAnchors to anTopLeftRight
77517>>>        Set Label to "Szigsz."
77518>>>        Set Label_Justification_mode to jMode_Left
77519>>>        Set Label_Col_Offset to 40
77520>>>        Set Label_row_Offset to 0
77521>>>    End_Object 
77522>>>
77522>>>
77522>>>End_Object 
77523>        Use TermekEntry.vw
Including file: TermekEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\TermekEntry.vw)
77523>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\TermekEntry.vw
77523>>>// Term‚k
77523>>>//
77523>>>
77523>>>Use DFClient.pkg
77523>>>Use DFEntry.pkg
77523>>>Use Dfcentry.PKG
77523>>>
77523>>>Use cTermekDataDictionary.dd
Including file: cTermekDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cTermekDataDictionary.dd)
77523>>>>>Use DataDict.pkg
77523>>>>>
77523>>>>>Open Termek
Including file: Termek.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\Termek.fd)
77525>>>>>Open FuvarlevelTetel
Including file: FuvarlevelTetel.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\FuvarlevelTetel.fd)
77527>>>>>Open system_table
77529>>>>>
77529>>>>>Register_Object Termek_sl
77529>>>>>
77529>>>>>Class cTermekDataDictionary is a DataDictionary
77530>>>>>    
77530>>>>>    Procedure Construct_Object
77532>>>>>        Forward Send Construct_Object
77534>>>>>        Set Main_File to Termek.File_Number
77535>>>>>
77535>>>>>        Set Add_Client_File to FuvarlevelTetel.File_Number
77536>>>>>
77536>>>>>        Set Add_System_File to system_table.File_Number DD_Lock_On_All
77537>>>>>
77537>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77538>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77539>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77540>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77541>>>>>
77541>>>>>        Set Field_Option Field Termek.termek_azonosito DD_AUTOFIND to True
77542>>>>>        Set Field_Auto_Increment Field Termek.termek_azonosito to File_Field system_table.termek_azonosito
77543>>>>>        Set Key_Field_State Field Termek.termek_azonosito to True
77544>>>>>        Set Field_Prompt_Object Field Termek.termek_azonosito to Termek_sl
77545>>>>>
77545>>>>>        Set Field_Label_Long Field Termek.termek_megnevezes to "N‚v"
77546>>>>>        Set Field_Label_Short Field Termek.termek_megnevezes to "N‚v"
77547>>>>>        Set Field_Prompt_Object Field Termek.termek_megnevezes to Termek_sl
77548>>>>>
77548>>>>>        Set Field_Label_Long Field Termek.termek_egysegar to "Egys‚g r (Ft)"
77549>>>>>        Set Field_Label_Short Field Termek.termek_egysegar to "µr (Ft)"
77550>>>>>
77550>>>>>    End_Procedure
77551>>>>>
77551>>>>>End_Class
77552>>>>>
77552>>>>>Use Termek.sl
Including file: Termek.sl    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\Termek.sl)
77552>>>>>>>// Termek.sl
77552>>>>>>>// Term‚k lista
77552>>>>>>>
77552>>>>>>>Use DFClient.pkg
77552>>>>>>>Use cDbCJGridPromptList.pkg
77552>>>>>>>Use cDbCJGridColumn.pkg
77552>>>>>>>Use Windows.pkg
77552>>>>>>>
77552>>>>>>>Use cTermekDataDictionary.dd
77552>>>>>>>
77552>>>>>>>CD_Popup_Object Termek_sl is a dbModalPanel
77570>>>>>>>>
77570>>>>>>>    Set Location to 5 5
77571>>>>>>>    Set Size to 134 242
77572>>>>>>>    Set Label To "Term‚k lista"
77573>>>>>>>    Set Border_Style to Border_Thick
77574>>>>>>>    Set Minimize_Icon to False
77575>>>>>>>
77575>>>>>>>
77575>>>>>>>    Object oTermek_DD is a cTermekDataDictionary
77577>>>>>>>    End_Object 
77578>>>>>>>
77578>>>>>>>    Set Main_DD To oTermek_DD
77579>>>>>>>    Set Server  To oTermek_DD
77580>>>>>>>
77580>>>>>>>
77580>>>>>>>
77580>>>>>>>    Object oSelList is a cDbCJGridPromptList
77582>>>>>>>        Set Size to 105 232
77583>>>>>>>        Set Location to 5 5
77584>>>>>>>        Set peAnchors to anAll
77585>>>>>>>        Set psLayoutSection to "Termek_sl_oSelList"
77586>>>>>>>        Set Ordering to 1
77587>>>>>>>        Set pbAutoServer to True
77588>>>>>>>
77588>>>>>>>        Object oTermek_termek_azonosito is a cDbCJGridColumn
77590>>>>>>>            Entry_Item Termek.termek_azonosito
77591>>>>>>>            Set piWidth to 72
77592>>>>>>>            Set psCaption to "Id"
77593>>>>>>>        End_Object 
77594>>>>>>>
77594>>>>>>>        Object oTermek_termek_megnevezes is a cDbCJGridColumn
77596>>>>>>>            Entry_Item Termek.termek_megnevezes
77597>>>>>>>            Set piWidth to 300
77598>>>>>>>            Set psCaption to "N‚v"
77599>>>>>>>        End_Object 
77600>>>>>>>
77600>>>>>>>        Object oTermek_termek_egysegar is a cDbCJGridColumn
77602>>>>>>>            Entry_Item Termek.termek_egysegar
77603>>>>>>>            Set piWidth to 72
77604>>>>>>>            Set psCaption to "µr (Ft)"
77605>>>>>>>        End_Object 
77606>>>>>>>
77606>>>>>>>
77606>>>>>>>    End_Object 
77607>>>>>>>
77607>>>>>>>    Object oOk_bn is a Button
77609>>>>>>>        Set Label to "&Ok"
77610>>>>>>>        Set Location to 115 79
77611>>>>>>>        Set peAnchors to anBottomRight
77612>>>>>>>
77612>>>>>>>        Procedure OnClick
77615>>>>>>>            Send OK of oSelList
77616>>>>>>>        End_Procedure
77617>>>>>>>
77617>>>>>>>    End_Object 
77618>>>>>>>
77618>>>>>>>    Object oCancel_bn is a Button
77620>>>>>>>        Set Label to "&Cancel"
77621>>>>>>>        Set Location to 115 133
77622>>>>>>>        Set peAnchors to anBottomRight
77623>>>>>>>
77623>>>>>>>        Procedure OnClick
77626>>>>>>>            Send Cancel of oSelList
77627>>>>>>>        End_Procedure
77628>>>>>>>
77628>>>>>>>    End_Object 
77629>>>>>>>
77629>>>>>>>    Object oSearch_bn is a Button
77631>>>>>>>        Set Label to "&Search..."
77632>>>>>>>        Set Location to 115 187
77633>>>>>>>        Set peAnchors to anBottomRight
77634>>>>>>>
77634>>>>>>>        Procedure OnClick
77637>>>>>>>            Send Search of oSelList
77638>>>>>>>        End_Procedure
77639>>>>>>>
77639>>>>>>>    End_Object 
77640>>>>>>>
77640>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77641>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77642>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77643>>>>>>>
77643>>>>>>>
77643>>>>>>>CD_End_Object // Termek_sl
77645>>>>>>>>
77645>>>
77645>>>ACTIVATE_VIEW Activate_oTermekEntry FOR oTermekEntry
77655>>>>
77655>>>Object oTermekEntry is a dbView
77657>>>    Set Location to 5 5
77658>>>    Set Size to 38 241
77659>>>    Set Label To "Term‚k"
77660>>>    Set Border_Style to Border_Thick
77661>>>
77661>>>
77661>>>    Object oTermek_DD is a cTermekDataDictionary
77663>>>    End_Object 
77664>>>
77664>>>    Set Main_DD To oTermek_DD
77665>>>    Set Server  To oTermek_DD
77666>>>
77666>>>
77666>>>
77666>>>    Object oTermektermek_megnevezes is a dbForm
77668>>>        Entry_Item Termek.termek_megnevezes
77669>>>        Set Size to 13 186
77670>>>        Set Location to 5 50
77671>>>        Set peAnchors to anTopLeftRight
77672>>>        Set Label to "N‚v"
77673>>>        Set Label_Justification_mode to jMode_Left
77674>>>        Set Label_Col_Offset to 45
77675>>>        Set Label_row_Offset to 0
77676>>>    End_Object 
77677>>>
77677>>>    Object oTermektermek_egysegar is a dbForm
77679>>>        Entry_Item Termek.termek_egysegar
77680>>>        Set Size to 13 42
77681>>>        Set Location to 20 50
77682>>>        Set peAnchors to anTopLeftRight
77683>>>        Set Label to "Egys‚g r (Ft)"
77684>>>        Set Label_Justification_mode to jMode_Left
77685>>>        Set Label_Col_Offset to 45
77686>>>        Set Label_row_Offset to 0
77687>>>    End_Object 
77688>>>
77688>>>
77688>>>End_Object 
77689>        Use FuvarlevelEntry.vw
Including file: FuvarlevelEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\FuvarlevelEntry.vw)
77689>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\FuvarlevelEntry.vw
77689>>>// Fuvarlev‚l
77689>>>//
77689>>>
77689>>>Use DFClient.pkg
77689>>>Use DFEntry.pkg
77689>>>Use cDbCJGrid.pkg
77689>>>Use cDbCJGridColumn.pkg
77689>>>
77689>>>Use cTermekDataDictionary.dd
77689>>>Use cSoforDataDictionary.dd
77689>>>Use cAutoDataDictionary.dd
77689>>>Use cFuvarlevelDataDictionary.dd
Including file: cFuvarlevelDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cFuvarlevelDataDictionary.dd)
77689>>>>>Use DataDict.pkg
77689>>>>>
77689>>>>>Open Fuvarlevel
77691>>>>>Open FuvarlevelTetel
77693>>>>>Open Sofor
77695>>>>>Open Auto
77697>>>>>Open system_table
77699>>>>>
77699>>>>>Register_Object Auto_sl
77699>>>>>Register_Object Sofor_sl
77699>>>>>Register_Object Fuvarlevel_sl
77699>>>>>
77699>>>>>Class cFuvarlevelDataDictionary is a DataDictionary
77700>>>>>    
77700>>>>>    Procedure Construct_Object
77702>>>>>        Forward Send Construct_Object
77704>>>>>        Set Main_File to Fuvarlevel.File_Number
77705>>>>>
77705>>>>>        Set Add_Server_File to Auto.File_Number
77706>>>>>        Set Add_Server_File to Sofor.File_Number
77707>>>>>
77707>>>>>        Set Add_System_File to system_table.File_Number DD_Lock_On_All
77708>>>>>
77708>>>>>        Set Add_Client_File to FuvarlevelTetel.File_Number
77709>>>>>
77709>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77710>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77711>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77712>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77713>>>>>
77713>>>>>        Set Field_Auto_Increment Field Fuvarlevel.fuvarl_azonosito to File_Field system_table.fuvarl_azonosito
77714>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_azonosito DD_AUTOFIND to True
77715>>>>>        Set Key_Field_State Field Fuvarlevel.fuvarl_azonosito to True
77716>>>>>        Set Field_Prompt_Object Field Fuvarlevel.fuvarl_azonosito to Fuvarlevel_sl
77717>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_auto_rendszam to "Rendsz m"
77718>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_auto_rendszam DD_AUTOFIND to True
77719>>>>>        Set Field_Prompt_Object Field Fuvarlevel.fuvarl_auto_rendszam to Auto_sl
77720>>>>>
77720>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_sofor_azonosito DD_REQUIRED to True
77721>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_sofor_azonosito to "Sof‹r"
77722>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_sofor_azonosito DD_AUTOFIND to True
77723>>>>>        Set Field_Prompt_Object Field Fuvarlevel.fuvarl_sofor_azonosito to Sofor_sl
77724>>>>>
77724>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_munkaido_menyiseg DD_REQUIRED to True
77725>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_munkaido_menyiseg to "Munkaid‹ (¢ra)"
77726>>>>>
77726>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_datum DD_REQUIRED to True
77727>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_datum to "Teljes¡t‚s d tuma"
77728>>>>>        Set Field_Label_Short Field Fuvarlevel.fuvarl_datum to "D tum"
77729>>>>>        Set Field_Value_Range Field Fuvarlevel.fuvarl_datum to 01/01/2015 12/31/2017
77730>>>>>        Set Field_Mask Field Fuvarlevel.fuvarl_datum to "####.##.##"
77731>>>>>
77731>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_uzemanyag_mennyiseg DD_REQUIRED to True
77732>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_uzemanyag_mennyiseg to "šzemanyag (liter)"
77733>>>>>        Set Field_Label_Short Field Fuvarlevel.fuvarl_uzemanyag_mennyiseg to "šzemanyag (l)"
77734>>>>>
77734>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_uzemanyag_egysegar DD_REQUIRED to True
77735>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_uzemanyag_egysegar to "šzemanyag egys‚g r"
77736>>>>>        Set Field_Label_Short Field Fuvarlevel.fuvarl_uzemanyag_egysegar to "ša. e r."
77737>>>>>
77737>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_teljesitett_km to "Teljes¡tett kil¢m‚ter"
77738>>>>>        Set Field_Label_Short Field Fuvarlevel.fuvarl_teljesitett_km to "Kil¢m‚ter"
77739>>>>>
77739>>>>>    End_Procedure
77740>>>>>
77740>>>>>End_Class
77741>>>>>
77741>>>>>Use Fuvarlevel.sl
Including file: Fuvarlevel.sl    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\Fuvarlevel.sl)
77741>>>>>>>// Fuvarlevel.sl
77741>>>>>>>// Fuvarlev‚l lista
77741>>>>>>>
77741>>>>>>>Use DFClient.pkg
77741>>>>>>>Use cDbCJGridPromptList.pkg
77741>>>>>>>Use cDbCJGridColumn.pkg
77741>>>>>>>Use Windows.pkg
77741>>>>>>>
77741>>>>>>>Use cSoforDataDictionary.dd
77741>>>>>>>Use cAutoDataDictionary.dd
77741>>>>>>>Use cFuvarlevelDataDictionary.dd
77741>>>>>>>
77741>>>>>>>CD_Popup_Object Fuvarlevel_sl is a dbModalPanel
77759>>>>>>>>
77759>>>>>>>    Set Location to 5 5
77760>>>>>>>    Set Size to 134 482
77761>>>>>>>    Set Label To "Fuvarlev‚l lista"
77762>>>>>>>    Set Border_Style to Border_Thick
77763>>>>>>>    Set Minimize_Icon to False
77764>>>>>>>
77764>>>>>>>
77764>>>>>>>    Object oSofor_DD is a cSoforDataDictionary
77766>>>>>>>    End_Object 
77767>>>>>>>
77767>>>>>>>    Object oAuto_DD is a cAutoDataDictionary
77769>>>>>>>    End_Object 
77770>>>>>>>
77770>>>>>>>    Object oFuvarlevel_DD is a cFuvarlevelDataDictionary
77772>>>>>>>        Set DDO_Server To oAuto_DD
77773>>>>>>>        Set DDO_Server To oSofor_DD
77774>>>>>>>    End_Object 
77775>>>>>>>
77775>>>>>>>    Set Main_DD To oFuvarlevel_DD
77776>>>>>>>    Set Server  To oFuvarlevel_DD
77777>>>>>>>
77777>>>>>>>
77777>>>>>>>
77777>>>>>>>    Object oSelList is a cDbCJGridPromptList
77779>>>>>>>        Set Size to 105 472
77780>>>>>>>        Set Location to 5 5
77781>>>>>>>        Set peAnchors to anAll
77782>>>>>>>        Set psLayoutSection to "Fuvarlevel_sl_oSelList"
77783>>>>>>>        Set Ordering to 1
77784>>>>>>>        Set pbAutoServer to True
77785>>>>>>>
77785>>>>>>>        Object oFuvarlevel_fuvarl_azonosito is a cDbCJGridColumn
77787>>>>>>>            Entry_Item Fuvarlevel.fuvarl_azonosito
77788>>>>>>>            Set piWidth to 120
77789>>>>>>>            Set psCaption to "Id"
77790>>>>>>>        End_Object 
77791>>>>>>>
77791>>>>>>>        Object oFuvarlevel_fuvarl_datum is a cDbCJGridColumn
77793>>>>>>>            Entry_Item Fuvarlevel.fuvarl_datum
77794>>>>>>>            Set piWidth to 120
77795>>>>>>>            Set psCaption to "D tum"
77796>>>>>>>        End_Object 
77797>>>>>>>
77797>>>>>>>        Object oSofor_sofor_nev is a cDbCJGridColumn
77799>>>>>>>            Entry_Item Sofor.sofor_nev
77800>>>>>>>            Set piWidth to 300
77801>>>>>>>            Set psCaption to "N‚v"
77802>>>>>>>        End_Object 
77803>>>>>>>
77803>>>>>>>        Object oAuto_auto_tipus is a cDbCJGridColumn
77805>>>>>>>            Entry_Item Auto.auto_tipus
77806>>>>>>>            Set piWidth to 300
77807>>>>>>>            Set psCaption to "Aut¢ t¡pus"
77808>>>>>>>        End_Object 
77809>>>>>>>
77809>>>>>>>        Object oFuvarlevel_fuvarl_teljesitett_km is a cDbCJGridColumn
77811>>>>>>>            Entry_Item Fuvarlevel.fuvarl_teljesitett_km
77812>>>>>>>            Set piWidth to 84
77813>>>>>>>            Set psCaption to "Kil¢m‚ter"
77814>>>>>>>        End_Object 
77815>>>>>>>
77815>>>>>>>
77815>>>>>>>    End_Object 
77816>>>>>>>
77816>>>>>>>    Object oOk_bn is a Button
77818>>>>>>>        Set Label to "&Ok"
77819>>>>>>>        Set Location to 115 319
77820>>>>>>>        Set peAnchors to anBottomRight
77821>>>>>>>
77821>>>>>>>        Procedure OnClick
77824>>>>>>>            Send OK of oSelList
77825>>>>>>>        End_Procedure
77826>>>>>>>
77826>>>>>>>    End_Object 
77827>>>>>>>
77827>>>>>>>    Object oCancel_bn is a Button
77829>>>>>>>        Set Label to "&Cancel"
77830>>>>>>>        Set Location to 115 373
77831>>>>>>>        Set peAnchors to anBottomRight
77832>>>>>>>
77832>>>>>>>        Procedure OnClick
77835>>>>>>>            Send Cancel of oSelList
77836>>>>>>>        End_Procedure
77837>>>>>>>
77837>>>>>>>    End_Object 
77838>>>>>>>
77838>>>>>>>    Object oSearch_bn is a Button
77840>>>>>>>        Set Label to "&Search..."
77841>>>>>>>        Set Location to 115 427
77842>>>>>>>        Set peAnchors to anBottomRight
77843>>>>>>>
77843>>>>>>>        Procedure OnClick
77846>>>>>>>            Send Search of oSelList
77847>>>>>>>        End_Procedure
77848>>>>>>>
77848>>>>>>>    End_Object 
77849>>>>>>>
77849>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77850>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77851>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77852>>>>>>>
77852>>>>>>>
77852>>>>>>>CD_End_Object // Fuvarlevel_sl
77854>>>>>>>>
77854>>>>>Use Sofor.sl
77854>>>>>Use Auto.sl
77854>>>Use cFuvarlevelTetelDataDictionary.dd
Including file: cFuvarlevelTetelDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cFuvarlevelTetelDataDictionary.dd)
77854>>>>>Use DataDict.pkg
77854>>>>>
77854>>>>>Open FuvarlevelTetel
77856>>>>>Open Fuvarlevel
77858>>>>>Open system_table
77860>>>>>Open Termek
77862>>>>>
77862>>>>>Register_Object Fuvarlevel_sl
77862>>>>>Register_Object Termek_sl
77862>>>>>
77862>>>>>Class cFuvarlevelTetelDataDictionary is a DataDictionary
77863>>>>>    
77863>>>>>    Procedure Construct_Object
77865>>>>>        Forward Send Construct_Object
77867>>>>>        Set Main_File to FuvarlevelTetel.File_Number
77868>>>>>
77868>>>>>        Set Add_System_File to system_table.File_Number DD_Lock_On_All
77869>>>>>
77869>>>>>        Set Add_Server_File to Fuvarlevel.File_Number
77870>>>>>        Set Add_Server_File to Termek.File_Number
77871>>>>>
77871>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77872>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77873>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77874>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77875>>>>>
77875>>>>>        Set Key_Field_State Field FuvarlevelTetel.fuvarl_tetel_azonosito to True
77876>>>>>        Set Field_Auto_Increment Field FuvarlevelTetel.fuvarl_tetel_azonosito to File_Field system_table.fuvarl_tetel_azonosito
77877>>>>>
77877>>>>>        Set Field_Label_Long Field FuvarlevelTetel.fuvarl_tetel_fuvarl_azonosito to "Fuvarlev‚l"
77878>>>>>        Set Field_Label_Short Field FuvarlevelTetel.fuvarl_tetel_fuvarl_azonosito to "Fuvarl."
77879>>>>>        Set Field_Prompt_Object Field FuvarlevelTetel.fuvarl_tetel_fuvarl_azonosito to Fuvarlevel_sl
77880>>>>>        Set Field_Option Field FuvarlevelTetel.fuvarl_tetel_fuvarl_azonosito DD_AUTOFIND to True
77881>>>>>
77881>>>>>        Set Field_Label_Long Field FuvarlevelTetel.fuvarl_tetel_termek_azonosito to "Term‚k"
77882>>>>>        Set Field_Label_Short Field FuvarlevelTetel.fuvarl_tetel_termek_azonosito to "Term‚k"
77883>>>>>        Set Field_Prompt_Object Field FuvarlevelTetel.fuvarl_tetel_termek_azonosito to Termek_sl
77884>>>>>        Set Field_Option Field FuvarlevelTetel.fuvarl_tetel_termek_azonosito DD_AUTOFIND to True
77885>>>>>
77885>>>>>        Set Field_Label_Long Field FuvarlevelTetel.fuvarl_tetel_termek_mennyiseg to "Mennyis‚g"
77886>>>>>        Set Field_Label_Short Field FuvarlevelTetel.fuvarl_tetel_termek_mennyiseg to "Mennyis‚g"
77887>>>>>
77887>>>>>    End_Procedure
77888>>>>>
77888>>>>>End_Class
77889>>>>>
77889>>>>>Use Termek.sl
77889>>>>>Use Fuvarlevel.sl
77889>>>
77889>>>ACTIVATE_VIEW Activate_oFuvarlevelEntry FOR oFuvarlevelEntry
77899>>>>
77899>>>Object oFuvarlevelEntry is a dbView
77901>>>    Set Location to 5 5
77902>>>    Set Size to 222 522
77903>>>    Set Label To "Fuvarlev‚l"
77904>>>    Set Border_Style to Border_Thick
77905>>>
77905>>>
77905>>>    Object oTermek_DD is a cTermekDataDictionary
77907>>>    End_Object 
77908>>>
77908>>>    Object oSofor_DD is a cSoforDataDictionary
77910>>>    End_Object 
77911>>>
77911>>>    Object oAuto_DD is a cAutoDataDictionary
77913>>>    End_Object 
77914>>>
77914>>>    Object oFuvarlevel_DD is a cFuvarlevelDataDictionary
77916>>>        Set DDO_Server To oAuto_DD
77917>>>        Set DDO_Server To oSofor_DD
77918>>>        // this lets you save a new parent DD from within child DD
77918>>>        Set Allow_Foreign_New_Save_State to True
77919>>>    End_Object 
77920>>>
77920>>>    Object oFuvarlevelTetel_DD is a cFuvarlevelTetelDataDictionary
77922>>>        Set DDO_Server To oFuvarlevel_DD
77923>>>        Set DDO_Server To oTermek_DD
77924>>>        Set Constrain_File To Fuvarlevel.File_Number
77925>>>    End_Object 
77926>>>
77926>>>    Set Main_DD To oFuvarlevel_DD
77927>>>    Set Server  To oFuvarlevel_DD
77928>>>
77928>>>
77928>>>
77928>>>    Object oFuvarlevelfuvarl_azonosito is a dbForm
77930>>>        Entry_Item Fuvarlevel.fuvarl_azonosito
77931>>>        Set Size to 13 127
77932>>>        Set Location to 5 78
77933>>>        Set peAnchors to anTopLeftRight
77934>>>        Set Label to "fuvarl azonosito"
77935>>>        Set Label_Justification_mode to jMode_Left
77936>>>        Set Label_Col_Offset to 73
77937>>>        Set Label_row_Offset to 0
77938>>>    End_Object 
77939>>>
77939>>>    Object oFuvarlevelfuvarl_datum is a dbForm
77941>>>        Entry_Item Fuvarlevel.fuvarl_datum
77942>>>        Set Size to 13 128
77943>>>        Set Location to 20 78
77944>>>        Set peAnchors to anTopLeftRight
77945>>>        Set Label to "Teljes¡t‚s d tuma"
77946>>>        Set Label_Justification_mode to jMode_Left
77947>>>        Set Label_Col_Offset to 73
77948>>>        Set Label_row_Offset to 0
77949>>>    End_Object 
77950>>>
77950>>>    Object oSoforsofor_azonosito is a dbForm
77952>>>        Entry_Item Sofor.sofor_azonosito
77953>>>        Set Size to 13 127
77954>>>        Set Location to 35 78
77955>>>        Set peAnchors to anTopLeftRight
77956>>>        Set Label to "Sof‹r"
77957>>>        Set Label_Justification_mode to jMode_Left
77958>>>        Set Label_Col_Offset to 73
77959>>>        Set Label_row_Offset to 0
77960>>>    End_Object 
77961>>>
77961>>>    Object oFuvarlevelfuvarl_munkaido_menyiseg is a dbForm
77963>>>        Entry_Item Fuvarlevel.fuvarl_munkaido_menyiseg
77964>>>        Set Size to 13 129
77965>>>        Set Location to 50 78
77966>>>        Set peAnchors to anTopLeftRight
77967>>>        Set Label to "Munkaid‹ (¢ra)"
77968>>>        Set Label_Justification_mode to jMode_Left
77969>>>        Set Label_Col_Offset to 73
77970>>>        Set Label_row_Offset to 0
77971>>>    End_Object 
77972>>>
77972>>>    Object oAutoauto_rendszam is a dbForm
77974>>>        Entry_Item Auto.auto_rendszam
77975>>>        Set Size to 13 129
77976>>>        Set Location to 65 78
77977>>>        Set peAnchors to anTopLeftRight
77978>>>        Set Label to "Rendsz m"
77979>>>        Set Label_Justification_mode to jMode_Left
77980>>>        Set Label_Col_Offset to 73
77981>>>        Set Label_row_Offset to 0
77982>>>    End_Object 
77983>>>
77983>>>    Object oFuvarlevelfuvarl_teljesitett_km is a dbForm
77985>>>        Entry_Item Fuvarlevel.fuvarl_teljesitett_km
77986>>>        Set Size to 13 130
77987>>>        Set Location to 80 78
77988>>>        Set peAnchors to anTopLeftRight
77989>>>        Set Label to "Teljes¡tett kil¢m‚ter"
77990>>>        Set Label_Justification_mode to jMode_Left
77991>>>        Set Label_Col_Offset to 73
77992>>>        Set Label_row_Offset to 0
77993>>>    End_Object 
77994>>>
77994>>>    Object oFuvarlevelfuvarl_uzemanyag_mennyiseg is a dbForm
77996>>>        Entry_Item Fuvarlevel.fuvarl_uzemanyag_mennyiseg
77997>>>        Set Size to 13 131
77998>>>        Set Location to 95 78
77999>>>        Set peAnchors to anTopLeftRight
78000>>>        Set Label to "šzemanyag (liter)"
78001>>>        Set Label_Justification_mode to jMode_Left
78002>>>        Set Label_Col_Offset to 73
78003>>>        Set Label_row_Offset to 0
78004>>>    End_Object 
78005>>>
78005>>>    Object oFuvarlevelfuvarl_uzemanyag_egysegar is a dbForm
78007>>>        Entry_Item Fuvarlevel.fuvarl_uzemanyag_egysegar
78008>>>        Set Size to 13 131
78009>>>        Set Location to 110 78
78010>>>        Set peAnchors to anTopLeftRight
78011>>>        Set Label to "šzemanyag egys‚g r"
78012>>>        Set Label_Justification_mode to jMode_Left
78013>>>        Set Label_Col_Offset to 73
78014>>>        Set Label_row_Offset to 0
78015>>>    End_Object 
78016>>>
78016>>>    Object oDetailGrid is a cDbCJGrid
78018>>>        Set Size to 84 464
78019>>>        Set Location to 133 5
78020>>>        Set Server to oFuvarlevelTetel_DD
78021>>>        Set Ordering to 5
78022>>>        Set peAnchors to anAll
78023>>>        Set psLayoutSection to "oFuvarlevelEntry_oDetailGrid"
78024>>>        Set pbAllowInsertRow to False
78025>>>        Set pbHeaderPrompts to True
78026>>>
78026>>>        Object oTermek_termek_azonosito is a cDbCJGridColumn
78028>>>            Entry_Item Termek.termek_azonosito
78029>>>            Set piWidth to 412
78030>>>            Set psCaption to "Term‚k"
78031>>>        End_Object 
78032>>>
78032>>>        Object oFuvarlevelTetel_fuvarl_tetel_termek_mennyiseg is a cDbCJGridColumn
78034>>>            Entry_Item FuvarlevelTetel.fuvarl_tetel_termek_mennyiseg
78035>>>            Set piWidth to 516
78036>>>            Set psCaption to "Mennyis‚g"
78037>>>        End_Object 
78038>>>
78038>>>    End_Object 
78039>>>
78039>>>    //-----------------------------------------------------------------------
78039>>>    // Create custom confirmation messages for save and delete
78039>>>    // We must create the new functions and assign verify messages
78039>>>    // to them.
78039>>>    //-----------------------------------------------------------------------
78039>>>
78039>>>    Function ConfirmDeleteHeader Returns Boolean
78042>>>        Boolean bFail
78042>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
78043>>>        Function_Return bFail
78044>>>    End_Function 
78045>>>
78045>>>    // Only confirm on the saving of new records
78045>>>    Function ConfirmSaveHeader Returns Boolean
78048>>>        Boolean bNoSave bHasRecord
78048>>>        Handle  hoSrvr
78048>>>        Get Server to hoSrvr
78049>>>        Get HasRecord of hoSrvr to bHasRecord
78050>>>        If not bHasRecord Begin
78052>>>            Get Confirm "Save this NEW header?" to bNoSave
78053>>>        End
78053>>>>
78053>>>        Function_Return bNoSave
78054>>>    End_Function 
78055>>>
78055>>>    // Define alternate confirmation Messages
78055>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
78056>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
78057>>>    // Saves in header should not clear the view
78057>>>    Set Auto_Clear_Deo_State to False
78058>>>
78058>>>
78058>>>End_Object 
78059>        Use FuvarlevelTetelEntry.vw
Including file: FuvarlevelTetelEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\FuvarlevelTetelEntry.vw)
78059>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\FuvarlevelTetelEntry.vw
78059>>>// Fuvarlev‚l t‚tel
78059>>>//
78059>>>
78059>>>Use DFClient.pkg
78059>>>Use DFEntry.pkg
78059>>>
78059>>>Use cTermekDataDictionary.dd
78059>>>Use cSoforDataDictionary.dd
78059>>>Use cAutoDataDictionary.dd
78059>>>Use cFuvarlevelDataDictionary.dd
78059>>>Use cFuvarlevelTetelDataDictionary.dd
78059>>>
78059>>>ACTIVATE_VIEW Activate_oFuvarlevelTetelEntry FOR oFuvarlevelTetelEntry
78069>>>>
78069>>>Object oFuvarlevelTetelEntry is a dbView
78071>>>    Set Location to 5 5
78072>>>    Set Size to 66 288
78073>>>    Set Label To "Fuvarlev‚l t‚tel"
78074>>>    Set Border_Style to Border_Thick
78075>>>
78075>>>
78075>>>    Object oTermek_DD is a cTermekDataDictionary
78077>>>    End_Object 
78078>>>
78078>>>    Object oSofor_DD is a cSoforDataDictionary
78080>>>    End_Object 
78081>>>
78081>>>    Object oAuto_DD is a cAutoDataDictionary
78083>>>    End_Object 
78084>>>
78084>>>    Object oFuvarlevel_DD is a cFuvarlevelDataDictionary
78086>>>        Set DDO_Server To oAuto_DD
78087>>>        Set DDO_Server To oSofor_DD
78088>>>    End_Object 
78089>>>
78089>>>    Object oFuvarlevelTetel_DD is a cFuvarlevelTetelDataDictionary
78091>>>        Set DDO_Server To oFuvarlevel_DD
78092>>>        Set DDO_Server To oTermek_DD
78093>>>    End_Object 
78094>>>
78094>>>    Set Main_DD To oFuvarlevelTetel_DD
78095>>>    Set Server  To oFuvarlevelTetel_DD
78096>>>
78096>>>
78096>>>
78096>>>    Object oFuvarlevelfuvarl_azonosito is a dbForm
78098>>>        Entry_Item Fuvarlevel.fuvarl_azonosito
78099>>>        Set Size to 13 241
78100>>>        Set Location to 5 42
78101>>>        Set peAnchors to anTopLeftRight
78102>>>        Set Label to "Fuvarlev‚l"
78103>>>        Set Label_Justification_mode to jMode_Left
78104>>>        Set Label_Col_Offset to 37
78105>>>        Set Label_row_Offset to 0
78106>>>    End_Object 
78107>>>
78107>>>    Object oTermektermek_azonosito is a dbForm
78109>>>        Entry_Item Termek.termek_azonosito
78110>>>        Set Size to 13 217
78111>>>        Set Location to 20 42
78112>>>        Set peAnchors to anTopLeftRight
78113>>>        Set Label to "Term‚k"
78114>>>        Set Label_Justification_mode to jMode_Left
78115>>>        Set Label_Col_Offset to 37
78116>>>        Set Label_row_Offset to 0
78117>>>    End_Object 
78118>>>
78118>>>    Object oFuvarlevelTetelfuvarl_tetel_termek_mennyiseg is a dbForm
78120>>>        Entry_Item FuvarlevelTetel.fuvarl_tetel_termek_mennyiseg
78121>>>        Set Size to 13 209
78122>>>        Set Location to 35 42
78123>>>        Set peAnchors to anTopLeftRight
78124>>>        Set Label to "Mennyis‚g"
78125>>>        Set Label_Justification_mode to jMode_Left
78126>>>        Set Label_Col_Offset to 37
78127>>>        Set Label_row_Offset to 0
78128>>>    End_Object 
78129>>>
78129>>>
78129>>>End_Object 
78130>
78130>        Procedure Activate_About
78133>            Send DoAbout "" "" "" "" ""
78134>        End_Procedure
78135>
78135>    End_Object
78136>
78136>End_Object
78137>
78137>Start_UI
78138>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 44512
Total Resources: 0
Total Commands : 78137
Total Windows  : 1
Total Pages    : 1
Static Data    : 473307
Message area   : 543551
Total Blocks   : 28028
