Compiling Program: C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\SzallitmanyozoCeg.src
Memory Available: 2147483646
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\dfallent.pkd)
75288>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardCommandBarSystem.pkg)
75288>>>// these are all the packages used in a standard MDI menubar/toolbar system
75288>>>
75288>>>Use cCJCommandBarSystem.pkg
75288>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardMenuItemClasses.pkg)
75288>>>>>Use Dfpanel.pkg
75288>>>>>Use cCJCommandBarSystem.pkg
75288>>>>>Use LanguageText.pkg
75288>>>>>
75288>>>>>
75288>>>>>Class cCJUndoMenuItem is a cCJMenuItem
75289>>>>>    
75289>>>>>    Procedure Construct_Object
75291>>>>>        Forward Send Construct_Object
75293>>>>>        Set psCaption   to C_$CaptionUndo
75294>>>>>        Set psToolTip to C_$ToolTipUndo
75295>>>>>        Set psDescription to C_$DescUndo
75296>>>>>        Set psImage to "ActionUndo.ico"
75297>>>>>        Set pbActiveUpdate to True
75298>>>>>        Set psCategory to C_$CategoryEdit
75299>>>>>        Set psShortcut to C_$Key_Ctrl_Z
75300>>>>>    End_Procedure
75301>>>>>
75301>>>>>    Procedure OnExecute Variant vCommandBarControl
75303>>>>>        Send Undo of (focus(Self))
75304>>>>>    End_Procedure
75305>>>>>    
75305>>>>>    Function IsEnabled Returns Boolean
75307>>>>>        Boolean bEnabled
75307>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
75308>>>>>        Function_Return bEnabled
75309>>>>>    End_Function
75310>>>>>         
75310>>>>>End_Class
75311>>>>>
75311>>>>>
75311>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
75312>>>>>    
75312>>>>>    Procedure Construct_Object
75314>>>>>        Forward Send Construct_Object
75316>>>>>        Set psCaption   to C_$CaptionDelete
75317>>>>>        Set psToolTip to C_$ToolTipDelete
75318>>>>>        Set psDescription to C_$DescDelete
75319>>>>>        Set psImage to "actionDelete.ico"
75320>>>>>        Set psShortcut to C_$Key_Delete
75321>>>>>        Set pbActiveUpdate to True
75322>>>>>        Set psCategory to C_$CategoryEdit
75323>>>>>    End_Procedure
75324>>>>>
75324>>>>>
75324>>>>>    Procedure OnExecute Variant vCommandBarControl
75326>>>>>        Send Delete of (focus(Self))
75327>>>>>    End_Procedure
75328>>>>>    
75328>>>>>    Function IsEnabled Returns Boolean
75330>>>>>        Boolean bEnabled
75330>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
75331>>>>>        Function_Return bEnabled
75332>>>>>    End_Function
75333>>>>>         
75333>>>>>End_Class
75334>>>>>
75334>>>>>
75334>>>>>Class cCJCutMenuItem is a cCJMenuItem
75335>>>>>    
75335>>>>>    Procedure Construct_Object
75337>>>>>        Forward Send Construct_Object
75339>>>>>        Set psCaption   to C_$CaptionCut
75340>>>>>        Set psToolTip to C_$TooltipCut
75341>>>>>        Set psDescription to C_$DescCut
75342>>>>>        Set psImage to "actionCut.ico"
75343>>>>>        Set psShortcut to C_$Key_Ctrl_X
75344>>>>>        Set pbActiveUpdate to True
75345>>>>>        Set psCategory to C_$CategoryEdit
75346>>>>>    End_Procedure
75347>>>>>
75347>>>>>
75347>>>>>    Procedure OnExecute Variant vCommandBarControl
75349>>>>>        Send Cut of (focus(Self))
75350>>>>>    End_Procedure
75351>>>>>    
75351>>>>>    Function IsEnabled Returns Boolean
75353>>>>>        Boolean bEnabled
75353>>>>>        Get CanCut of (Focus(Self)) to bEnabled
75354>>>>>        Function_Return bEnabled
75355>>>>>    End_Function
75356>>>>>         
75356>>>>>End_Class
75357>>>>>
75357>>>>>
75357>>>>>Class cCJCopyMenuItem is a cCJMenuItem
75358>>>>>    
75358>>>>>    Procedure Construct_Object
75360>>>>>        Forward Send Construct_Object
75362>>>>>        Set psCaption   to C_$CaptionCopy
75363>>>>>        Set psToolTip to C_$ToolTipCopy
75364>>>>>        Set psDescription to C_$DescCopy
75365>>>>>        Set psImage to "actionCopy.ico"
75366>>>>>        Set psShortcut to C_$Key_Ctrl_C
75367>>>>>        Set pbActiveUpdate to True
75368>>>>>        Set psCategory to C_$CategoryEdit
75369>>>>>    End_Procedure
75370>>>>>
75370>>>>>
75370>>>>>    Procedure OnExecute Variant vCommandBarControl
75372>>>>>        Send Copy of (focus(Self))
75373>>>>>    End_Procedure
75374>>>>>    
75374>>>>>    Function IsEnabled Returns Boolean
75376>>>>>        Boolean bEnabled
75376>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
75377>>>>>        Function_Return bEnabled
75378>>>>>    End_Function
75379>>>>>         
75379>>>>>End_Class
75380>>>>>
75380>>>>>
75380>>>>>Class cCJPasteMenuItem is a cCJMenuItem
75381>>>>>    
75381>>>>>    Procedure Construct_Object
75383>>>>>        Forward Send Construct_Object
75385>>>>>        Set psCaption   to C_$CaptionPaste
75386>>>>>        Set psToolTip to C_$ToolTipPaste
75387>>>>>        Set psDescription to C_$DescPaste
75388>>>>>        Set psImage to "actionPaste.ico"
75389>>>>>        Set pbActiveUpdate to True
75390>>>>>        Set psShortcut to C_$Key_Ctrl_V
75391>>>>>        Set psCategory to C_$CategoryEdit
75392>>>>>    End_Procedure
75393>>>>>
75393>>>>>
75393>>>>>    Procedure OnExecute Variant vCommandBarControl
75395>>>>>        Send Paste of (focus(Self))
75396>>>>>    End_Procedure
75397>>>>>    
75397>>>>>    Function IsEnabled Returns Boolean
75399>>>>>        Boolean bEnabled
75399>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
75400>>>>>        Function_Return bEnabled
75401>>>>>    End_Function
75402>>>>>         
75402>>>>>End_Class
75403>>>>>
75403>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
75404>>>>>    
75404>>>>>    Procedure Construct_Object
75406>>>>>        Forward Send Construct_Object
75408>>>>>        Set psCaption   to C_$CaptionSelectAll
75409>>>>>        Set psToolTip to C_$ToolTipSelectAll
75410>>>>>        Set psDescription to C_$DescSelectAll
75411>>>>>        Set pbActiveUpdate to True
75412>>>>>        Set psShortcut to C_$Key_Ctrl_A
75413>>>>>        Set psCategory to C_$CategoryEdit
75414>>>>>    End_Procedure
75415>>>>>
75415>>>>>
75415>>>>>    Procedure OnExecute Variant vCommandBarControl
75417>>>>>        Send Select_All of (focus(Self))
75418>>>>>    End_Procedure
75419>>>>>    
75419>>>>>    Function IsEnabled Returns Boolean
75421>>>>>        Boolean bEnabled
75421>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
75422>>>>>        Function_Return bEnabled
75423>>>>>    End_Function
75424>>>>>         
75424>>>>>End_Class
75425>>>>>
75425>>>>> 
75425>>>>>Class cCJExitMenuItem is a cCJMenuItem
75426>>>>>
75426>>>>>    Procedure Construct_Object
75428>>>>>        Forward Send Construct_Object
75430>>>>>        Set psCaption to C_$CaptionExit
75431>>>>>        Set psToolTip to C_$ToolTipExit
75432>>>>>        Set psDescription to C_$ToolTipExit
75433>>>>>        Set psShortcut to C_$Key_Alt_F4
75434>>>>>        Set psCategory to C_$CategoryFile
75435>>>>>    End_Procedure
75436>>>>>
75436>>>>>    Procedure OnExecute Variant vCommandBarControl
75438>>>>>        Send Exit_Application of Desktop
75439>>>>>    End_Procedure
75440>>>>>
75440>>>>>End_Class           
75441>>>>>
75441>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
75442>>>>>
75442>>>>>    Procedure Construct_Object
75444>>>>>        Forward Send Construct_Object
75446>>>>>        Set psCaption to C_$CaptionHelp
75447>>>>>        Set psDescription to C_$ToolTipHelp
75448>>>>>        Set psToolTip to C_$DescHelp
75449>>>>>        Set psImage to "ActionHelp.ico"
75450>>>>>        Set psShortcut to "F1"
75451>>>>>        Set psCategory to C_$CategoryHelp
75452>>>>>    End_Procedure
75453>>>>>    
75453>>>>>    Procedure OnExecute Variant vCommandBarControl
75455>>>>>        Send Help of (Focus(Self))
75456>>>>>    End_Procedure
75457>>>>>
75457>>>>>End_Class
75458>>>>>
75458>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
75459>>>>>
75459>>>>>    Procedure Construct_Object
75461>>>>>        Forward Send Construct_Object
75463>>>>>        Set psCaption to C_$CaptionAddStatusbar
75464>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
75465>>>>>        Set psDescription to  C_$DescAddStatusbar
75466>>>>>        Set psCategory to C_$CategoryWindow
75467>>>>>    End_Procedure
75468>>>>>
75468>>>>>    Procedure OnExecute Variant vCommandBarControl
75470>>>>>        Handle hoCommandBars hoClientArea
75470>>>>>        Get CommandBarSystemObject to hoCommandBars
75471>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75472>>>>>        If hoClientArea Begin
75474>>>>>            // the clientarea's parent panel has message
75474>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
75475>>>>>        End
75475>>>>>>
75475>>>>>    End_Procedure
75476>>>>>
75476>>>>>     Function IsChecked Returns Boolean
75478>>>>>        Boolean bOn
75478>>>>>        Handle hoCommandBars hoClientArea
75478>>>>>        Get CommandBarSystemObject to hoCommandBars
75479>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75480>>>>>        If hoClientArea Begin
75482>>>>>            // the clientarea's parent panel has message
75482>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
75483>>>>>        End
75483>>>>>>
75483>>>>>        Function_Return bOn
75484>>>>>     End_Function
75485>>>>>End_Class
75486>>>>>
75486>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
75487>>>>>
75487>>>>>    Procedure Construct_Object
75489>>>>>        Forward Send Construct_Object
75491>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
75492>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
75493>>>>>        Set psDescription to C_$DescAutoArrangeIcons
75494>>>>>        Set psCategory to C_$CategoryWindow
75495>>>>>    End_Procedure
75496>>>>>
75496>>>>>    Procedure OnExecute Variant vCommandBarControl
75498>>>>>        Handle hoCommandBars hoClientArea
75498>>>>>        Get CommandBarSystemObject to hoCommandBars
75499>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75500>>>>>        If hoClientArea Begin
75502>>>>>            // the clientarea's parent panel has message
75502>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
75503>>>>>        End
75503>>>>>>
75503>>>>>    End_Procedure
75504>>>>>    
75504>>>>>     Function IsChecked Returns Boolean
75506>>>>>        Boolean bOn
75506>>>>>        Handle hoCommandBars hoClientArea
75506>>>>>        Get CommandBarSystemObject to hoCommandBars
75507>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75508>>>>>        If hoClientArea Begin
75510>>>>>            // the clientarea's parent panel has message
75510>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
75511>>>>>        End
75511>>>>>>
75511>>>>>        Function_Return bOn
75512>>>>>     End_Function
75513>>>>>End_Class
75514>>>>>
75514>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
75515>>>>>
75515>>>>>    Procedure Construct_Object
75517>>>>>        Forward Send Construct_Object
75519>>>>>        Set psCaption to C_$CaptionRestoreMenus
75520>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
75521>>>>>        Set psDescription to C_$DescRestoreMenus
75522>>>>>        Set psCategory to C_$CategoryWindow
75523>>>>>    End_Procedure
75524>>>>>
75524>>>>>    Procedure OnExecute Variant vCommandBarControl
75526>>>>>        Handle hoCommandBars
75526>>>>>        Get CommandBarSystemObject to hoCommandBars
75527>>>>>        Send RestoreLayout of hoCommandBars
75528>>>>>    End_Procedure
75529>>>>>    
75529>>>>>End_Class
75530>>>>>
75530>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
75531>>>>>
75531>>>>>    Procedure Construct_Object
75533>>>>>        Forward Send Construct_Object
75535>>>>>        Set psCaption to C_$CaptionCascade
75536>>>>>        Set psToolTip to C_$ToolTipCascade
75537>>>>>        Set psDescription to  C_$DescCascade
75538>>>>>        Set psImage to "ActionCascade.ico"
75539>>>>>        Set psCategory to C_$CategoryWindow
75540>>>>>    End_Procedure
75541>>>>>    
75541>>>>>    Procedure OnExecute Variant vCommandBarControl
75543>>>>>        Handle hoCommandBars hoClientArea
75543>>>>>        Get CommandBarSystemObject to hoCommandBars
75544>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75545>>>>>        If hoClientArea Begin
75547>>>>>            Send Cascade_Windows of hoClientArea
75548>>>>>        End
75548>>>>>>
75548>>>>>    End_Procedure
75549>>>>>End_Class
75550>>>>>
75550>>>>>Class cCJTileHorizontally is a cCJMenuItem
75551>>>>>
75551>>>>>    Procedure Construct_Object
75553>>>>>        Forward Send Construct_Object
75555>>>>>        Set psCaption to C_$CaptionTileHorizontally 
75556>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
75557>>>>>        Set psDescription to  C_$DescTileHorizontally
75558>>>>>        Set psImage to "ActionTileHorizontally.ico"
75559>>>>>        Set psCategory to C_$CategoryWindow
75560>>>>>    End_Procedure
75561>>>>>
75561>>>>>    Procedure OnExecute Variant vCommandBarControl
75563>>>>>        Handle hoCommandBars hoClientArea
75563>>>>>        Get CommandBarSystemObject to hoCommandBars
75564>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75565>>>>>        If hoClientArea Begin
75567>>>>>            Send Tile_Windows_Horizontal of hoClientArea
75568>>>>>        End
75568>>>>>>
75568>>>>>    End_Procedure
75569>>>>>End_Class
75570>>>>>
75570>>>>>Class cCJTileVertically is a cCJMenuItem
75571>>>>>
75571>>>>>    Procedure Construct_Object
75573>>>>>        Forward Send Construct_Object
75575>>>>>        Set psCaption to C_$CaptionTileVertically  
75576>>>>>        Set psToolTip to C_$ToolTipTileVertically
75577>>>>>        Set psDescription to  C_$DescTileVertically
75578>>>>>        Set psImage to "ActionTileVertically.ico"
75579>>>>>        Set psCategory to C_$CategoryWindow
75580>>>>>    End_Procedure
75581>>>>>
75581>>>>>    Procedure OnExecute Variant vCommandBarControl
75583>>>>>        Handle hoCommandBars hoClientArea
75583>>>>>        Get CommandBarSystemObject to hoCommandBars
75584>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75585>>>>>        If hoClientArea Begin
75587>>>>>            Send Tile_Windows_Vertical of hoClientArea
75588>>>>>        End
75588>>>>>>
75588>>>>>    End_Procedure
75589>>>>>End_Class
75590>>>>>
75590>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
75591>>>>>
75591>>>>>    Procedure Construct_Object
75593>>>>>        Forward Send Construct_Object
75595>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
75596>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
75597>>>>>        Set psDescription to  C_$DescMinimizeWindows
75598>>>>>        Set psCategory to C_$CategoryWindow
75599>>>>>    End_Procedure
75600>>>>>
75600>>>>>    Procedure OnExecute Variant vCommandBarControl
75602>>>>>        Handle hoCommandBars hoClientArea
75602>>>>>        Get CommandBarSystemObject to hoCommandBars
75603>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75604>>>>>        If hoClientArea Begin
75606>>>>>            // the clientarea's parent panel has message
75606>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
75607>>>>>        End
75607>>>>>>
75607>>>>>    End_Procedure
75608>>>>>End_Class
75609>>>>>
75609>>>>>
75609>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
75610>>>>>
75610>>>>>    Procedure Construct_Object
75612>>>>>        Forward Send Construct_Object
75614>>>>>        Set psCaption to C_$CaptionRestoreWindows
75615>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
75616>>>>>        Set psDescription to  C_$DescRestoreWindows
75617>>>>>        Set psCategory to C_$CategoryWindow
75618>>>>>    End_Procedure
75619>>>>>
75619>>>>>    Procedure OnExecute Variant vCommandBarControl
75621>>>>>        Handle hoCommandBars hoClientArea
75621>>>>>        Get CommandBarSystemObject to hoCommandBars
75622>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75623>>>>>        If hoClientArea Begin
75625>>>>>            // the clientarea's parent panel has message
75625>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
75626>>>>>        End
75626>>>>>>
75626>>>>>    End_Procedure
75627>>>>>End_Class
75628>>>>>
75628>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
75629>>>>>
75629>>>>>    Procedure Construct_Object
75631>>>>>        Forward Send Construct_Object
75633>>>>>        Set psCaption to C_$CaptionArrangeIcons  
75634>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
75635>>>>>        Set psDescription to  C_$DescArrangeIcons
75636>>>>>        Set psCategory to C_$CategoryWindow
75637>>>>>    End_Procedure
75638>>>>>
75638>>>>>    Procedure OnExecute Variant vCommandBarControl
75640>>>>>        Handle hoCommandBars hoClientArea
75640>>>>>        Get CommandBarSystemObject to hoCommandBars
75641>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75642>>>>>        If hoClientArea Begin
75644>>>>>            Send Arrange_Icons of hoClientArea
75645>>>>>        End
75645>>>>>>
75645>>>>>    End_Procedure
75646>>>>>
75646>>>>>End_Class
75647>>>>>    
75647>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJAboutMenuItem.pkg)
75647>>>>>Use cCJCommandBarSystem.pkg
75647>>>>>Use LanguageText.pkg
75647>>>>>
75647>>>>>// It is expected that if you use this class that you provide an about object that is
75647>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
75647>>>>>// because you may wish to create your own custom about package.
75647>>>>>
75647>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
75648>>>>>
75648>>>>>    Procedure Construct_Object
75650>>>>>        Forward Send Construct_Object
75652>>>>>        Set psCaption to C_$CaptionAbout
75653>>>>>        Set psDescription to C_$ToolTipAbout
75654>>>>>        Set psToolTip to C_$DescAbout
75655>>>>>        Set psImage to "ActionAbout.ico"
75656>>>>>        Set psCategory to C_$CategoryHelp
75657>>>>>    End_Procedure
75658>>>>>    
75658>>>>>    Procedure OnExecute Variant vCommandBarControl
75660>>>>>        Handle hoCommandBars hoClientArea
75660>>>>>        Get CommandBarSystemObject to hoCommandBars
75661>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75662>>>>>        If hoClientArea Begin
75664>>>>>            Send Activate_About of hoClientArea
75665>>>>>        End
75665>>>>>>
75665>>>>>    End_Procedure
75666>>>>>
75666>>>>>End_Class
75667>>>>>
75667>>>>>
75667>>>Use cCJDeoMenuItemClasses.pkg
75667>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJMDIWindowsMenuItem.pkg)
75667>>>>>Use cCJCommandBarSystem.pkg
75667>>>>>
75667>>>>>Register_Function Client_ID Returns Integer
75667>>>>>
75667>>>>>// only used by cCJMDIWIndowsMenuItem
75667>>>>>Class cCJMDIWindowItem is a cCJMenuItem
75668>>>>>
75668>>>>>    Procedure Construct_Object
75670>>>>>        Forward Send Construct_Object
75672>>>>>        Property Handle phWindow 0 // object id of view
75673>>>>>        Set pbControlFlagNoMovable to True
75674>>>>>        Set pbActiveUpdate to True
75675>>>>>    End_Procedure
75676>>>>>    
75676>>>>>    Procedure OnExecute Variant vCommandBarControl
75678>>>>>        Handle hWindow
75678>>>>>        Get phWindow to hWindow
75679>>>>>        Send Activate_View of hWindow
75680>>>>>    End_Procedure
75681>>>>>    
75681>>>>>End_Class                
75682>>>>>
75682>>>>>
75682>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
75683>>>>>    
75683>>>>>    Procedure Construct_Object
75685>>>>>        Forward Send Construct_Object
75687>>>>>        Property Handle[] phArrayOfWindows
75688>>>>>        Set peControlType to xtpControlPopup
75689>>>>>        Set psCategory to C_$CategoryWindow
75690>>>>>    End_Procedure
75691>>>>>    
75691>>>>>     // This adds MDI windows to the existing menu items.
75691>>>>>     // This removes any existing windows menus and always adds a new set to the end
75691>>>>>
75691>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
75693>>>>>        Handle  hClientArea hView
75693>>>>>        String  sLabel
75693>>>>>        Integer i iWindows
75693>>>>>        Handle[] hArrayOfWindows
75694>>>>>        Variant vItem
75694>>>>>        
75694>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
75694>>>>>        // also assume that destroying an action removes all menu instances of that action
75694>>>>>        Get phArrayOfWindows to hArrayOfWindows
75695>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
75696>>>>>        For i from 0 to (iWindows-1)
75702>>>>>>
75702>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
75703>>>>>        Loop
75704>>>>>>
75704>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
75705>>>>>
75705>>>>>        // Add all views to this menu. Create the action and add the item
75705>>>>>        Move 0 to i
75706>>>>>        Get Client_Id to hClientArea // object id of client area
75707>>>>>        If (hClientArea > 0) Begin
75709>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
75710>>>>>            While (hView <> 0)
75714>>>>>                If (Active_State(hView)) Begin
75716>>>>>                    // create the action
75716>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
75717>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
75718>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
75719>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
75720>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
75722>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
75723>>>>>                    End
75723>>>>>>
75723>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
75724>>>>>                    If (i=0) Begin
75726>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
75727>>>>>                    End
75727>>>>>>
75727>>>>>                    // Create a menu item for this action
75727>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
75728>>>>>                    Increment i
75729>>>>>                End
75729>>>>>>
75729>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
75730>>>>>            Loop
75731>>>>>>
75731>>>>>        End
75731>>>>>>
75731>>>>>
75731>>>>>        Set phArrayOfWindows to hArrayOfWindows
75732>>>>>
75732>>>>>     End_Procedure
75733>>>>>     
75733>>>>>End_Class
75734>>>>>
75734>
75734>Object oHtmlHelp is a cHtmlHelp
75736>End_Object
75737>
75737>Object oApplication is a cApplication
75739>    Set peHelpType to htHtmlHelp
75740>End_Object
75741>
75741>Object oToolTipController is a cToolTipController
75743>    Move Self to ghoToolTipController
75744>End_Object
75745>
75745>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oEditContextMenu.pkg)
75745>>>Use cCJStandardMenuItemClasses.pkg
75745>>>
75745>>>Object oEditContextMenu is a cCJContextMenu
75747>>>    
75747>>>    Move Self to Default_Form_Floating_Menu_ID
75748>>>    
75748>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75750>>>    End_Object
75751>>>    
75751>>>    Object oCutMenuItem is a cCJCutMenuItem
75753>>>        Set pbControlBeginGroup to True
75754>>>    End_Object
75755>>>    
75755>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75757>>>    End_Object
75758>>>
75758>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75760>>>    End_Object
75761>>>
75761>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75763>>>    End_Object
75764>>>
75764>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75766>>>        Set pbControlBeginGroup to True
75767>>>    End_Object
75768>>>
75768>>>End_Object
75769>>>
75769>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oDEOEditContextMenu17.pkg)
75769>>>Use Windows.pkg
75769>>>Use cCJStandardMenuItemClasses.pkg
75769>>>Use cCJDeoMenuItemClasses.pkg
75769>>>
75769>>>
75769>>>Object oDEOEditContextMenu17 is a cCJContextMenu
75771>>>    
75771>>>    Move Self to Default_dbFloating_Menu_ID
75772>>>    
75772>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75774>>>    End_Object
75775>>>    
75775>>>    Object oCutMenuItem is a cCJCutMenuItem
75777>>>        Set pbControlBeginGroup to True
75778>>>    End_Object
75779>>>    
75779>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75781>>>    End_Object
75782>>>
75782>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75784>>>    End_Object
75785>>>
75785>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75787>>>    End_Object
75788>>>
75788>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75790>>>        Set pbControlBeginGroup to True
75791>>>    End_Object
75792>>>
75792>>>    Object oPromptMenuItem is a cCJPromptMenuItem
75794>>>        Set pbControlBeginGroup to True
75795>>>    End_Object
75796>>>
75796>>>    Object oFindNextMenu is a cCJFindNextMenuItem
75798>>>        Set pbControlBeginGroup to True
75799>>>    End_Object
75800>>>
75800>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75802>>>    End_Object
75803>>>
75803>>>    Object oClearMenuItem is a cCJClearMenuItem
75805>>>        Set pbControlBeginGroup to True
75806>>>    End_Object
75807>>>
75807>>>    Object oClearAllMenu is a cCJClearAllMenuItem
75809>>>    End_Object
75810>>>
75810>>>    Object oSaveMenu is a cCJSaveMenuItem
75812>>>    End_Object
75813>>>    
75813>>>    Object oDeleteMenu is a cCJDeleteMenuItem
75815>>>    End_Object
75816>>>
75816>>>    Object oRememberitem is a cCJRememberFieldMenuItem
75818>>>        Set pbControlBeginGroup to True
75819>>>    End_Object
75820>>>
75820>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
75822>>>    End_Object
75823>>>
75823>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
75825>>>    End_Object
75826>>>
75826>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
75828>>>    End_Object
75829>>>
75829>>>End_Object
75830>
75830>Object oMain is a Panel
75832>    Set Label to "Fuvaroz s management"
75833>    Set Location to 4 3
75834>    Set Size to 300 450
75835>
75835>    Object oCommandBarSystem is a cCJCommandBarSystem
75837>        Set pbTimerUpdate to True
75838>
75838>        Procedure OnCreateCommandBars
75841>            Handle hoOptions
75841>            Get OptionsObject to hoOptions
75842>            Forward Send OnCreateCommandBars
75844>        End_Procedure
75845>
75845>        Object oMenuBar is a cCJMenuBar
75847>
75847>            Object oFileMenu is a cCJMenuItem
75849>                Set peControlType to xtpControlPopup          
75850>                Set psCaption   to "&File"
75851>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
75852>                Set psCategory to "Menus"
75853>
75853>                Object oClearMenuItem is a cCJClearMenuItem
75855>                    Set pbAddToDesignerMenu to True
75856>                End_Object
75857>
75857>                Object oClearAllMenu is a cCJClearAllMenuItem
75859>                    Set pbAddToDesignerMenu to True
75860>                End_Object
75861>
75861>                Object oPromptMenuItem is a cCJPromptMenuItem
75863>                    Set pbAddToDesignerMenu to True
75864>                    Set pbControlBeginGroup to True
75865>                End_Object
75866>
75866>                Object oFindMenuItem is a cCJFindMenuItem
75868>                    Set pbAddToDesignerMenu to True
75869>                    Set pbControlBeginGroup to True
75870>                End_Object
75871>
75871>                Object oFindNextMenu is a cCJFindNextMenuItem
75873>                    Set pbAddToDesignerMenu to True
75874>                End_Object
75875>
75875>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75877>                    Set pbAddToDesignerMenu to True
75878>                End_Object
75879>
75879>                Object oFindFirstMenu is a cCJFindFirstMenuItem
75881>                    Set pbAddToDesignerMenu to True
75882>                End_Object
75883>
75883>                Object oFindLastMenu is a cCJFindLastMenuItem
75885>                    Set pbAddToDesignerMenu to True
75886>                End_Object
75887>
75887>                Object oSaveMenuItem is a cCJSaveMenuItem
75889>                    Set pbAddToDesignerMenu to True
75890>                    Set pbControlBeginGroup to True
75891>                End_Object
75892>
75892>                Object oDeleteMenuItem is a cCJDeleteMenuItem
75894>                    Set pbAddToDesignerMenu to True
75895>                End_Object
75896>
75896>                Object oExitMenu is a cCJExitMenuItem
75898>                    Set pbControlBeginGroup to True
75899>                End_Object
75900>
75900>            End_Object
75901>
75901>            Object oViewMenu is a cCJMenuItem
75903>                Set peControlType to xtpControlPopup
75904>                Set psCaption to "&View"
75905>                Set psToolTip to "View"
75906>                Set psDescription to "Available Views"
75907>
75907>                Object oAutoEntryMenuItem is a cCJMenuItem
75909>                    Set psCaption to "G‚pkocsi"
75910>                    Set psTooltip to "G‚pkocsi"
75911>                
75911>                    Procedure OnExecute Variant vCommandBarControl
75914>                        Handle hoClient
75914>                        Get Client_Id to hoClient
75915>                        Send Activate_oAutoEntry of hoClient
75916>                    End_Procedure
75917>                End_Object
75918>
75918>                Object oSoforEntryMenuItem is a cCJMenuItem
75920>                    Set psCaption to "Sof‹r"
75921>                    Set psTooltip to "Sof‹r"
75922>                
75922>                    Procedure OnExecute Variant vCommandBarControl
75925>                        Handle hoClient
75925>                        Get Client_Id to hoClient
75926>                        Send Activate_oSoforEntry of hoClient
75927>                    End_Procedure
75928>                End_Object
75929>
75929>                Object oTermkMenuItem is a cCJMenuItem
75931>                    Set psCaption to "Term‚k"
75932>                    Set psTooltip to "Term‚k"
75933>                
75933>                    Procedure OnExecute Variant vCommandBarControl
75936>                        Handle hoClient
75936>                        Get Client_Id to hoClient
75937>                        Send Activate_oTermekEntry of hoClient
75938>                    End_Procedure
75939>                End_Object
75940>
75940>                Object oFuvarlevlMenuItem is a cCJMenuItem
75942>                    Set psCaption to "Fuvarlev‚l"
75943>                    Set psTooltip to "Fuvarlev‚l"
75944>                
75944>                    Procedure OnExecute Variant vCommandBarControl
75947>                        Handle hoClient
75947>                        Get Client_Id to hoClient
75948>                        Send Activate_oFuvarLevelEntry of hoClient
75949>                    End_Procedure
75950>                End_Object
75951>
75951>                Object oFuvarlevlttelMenuItem is a cCJMenuItem
75953>                    Set psCaption to "Fuvarlev‚l t‚tel"
75954>                    Set psTooltip to "Fuvarlev‚l t‚tel"
75955>                
75955>                    Procedure OnExecute Variant vCommandBarControl
75958>                        Handle hoClient
75958>                        Get Client_Id to hoClient
75959>                        Send Activate_oFuvarlevelTetelEntry of hoClient
75960>                    End_Procedure
75961>                End_Object
75962>            End_Object
75963>            
75963>            Object oReportMenu is a cCJMenuItem
75965>                Set peControlType to xtpControlPopup
75966>                Set psCaption to "&Report"
75967>                Set psToolTip to "Report"
75968>                Set psDescription to "Available Reports"
75969>
75969>                Object oSoforReport7MenuItem is a cCJMenuItem
75971>                    Set psCaption to "Sof‹r jelent‚s"
75972>                    Set psTooltip to "Sof‹r jelent‚s"
75973>                
75973>                    Procedure OnExecute Variant vCommandBarControl
75976>                        Handle hoClient
75976>                        Get Client_Id to hoClient
75977>                        Send Activate_oSoforReport7 of hoClient
75978>                    End_Procedure
75979>                End_Object
75980>            End_Object
75981>
75981>            Object oNavigateMenu is a cCJMenuItem
75983>                Set peControlType to xtpControlPopup      
75984>                Set psCaption to "&Navigate"    
75985>                Set psTooltip to "Navigate"    
75986>                Set psDescription to "Move to different areas of the application"
75987>
75987>                Object oNextAreaMenu is a cCJNextAreaMenu
75989>                End_Object
75990>
75990>                Object oPriorAreaMenu is a cCJPriorAreaMenu
75992>                End_Object
75993>
75993>                Object oNextViewMenu is a cCJNextViewMenu
75995>                End_Object
75996>
75996>                Object oPriorViewMenu is a cCJPriorViewMenu
75998>                End_Object
75999>
75999>                Object oPromptMenu is a cCJPromptMenuItem
76001>                    Set pbControlBeginGroup to True
76002>                End_Object
76003>
76003>                Object oZoomMenu is a cCJZoomMenuItem
76005>                End_Object
76006>
76006>            End_Object
76007>
76007>            Object oWindowMenu is a cCJMDIWindowsMenuItem
76009>                Set peControlType to xtpControlPopup
76010>                Set psCaption to "&Window"
76011>                Set psToolTip to "Window"
76012>                Set psDescription to "Display Current Views and set other display options."    
76013>
76013>                // These are the static windows items. More will be created in onInitPopup 
76013>                Object oDisplayOptionsMenu is a cCJMenuItem
76015>                    Set peControlType to xtpControlPopup          
76016>                    Set psCaption to "&Display Options"
76017>                    Set psToolTip to "Display Options"
76018>                    Set psDescription to "Set display options"
76019>
76019>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
76021>                    End_Object
76022>
76022>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
76024>                    End_Object
76025>
76025>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
76027>                        Set pbControlBeginGroup to True
76028>                    End_Object
76029>
76029>                End_Object
76030>
76030>                Object oCascadeMenu is a cCJCascadeMenuItem
76032>                    Set pbControlBeginGroup to True
76033>                End_Object
76034>
76034>                Object oHorizTile is a cCJTileHorizontally
76036>                End_Object
76037>
76037>                Object oVertTile is a cCJTileVertically
76039>                End_Object
76040>
76040>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
76042>                    Set pbControlBeginGroup to True
76043>                End_Object
76044>
76044>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
76046>                End_Object
76047>
76047>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
76049>                    Set pbControlBeginGroup to True
76050>                End_Object
76051>
76051>            End_Object
76052>
76052>            Object oHelpMenu is a cCJMenuItem
76054>                Set peControlType to xtpControlPopup    
76055>                Set psCaption to "&Help"
76056>                Set psDescription to "Access Information for learning and using this DataFlex application."
76057>                Set psToolTip to "Help"
76058>
76058>                Object oHelpMenuItem is a cCJHelpMenuItem 
76060>                End_Object
76061>
76061>                Object oAboutMenuItem is a cCJAboutMenuItem
76063>                End_Object
76064>
76064>            End_Object
76065>
76065>        End_Object
76066>
76066>        Object oFindToolBar is a cCJToolbar
76068>            Set psTitle to "Finding Toolbar"
76069>
76069>            Object oFindFirstTool is a cCJFindFirstMenuItem
76071>            End_Object
76072>
76072>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
76074>            End_Object
76075>
76075>            Object oFindMenuTool is a cCJFindMenuItem
76077>            End_Object
76078>
76078>            Object oFindNextTool is a cCJFindNextMenuItem
76080>            End_Object
76081>
76081>            Object oFindLastTool is a cCJFindLastMenuItem
76083>            End_Object
76084>
76084>            Object oPromptToolItem is a cCJPromptMenuItem
76086>                Set pbControlBeginGroup to True
76087>            End_Object
76088>
76088>        End_Object
76089>
76089>        Object oFileToolBar is a cCJToolbar
76091>            Set psTitle to "Data Entry Toolbar"
76092>
76092>            Object oClearToolItem is a cCJClearMenuItem
76094>                Set peControlStyle to xtpButtonIconAndCaption
76095>            End_Object
76096>
76096>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
76098>                Set peControlStyle to xtpButtonIconAndCaption
76099>            End_Object
76100>
76100>            Object oSaveToolItem is a cCJSaveMenuItem
76102>                Set peControlStyle to xtpButtonIconAndCaption
76103>                Set pbControlBeginGroup to True
76104>            End_Object
76105>
76105>            Object oDeleteToolItem is a cCJDeleteMenuItem
76107>                Set peControlStyle to xtpButtonIconAndCaption
76108>            End_Object
76109>
76109>        End_Object
76110>
76110>        Object oEditToolBar is a cCJToolbar
76112>            Set psTitle to "Edit Toolbar"
76113>
76113>            Object oCutToolbarItem is a cCJCutMenuItem
76115>            End_Object
76116>
76116>            Object oCopyToolbarItem is a cCJCopyMenuItem
76118>            End_Object
76119>
76119>            Object oPasteToolbarItem is a cCJPasteMenuItem
76121>            End_Object
76122>
76122>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
76124>                Set pbControlBeginGroup to True
76125>            End_Object
76126>
76126>        End_Object
76127>
76127>        Object oRememberToolbar is a cCJToolbar
76129>            Set psTitle to C_$Remember
76130>
76130>            Object oRememberItems is a cCJMenuItem
76132>
76132>                Set peControlType to xtpControlPopup
76133>                Set peControlStyle to xtpButtonCaption
76134>                Set psCaption to C_$Remember
76135>                
76135>                Object oMenuItem is a cCJRememberFieldMenuItem
76137>                    Set peControlStyle to xtpButtonIconAndCaption
76138>                End_Object
76139>                
76139>                Object oMenuItem is a cCJRememberLastFieldMenuItem
76141>                    Set peControlStyle to xtpButtonIconAndCaption
76142>                End_Object
76143>                
76143>                Object oMenuItem is a cCJUnRememberFieldMenuItem
76145>                    Set peControlStyle to xtpButtonIconAndCaption
76146>                End_Object
76147>                
76147>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
76149>                    Set peControlStyle to xtpButtonIconAndCaption
76150>                End_Object
76151>
76151>            End_Object
76152>            
76152>        End_Object
76153>        
76153>        Object oStatusBar is a cCJStatusBar
76155>
76155>            Object oStatusPane1 is a cCJStatusBarPane
76157>                Set piID to sbpIDIdlePane
76158>                Set pbStyleStretch to True
76159>            End_Object
76160>
76160>            Object oStatusPane2 is a cCJStatusBarPane
76162>                Set phoViewPane to Self
76163>                Set pbStyleStretch to True
76164>            End_Object
76165>
76165>        End_Object
76166>
76166>    End_Object
76167>
76167>    Object oClientArea is a ClientArea
76169>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\StdAbout.pkg)
76169>>>//************************************************************************
76169>>>// Confidential Trade Secret.
76169>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76169>>>// as an unpublished work.  All rights reserved.
76169>>>// DataFlex is a registered trademark of Data Access Corporation.
76169>>>//
76169>>>//************************************************************************
76169>>>//************************************************************************
76169>>>//
76169>>>// $File name  : StdAbout.pkg
76169>>>// $File title : Standard about object package for VDF
76169>>>// Notice      :
76169>>>// $Author(s)  : John Tuohy
76169>>>//
76169>>>// $Rev History
76169>>>//
76169>>>// JT 06/27/97   File created
76169>>>//************************************************************************
76169>>>
76169>>>// This provides a quick and simple way to create an about package for a program.
76169>>>// You need to create a message inside you client area called Activate_About.
76169>>>// Within this message you should send the message DoAbout passing needed
76169>>>// string information.
76169>>>//
76169>>>//       Procedure Activate_About
76169>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
76169>>>//       End_Procedure
76169>>>//    where: sTitle =     Name of application. If none provided, uses caption
76169>>>//                        bar title
76169>>>//           sVersion   = Version Line. If none provided, will be blank
76169>>>//           sCopyRight = Copyright Line. If none provided, will be blank
76169>>>//           sAuthor    = Author name, blank if none provided
76169>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
76169>>>//                        is used.
76169>>>// It is expected that you will place this in your own object package. For
76169>>>// example an order about package may look like this:
76169>>>//
76169>>>//   // OrderAbout.pkg
76169>>>//   Use StdAbout.pkg
76169>>>//   Procedure Activate_About
76169>>>//      String sTitle sCopyright sVersion sAuthor
76169>>>//      Move "My Order Entry System" to sTitle
76169>>>//      Move "Version 2.1" to sVersion
76169>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
76169>>>//      Move "John Smith"  to sAuthor
76169>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
76169>>>//   end_procedure
76169>>>//   // end of file.
76169>>>
76169>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\Dfabout.pkg)
76169>>>>>//************************************************************************
76169>>>>>// Confidential Trade Secret.
76169>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76169>>>>>// as an unpublished work.  All rights reserved.
76169>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
76169>>>>>//
76169>>>>>//************************************************************************
76169>>>>>//************************************************************************
76169>>>>>//
76169>>>>>// $File name  : DfAbout.pkg
76169>>>>>// $File title : About class support
76169>>>>>// Notice      :
76169>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
76169>>>>>//
76169>>>>>// $Rev History
76169>>>>>//
76169>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
76169>>>>>//                Windows for the size first. 
76169>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
76169>>>>>//                with anchor technique. Removed unnessary property in the
76169>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
76169>>>>>//                object To better look in Windows XP. Repositioned the close
76169>>>>>//                button in the sysinfo dialog To line up with the display area
76169>>>>>//                Replaced obsolete code and techniques. Removed dead code.
76169>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
76169>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
76169>>>>>//                the global Workspace object, if it is present
76169>>>>>// JJT 11/05/98   Added version information
76169>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
76169>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
76169>>>>>//                workspace package.
76169>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
76169>>>>>//                class can create this object.
76169>>>>>//                Cleaned up the interface (used correct classes and messages)
76169>>>>>//                Added workspace reporting support To sys-info.
76169>>>>>//                Turned off wrapping in the sys-info editor.
76169>>>>>// KR  ??/??/96   File created
76169>>>>>//************************************************************************
76169>>>>>Use LanguageText.pkg
76169>>>>>Use Windows.pkg
76169>>>>>Use DFbitmap.pkg
76169>>>>>Use GlobalFunctionsProcedures.pkg
76169>>>>>Use cTextEdit.pkg
76169>>>>>
76169>>>>>Use cli.pkg
Including file: cli.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cli.pkg)
76169>>>>>>>//*****************************************************************************
76169>>>>>>>//*** CLI.PKG                                                               ***
76169>>>>>>>//***                                                                       ***
76169>>>>>>>//*** Author: Ben Weijers                                                   ***
76169>>>>>>>//***         Data Access Nederland                                         ***
76169>>>>>>>//***         10 September 1998                                             ***
76169>>>>>>>//***                                                                       ***
76169>>>>>>>//*** Purpose:                                                              ***
76169>>>>>>>//***   CLI specific functionality. There are several connectivity kits     ***
76169>>>>>>>//***   based on  SQL/92 CLI. Those are:                                    ***
76169>>>>>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
76169>>>>>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
76169>>>>>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
76169>>>>>>>//***                                                                       ***
76169>>>>>>>//***   This package defines the common functionality for all CLI based     ***
76169>>>>>>>//***   drivers.                                                            ***
76169>>>>>>>//***                                                                       ***
76169>>>>>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
76169>>>>>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
76169>>>>>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
76169>>>>>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
76169>>>>>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
76169>>>>>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
76169>>>>>>>//***             Added SQLSERVER2012CLIENT return value for                ***
76169>>>>>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
76169>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
76169>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
76169>>>>>>>//***             mssqldrv.pkg                                              ***
76169>>>>>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
76169>>>>>>>//***             Added type mappings attributes                            ***
76169>>>>>>>//***   Updated:  october 11, 2013 (Current CK build: 6.0.0.18)             ***
76169>>>>>>>//***             Added DF_FILE_SQL_FILTER_EQ attribute                     ***
76169>>>>>>>//*****************************************************************************
76169>>>>>>>
76169>>>>>>>//*** We are not using ifndef below because that is not supported in Character Mode
76169>>>>>>>//*** Driver attributes
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>//------------------------------------------------------------
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>//-------------------------------------
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>//*** Replacement for logical column number that indicates all columns
76169>>>>>>>
76169>>>>>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
76169>>>>>>>
76169>>>>>>>//*** Possible DF_FIELD_READ_ONLY values
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
76169>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
76169>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>// Moved to Mssqldrv.pkg
76169>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
76169>>>>>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
76169>>>>>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
76169>>>>>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
76169>>>>>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
76169>>>>>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
76169>>>>>>>
76169>>>>>>>//*** Possible SQL Column type values
76169>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
76169>>>>>>>Define SQL_CHAR           For    1
76169>>>>>>>Define SQL_NUMERIC        For    2
76169>>>>>>>Define SQL_DECIMAL        For    3
76169>>>>>>>Define SQL_INTEGER        For    4
76169>>>>>>>Define SQL_SMALLINT       For    5
76169>>>>>>>Define SQL_FLOAT          For    6
76169>>>>>>>Define SQL_REAL           For    7
76169>>>>>>>Define SQL_DOUBLE         For    8
76169>>>>>>>Define SQL_DATETIME       For    9
76169>>>>>>>Define SQL_VARCHAR        For   12
76169>>>>>>>Define SQL_TYPE_DATE      For   91
76169>>>>>>>Define SQL_TYPE_TIME      For   92
76169>>>>>>>Define SQL_TYPE_TIMESTAMP for   93
76169>>>>>>>// Moved to mssqldrv.pkg
76169>>>>>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>Define SQL_DATE           For    9
76169>>>>>>>Define SQL_INTERVAL       For   10
76169>>>>>>>Define SQL_TIME           For   10
76169>>>>>>>Define SQL_TIMESTAMP      For   11
76169>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
76169>>>>>>>Define SQL_BINARY         For  (-2)
76169>>>>>>>Define SQL_VARBINARY      For  (-3)
76169>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
76169>>>>>>>Define SQL_BIGINT         For  (-5)
76169>>>>>>>Define SQL_TINYINT        For  (-6)
76169>>>>>>>Define SQL_BIT            For  (-7)
76169>>>>>>>Define SQL_WCHAR          For  (-8)
76169>>>>>>>Define SQL_WVARCHAR       For  (-9)
76169>>>>>>>Define SQL_WLONGVARCHAR   For (-10)
76169>>>>>>>Define SQL_GUID           For (-11)
76169>>>>>>>
76169>>>>>>>//*** Driver level attributes
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>//*** Error number constants
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>//*** Call driver function identifiers
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>//*** Init data source types
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>//*** Dummy strings used in the commands
76169>>>>>>>    String  CLI$StrDummy 255
76169>>>>>>>    Integer CLI$IntDummy
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>//*****************************************************************************
76169>>>>>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
76169>>>>>>>//***                                                                       ***
76169>>>>>>>//***   Setup a constraint for a file.                                      ***
76169>>>>>>>//*****************************************************************************
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>//*****************************************************************************
76169>>>>>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
76169>>>>>>>//***                                                                       ***
76169>>>>>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
76169>>>>>>>//*** will be set for the remainder of the session or until set again. To   ***
76169>>>>>>>//*** permanently set driver level attributes change the driver             ***
76169>>>>>>>//*** configuration file.                                                   ***
76169>>>>>>>//*****************************************************************************
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>
76169>>>>>>>//*****************************************************************************
76169>>>>>>>//*** Class  : cCLIHandler                                                  ***
76169>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76169>>>>>>>//***          call several CLI releated methods.                           ***
76169>>>>>>>//*****************************************************************************
76169>>>>>>>
76169>>>>>>>Class cCLIHandler Is An Array
76170>>>>>>>
76170>>>>>>>    Procedure Construct_Object Integer iImage
76172>>>>>>>        Forward Send Construct_object iImage
76174>>>>>>>
76174>>>>>>>        Property String  psDriverID       Public ""
76175>>>>>>>    End_Procedure // Construct_Object
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>    //***
76176>>>>>>>    //*** Fucntion: CKRevsion
76176>>>>>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
76176>>>>>>>    //***
76176>>>>>>>
76176>>>>>>>    Function CKRevision Returns String
76178>>>>>>>        Local String  sDriverID
76178>>>>>>>        Local String  sRevision
76178>>>>>>>        Local String  sVoid
76178>>>>>>>        Local Integer iRetval
76178>>>>>>>
76178>>>>>>>        Get psDriverID To sDriverID
76179>>>>>>>        If (sDRiverID <> "") Begin
76181>>>>>>>            Move (Repeat(" ", 255)) To sRevision
76182>>>>>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76187>>>>>>>        End
76187>>>>>>>>
76187>>>>>>>
76187>>>>>>>        Function_Return sRevision
76188>>>>>>>    End_Function // CKRevision
76189>>>>>>>
76189>>>>>>>
76189>>>>>>>
76189>>>>>>>    //***
76189>>>>>>>    //*** Function: ExtractPartFromRevision
76189>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76189>>>>>>>    //***
76189>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76189>>>>>>>    //***
76189>>>>>>>
76189>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76191>>>>>>>        Local Integer iPartRev
76191>>>>>>>        Local Integer iCurrentPart
76191>>>>>>>        Local Integer iSeparatorPos
76191>>>>>>>
76191>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76194>>>>>>>
76194>>>>>>>        Move 0 To iCurrentPart
76195>>>>>>>        Repeat
76195>>>>>>>>
76195>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76196>>>>>>>            If (iSeparatorPos > 0) Begin
76198>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76199>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76200>>>>>>>                Increment iCurrentPart
76201>>>>>>>            End
76201>>>>>>>>
76201>>>>>>>            Else If (sRevision <> "") Begin
76204>>>>>>>                Move sRevision To iPartRev
76205>>>>>>>                Move "" To sRevision
76206>>>>>>>                Increment iCurrentPart
76207>>>>>>>            End
76207>>>>>>>>
76207>>>>>>>            Else ;                Move -1 To iPartRev
76209>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76211>>>>>>>
76211>>>>>>>        Function_Return iPartRev
76212>>>>>>>    End_Function // EcxtractPartFromRevision
76213>>>>>>>
76213>>>>>>>
76213>>>>>>>
76213>>>>>>>    //***
76213>>>>>>>    //*** Function: CKMajorRevision
76213>>>>>>>    //*** Purpose : Returns the major revision of the CK
76213>>>>>>>    //***
76213>>>>>>>
76213>>>>>>>    Function CKMajorRevision Returns Integer
76215>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76216>>>>>>>    End_Function // CKMajorRevision
76217>>>>>>>
76217>>>>>>>
76217>>>>>>>
76217>>>>>>>    //***
76217>>>>>>>    //*** Function: CKMinorRevision
76217>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76217>>>>>>>    //***
76217>>>>>>>
76217>>>>>>>    Function CKMinorRevision Returns Integer
76219>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76220>>>>>>>    End_Function // CKMinorRevision
76221>>>>>>>
76221>>>>>>>
76221>>>>>>>
76221>>>>>>>    //***
76221>>>>>>>    //*** Function: CKReleaseRevision
76221>>>>>>>    //*** Purpose : Returns the release revision of the CK
76221>>>>>>>    //***
76221>>>>>>>
76221>>>>>>>    Function CKReleaseRevision Returns Integer
76223>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76224>>>>>>>    End_Function // CKReleaseRevision
76225>>>>>>>
76225>>>>>>>
76225>>>>>>>
76225>>>>>>>    //***
76225>>>>>>>    //*** Function: CKBuildRevision
76225>>>>>>>    //*** Purpose : Returns the major revision of the CK
76225>>>>>>>    //***
76225>>>>>>>
76225>>>>>>>    Function CKBuildRevision Returns Integer
76227>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76228>>>>>>>    End_Function // CKBuildRevision
76229>>>>>>>
76229>>>>>>>
76229>>>>>>>
76229>>>>>>>    //***
76229>>>>>>>    //*** Function: IsMinimalRevision
76229>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76229>>>>>>>    //***
76229>>>>>>>
76229>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76231>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76234>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76237>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76240>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76243>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76246>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76250>>>>>>>            End
76250>>>>>>>>
76250>>>>>>>        End
76250>>>>>>>>
76250>>>>>>>
76250>>>>>>>        Function_Return (FALSE)
76251>>>>>>>    End_Function // IsMinimalRevision
76252>>>>>>>
76252>>>>>>>
76252>>>>>>>
76252>>>>>>>    //***
76252>>>>>>>    //*** Function: RegistrationName
76252>>>>>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
76252>>>>>>>    //***
76252>>>>>>>
76252>>>>>>>    Function RegistrationName Returns String
76254>>>>>>>        Local String  sRegistration
76254>>>>>>>        Local String  sDRiverId
76254>>>>>>>        Local String  sVoid
76254>>>>>>>        Local Integer iRetval
76254>>>>>>>
76254>>>>>>>        Get psDriverID To sDriverID
76255>>>>>>>        If (sDRiverID <> "") Begin
76257>>>>>>>            Move (Repeat(" ", 255)) To sRegistration
76258>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
76263>>>>>>>        End
76263>>>>>>>>
76263>>>>>>>
76263>>>>>>>        Function_Return sRegistration
76264>>>>>>>    End_Function // RegistrationName
76265>>>>>>>
76265>>>>>>>
76265>>>>>>>
76265>>>>>>>    //***
76265>>>>>>>    //*** Function: SerialNumber
76265>>>>>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
76265>>>>>>>    //***
76265>>>>>>>
76265>>>>>>>    Function SerialNumber Returns Integer
76267>>>>>>>        Local String  sDRiverId
76267>>>>>>>        Local String  sVoid
76267>>>>>>>        Local Integer iRetval
76267>>>>>>>
76267>>>>>>>        Get psDriverID To sDriverID
76268>>>>>>>        If (sDRiverID <> "") Begin
76270>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
76275>>>>>>>        End
76275>>>>>>>>
76275>>>>>>>
76275>>>>>>>        Function_Return iRetval
76276>>>>>>>    End_Function // SerialNumber
76277>>>>>>>
76277>>>>>>>
76277>>>>>>>
76277>>>>>>>    //***
76277>>>>>>>    //*** Function: MaxUsers
76277>>>>>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
76277>>>>>>>    //***
76277>>>>>>>
76277>>>>>>>    Function MaxUsers Returns Integer
76279>>>>>>>        Local String  sDRiverId
76279>>>>>>>        Local String  sVoid
76279>>>>>>>        Local Integer iRetval
76279>>>>>>>
76279>>>>>>>        Get psDriverID To sDriverID
76280>>>>>>>        If (sDRiverID <> "") Begin
76282>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
76287>>>>>>>        End
76287>>>>>>>>
76287>>>>>>>
76287>>>>>>>        Function_Return iRetval
76288>>>>>>>    End_Function // MaxUsers
76289>>>>>>>
76289>>>>>>>
76289>>>>>>>
76289>>>>>>>    //***
76289>>>>>>>    //*** Procedure: DumpStatus
76289>>>>>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
76289>>>>>>>    //***
76289>>>>>>>
76289>>>>>>>    Procedure DumpStatus String sFileName
76291>>>>>>>        Local String  sVoid
76291>>>>>>>        Local String  sDriverID
76291>>>>>>>        Local Integer iVoid
76291>>>>>>>
76291>>>>>>>        Get psDriverID To sDriverID
76292>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
76299>>>>>>>    End_Procedure // DumpStatus
76300>>>>>>>
76300>>>>>>>
76300>>>>>>>
76300>>>>>>>    //***
76300>>>>>>>    //*** Procedure: ReadConfiguration
76300>>>>>>>    //*** Purpose  : Reset all driver level configurable attributes to the
76300>>>>>>>    //***            default value and then reread the configuration.
76300>>>>>>>    //***
76300>>>>>>>
76300>>>>>>>    Procedure ReadConfiguration
76302>>>>>>>        Local String  sVoid
76302>>>>>>>        Local String  sDriverID
76302>>>>>>>        Local Integer iVoid
76302>>>>>>>
76302>>>>>>>        Get psDriverID To sDriverID
76303>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
76310>>>>>>>    End_Procedure // ReadConfiguration
76311>>>>>>>
76311>>>>>>>
76311>>>>>>>
76311>>>>>>>    //***
76311>>>>>>>    //*** Function: TextToRIMValue
76311>>>>>>>    //*** Purpose : Convert a text to the corresponding
76311>>>>>>>    //***           Generate_Record_ID_Method attribute value
76311>>>>>>>    //***
76311>>>>>>>
76311>>>>>>>    Function TextToRIMValue String sText Returns Integer
76313>>>>>>>        If (sText = "None") ;            Function_return RIM_NONE
76316>>>>>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
76320>>>>>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
76324>>>>>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
76328>>>>>>>    End_Function // TextToRIMValue
76329>>>>>>>
76329>>>>>>>
76329>>>>>>>
76329>>>>>>>    //***
76329>>>>>>>    //*** Function: RIMValueTotext
76329>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76329>>>>>>>    //***           corresponding text.
76329>>>>>>>    //***
76329>>>>>>>
76329>>>>>>>    Function RIMValueToText Integer iAttrValue Returns String
76331>>>>>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
76334>>>>>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
76338>>>>>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
76342>>>>>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
76346>>>>>>>    End_Function // RIMValueToText
76347>>>>>>>
76347>>>>>>>
76347>>>>>>>
76347>>>>>>>    //***
76347>>>>>>>    //*** Function: TextToROValue
76347>>>>>>>    //*** Purpose : Convert a text to the corresponding
76347>>>>>>>    //***           Generate_Record_ID_Method attribute value
76347>>>>>>>    //***
76347>>>>>>>
76347>>>>>>>    Function TextToROValue String sText Returns Integer
76349>>>>>>>        If (sText = "No") ;            Function_return RO_NO
76352>>>>>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
76356>>>>>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
76360>>>>>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
76364>>>>>>>    End_Function // TextToRIMValue
76365>>>>>>>
76365>>>>>>>
76365>>>>>>>
76365>>>>>>>    //***
76365>>>>>>>    //*** Function: ROValueTotext
76365>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76365>>>>>>>    //***           corresponding text.
76365>>>>>>>    //***
76365>>>>>>>
76365>>>>>>>    Function ROValueToText Integer iAttrValue Returns String
76367>>>>>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
76370>>>>>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
76374>>>>>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
76378>>>>>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
76382>>>>>>>    End_Function // RIMValueToText
76383>>>>>>>
76383>>>>>>>
76383>>>>>>>
76383>>>>>>>    //***
76383>>>>>>>    //*** Function: LastDriverError
76383>>>>>>>    //*** Purpose : Return the text f the last error geneated by the driver.
76383>>>>>>>    //***
76383>>>>>>>
76383>>>>>>>    Function LastDriverError Returns String
76385>>>>>>>        Local String  sDriverID
76385>>>>>>>        Local String  sLastError
76385>>>>>>>        Local String  sLastErrorLength
76385>>>>>>>        Local Integer iLastErrorLength
76385>>>>>>>        Local Integer iVoid
76385>>>>>>>
76385>>>>>>>        //*** Initialize
76385>>>>>>>        Move "" To sLastError
76386>>>>>>>
76386>>>>>>>        Get psDriverID To sDriverID
76387>>>>>>>        If (sDriverID <> "") Begin
76389>>>>>>>            //*** Get the text of the last error
76389>>>>>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
76390>>>>>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
76395>>>>>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
76396>>>>>>>
76396>>>>>>>            If (iLastErrorLength > 0) Begin
76398>>>>>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
76399>>>>>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
76404>>>>>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
76405>>>>>>>            End
76405>>>>>>>>
76405>>>>>>>        End
76405>>>>>>>>
76405>>>>>>>
76405>>>>>>>        Function_Return sLastError
76406>>>>>>>    End_Function // LastDriverError
76407>>>>>>>
76407>>>>>>>
76407>>>>>>>
76407>>>>>>>    //***
76407>>>>>>>    //*** Function: EnumerateTables
76407>>>>>>>    //*** Purpose : Enumerate the tables in a database
76407>>>>>>>    //***
76407>>>>>>>
76407>>>>>>>    Function EnumerateTables String sLogin Returns Integer
76409>>>>>>>        Local String  sDriver
76409>>>>>>>        Local String  sVoid
76409>>>>>>>        Local Integer iNumTables
76409>>>>>>>        Local Integer iVoid
76409>>>>>>>
76409>>>>>>>        Get psDriverID To sDriver
76410>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
76417>>>>>>>
76417>>>>>>>        Function_Return iNumTables
76418>>>>>>>    End_Function // EnumerateTables
76419>>>>>>>
76419>>>>>>>
76419>>>>>>>
76419>>>>>>>    //***
76419>>>>>>>    //*** Function: TableName
76419>>>>>>>    //*** Purpose : Returns the name of the table enumerated at the given position
76419>>>>>>>    //***
76419>>>>>>>
76419>>>>>>>    Function TableName Integer iIndex Returns String
76421>>>>>>>        Local String  sDriver
76421>>>>>>>        Local String  sTableName
76421>>>>>>>        Local String  sVoid
76421>>>>>>>        Local Integer iVoid
76421>>>>>>>
76421>>>>>>>        Get psDriverID To sDriver
76422>>>>>>>        If (sDriver <> "") Begin
76424>>>>>>>            Move (Repeat(" ", 255)) To sTableName
76425>>>>>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
76430>>>>>>>        End
76430>>>>>>>>
76430>>>>>>>
76430>>>>>>>        Function_Return sTableName
76431>>>>>>>    End_Function // TableName
76432>>>>>>>
76432>>>>>>>
76432>>>>>>>
76432>>>>>>>    //***
76432>>>>>>>    //*** Function: SchemaName
76432>>>>>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
76432>>>>>>>    //***
76432>>>>>>>
76432>>>>>>>    Function SchemaName Integer iIndex Returns String
76434>>>>>>>        Local String  sDriver
76434>>>>>>>        Local String  sSchemaName
76434>>>>>>>        Local String  sVoid
76434>>>>>>>        Local Integer iVoid
76434>>>>>>>
76434>>>>>>>        Get psDriverID To sDriver
76435>>>>>>>        If (sDriver <> "") Begin
76437>>>>>>>            Move (Repeat(" ", 255)) To sSchemaName
76438>>>>>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
76443>>>>>>>        End
76443>>>>>>>>
76443>>>>>>>
76443>>>>>>>        Function_Return sSchemaName
76444>>>>>>>    End_Function // SchemaName
76445>>>>>>>
76445>>>>>>>
76445>>>>>>>
76445>>>>>>>    //***
76445>>>>>>>    //*** Function: TableType
76445>>>>>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
76445>>>>>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
76445>>>>>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
76445>>>>>>>    //***
76445>>>>>>>
76445>>>>>>>    Function TableType Integer iIndex Returns String
76447>>>>>>>        Local String  sDriver
76447>>>>>>>        Local String  sTableType
76447>>>>>>>        Local String  sVoid
76447>>>>>>>        Local Integer iVoid
76447>>>>>>>
76447>>>>>>>        Get psDriverID To sDriver
76448>>>>>>>        If (sDriver <> "") Begin
76450>>>>>>>            Move (Repeat(" ", 25)) To sTableType
76451>>>>>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
76456>>>>>>>        End
76456>>>>>>>>
76456>>>>>>>
76456>>>>>>>        Function_Return sTableType
76457>>>>>>>    End_Function // TableType
76458>>>>>>>
76458>>>>>>>
76458>>>>>>>
76458>>>>>>>    //***
76458>>>>>>>    //*** Function: TableComment
76458>>>>>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
76458>>>>>>>    //***
76458>>>>>>>
76458>>>>>>>    Function TableComment Integer iIndex Returns String
76460>>>>>>>        Local String  sDriver
76460>>>>>>>        Local String  sTableComment
76460>>>>>>>        Local String  sVoid
76460>>>>>>>        Local Integer iVoid
76460>>>>>>>
76460>>>>>>>        Get psDriverID To sDriver
76461>>>>>>>        If (sDriver <> "") Begin
76463>>>>>>>            Move (Repeat(" ", 255)) To sTableComment
76464>>>>>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
76469>>>>>>>        End
76469>>>>>>>>
76469>>>>>>>
76469>>>>>>>        Function_Return sTableComment
76470>>>>>>>    End_Function // TableComment
76471>>>>>>>
76471>>>>>>>
76471>>>>>>>
76471>>>>>>>    //***
76471>>>>>>>    //*** Function: EnumerateColumns
76471>>>>>>>    //*** Purpose : Enumerate the columns in a table
76471>>>>>>>    //***
76471>>>>>>>
76471>>>>>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
76473>>>>>>>        Local String  sDriver
76473>>>>>>>        Local Integer iNumColumns
76473>>>>>>>        Local Integer iVoid
76473>>>>>>>
76473>>>>>>>        Get psDriverID To sDriver
76474>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
76481>>>>>>>
76481>>>>>>>        Function_Return iNumColumns
76482>>>>>>>    End_Function // EnumerateColumns
76483>>>>>>>
76483>>>>>>>
76483>>>>>>>
76483>>>>>>>    //***
76483>>>>>>>    //*** Function: ColumnName
76483>>>>>>>    //*** Purpose : Returns the name of the column enumerated at the given position
76483>>>>>>>    //***
76483>>>>>>>
76483>>>>>>>    Function ColumnName Integer iIndex Returns String
76485>>>>>>>        Local String  sDriver
76485>>>>>>>        Local String  sColumnName
76485>>>>>>>        Local String  sVoid
76485>>>>>>>        Local Integer iVoid
76485>>>>>>>
76485>>>>>>>        Get psDriverID To sDriver
76486>>>>>>>        If (sDriver <> "") Begin
76488>>>>>>>            Move (Repeat(" ", 255)) To sColumnName
76489>>>>>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
76494>>>>>>>        End
76494>>>>>>>>
76494>>>>>>>
76494>>>>>>>        Function_Return sColumnName
76495>>>>>>>    End_Function // ColumnName
76496>>>>>>>
76496>>>>>>>
76496>>>>>>>
76496>>>>>>>    //***
76496>>>>>>>    //*** Function: CLIDFDateToSQLDate
76496>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
76496>>>>>>>    //***
76496>>>>>>>
76496>>>>>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
76498>>>>>>>        Local String sSQLDate
76498>>>>>>>        Local Integer iOrgDateFmt
76498>>>>>>>        Local Integer iOrgDateSep
76498>>>>>>>
76498>>>>>>>        //*** Change date format to military, SQL dates are military dates
76498>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76501>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76504>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76507>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76510>>>>>>>
76510>>>>>>>        //*** We only need to convert if the date is 0
76510>>>>>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
76519>>>>>>>        Else ;            Move dDFDate To sSQLDate
76521>>>>>>>
76521>>>>>>>        //*** Change date format back to original
76521>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76524>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76527>>>>>>>
76527>>>>>>>        Function_Return sSQLDate
76528>>>>>>>    End_Function // CLIDFDateToSQLDate
76529>>>>>>>
76529>>>>>>>
76529>>>>>>>
76529>>>>>>>    //***
76529>>>>>>>    //*** Function: CLISQLDateToDFDate
76529>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
76529>>>>>>>    //***
76529>>>>>>>
76529>>>>>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
76531>>>>>>>        Local Date dDFDate
76531>>>>>>>        Local String sDummyDateValue
76531>>>>>>>        Local Integer iOrgDateFmt
76531>>>>>>>        Local Integer iOrgDateSep
76531>>>>>>>
76531>>>>>>>        //*** Change date format to military, SQL dates are military dates
76531>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76534>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76537>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76540>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76543>>>>>>>
76543>>>>>>>        //*** We only need to convert if the date is the dummy zero date value
76543>>>>>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
76550>>>>>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
76553>>>>>>>        Else ;            Move sSQLDate To dDFDate
76555>>>>>>>
76555>>>>>>>        //*** Change date format back to original
76555>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76558>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76561>>>>>>>
76561>>>>>>>        Function_Return dDFDate
76562>>>>>>>    End_Function // CLISQLDateToDFDate
76563>>>>>>>
76563>>>>>>>
76563>>>>>>>
76563>>>>>>>    //***
76563>>>>>>>    //*** Function: RedirectConnection
76563>>>>>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
76563>>>>>>>    //***           will point to another database but all tables will stay
76563>>>>>>>    //***           open!
76563>>>>>>>    //***
76563>>>>>>>
76563>>>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
76565>>>>>>>        Local String  sDriver
76565>>>>>>>        Local String  sVoid
76565>>>>>>>        Local Integer iResult
76565>>>>>>>        Local Integer iVoid
76565>>>>>>>
76565>>>>>>>        Get psDriverID To sDriver
76566>>>>>>>        If (sDriver <> "") Begin
76568>>>>>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
76573>>>>>>>        End
76573>>>>>>>>
76573>>>>>>>        Function_Return iResult
76574>>>>>>>    End_Function // RedirectConnect
76575>>>>>>>
76575>>>>>>>
76575>>>>>>>
76575>>>>>>>    //***
76575>>>>>>>    //*** Function: CreateConnectionID
76575>>>>>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
76575>>>>>>>    //***
76575>>>>>>>
76575>>>>>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
76577>>>>>>>        Local String  sDriver
76577>>>>>>>        Local Integer iResult
76577>>>>>>>        Local Integer iOptions
76577>>>>>>>
76577>>>>>>>        Get psDriverID to sDriver
76578>>>>>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
76581>>>>>>>        Else ;            Move iOpt to iOptions
76583>>>>>>>        If (sDriver <> "") Begin
76585>>>>>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
76590>>>>>>>        End
76590>>>>>>>>
76590>>>>>>>        Function_Return iResult
76591>>>>>>>    End_Function // CreateConnectionID
76592>>>>>>>
76592>>>>>>>
76592>>>>>>>
76592>>>>>>>    //***
76592>>>>>>>    //*** Function: DeleteConnectionID
76592>>>>>>>    //*** Purpose : Delete a DataFlex side connection id.
76592>>>>>>>    //***
76592>>>>>>>
76592>>>>>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
76594>>>>>>>        Local String  sDriver
76594>>>>>>>        Local Integer iResult
76594>>>>>>>        Local String sVoid
76594>>>>>>>
76594>>>>>>>        Get psDriverID To sDriver
76595>>>>>>>        If (sDriver <> "") Begin
76597>>>>>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
76602>>>>>>>        End
76602>>>>>>>>
76602>>>>>>>        Function_Return iResult
76603>>>>>>>    End_Function // DeleteConnectionID
76604>>>>>>>
76604>>>>>>>End_Class // cCLIHandler
76605>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 18.2\Pkg\DFBTRDRV.PKG)
76605>>>>>>>//****************************************************************************
76605>>>>>>>//
76605>>>>>>>// $File name  : DFBTRDRV.PKG
76605>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
76605>>>>>>>// Notice      : This package contains constants and commands, used to call
76605>>>>>>>//               specific functions in the DFBTRDRV.
76605>>>>>>>// $Author(s)  : Eddy Kleinjan
76605>>>>>>>//
76605>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
76605>>>>>>>// Created     : 01-07-97 @ 12:00:00
76605>>>>>>>//
76605>>>>>>>// Changed     : 04-04-2001.
76605>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
76605>>>>>>>//
76605>>>>>>>// Changed     : June 6, 2001
76605>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
76605>>>>>>>//
76605>>>>>>>//               Added DFBTR_DDF_OWNER command.
76605>>>>>>>//
76605>>>>>>>// Changed     : June 12, 2001
76605>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
76605>>>>>>>//
76605>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
76605>>>>>>>//
76605>>>>>>>// Changed     : August 4, 2004
76605>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
76605>>>>>>>//
76605>>>>>>>//               Added cDfbtrdrvHandler class.
76605>>>>>>>//               New functions in this class:
76605>>>>>>>//                  Function CKRevision Returns String
76605>>>>>>>//                  Function CkUsesUri Returns Integer
76605>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76605>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76605>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76605>>>>>>>//
76605>>>>>>>// Changed     : September 30, 2005
76605>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
76605>>>>>>>//
76605>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
76605>>>>>>>//****************************************************************************
76605>>>>>>>Use Ui
76605>>>>>>>//
76605>>>>>>>// Driver Indentification
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>//*** Driver attributes
76605>>>>>>>//
76605>>>>>>>// Call_Driver functions ID's
76605>>>>>>>//
76605>>>>>>>//
76605>>>>>>>// DFBTRFN_CONVERT_FILE options
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// DFBTRFN_SET_OWNER options
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to create all vars which may be needed
76605>>>>>>>// in other commands.
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to set the owner of a Btrieve file.
76605>>>>>>>// File must have been opened.
76605>>>>>>>// Filenumber needs to be passed.
76605>>>>>>>// To clear set the owner to "".
76605>>>>>>>// Examples:
76605>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
76605>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
76605>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
76605>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
76605>>>>>>>// To clear:
76605>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to parse DFBTR_SET_OWNVER
76605>>>>>>>// options.
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to parse for Callback
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to clear the owner of a Btrieve file.
76605>>>>>>>// File must have been opened.
76605>>>>>>>// Filenumber needs to be passed.
76605>>>>>>>// Examples:
76605>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to add a owner name to the internal list of ownernames
76605>>>>>>>// which will be tries when opening files.
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to remove all owners from the internal list of ownernames
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to set the owner name to be used when opening the DDF files.
76605>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
76605>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
76605>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to change the transaction type.
76605>>>>>>>// Valid types are:
76605>>>>>>>//     DFBTRTT_NONE
76605>>>>>>>//     DFBTRTT_EXCLUSIVE
76605>>>>>>>//     DFBTRTT_CONCURRENT
76605>>>>>>>//
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to get the current transaction type.
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to set explicit_locking
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to get explicit locking
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>//
76605>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
76605>>>>>>>//
76605>>>>>>>
76605>>>>>>>//*****************************************************************************
76605>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
76605>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76605>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
76605>>>>>>>//*****************************************************************************
76605>>>>>>>
76605>>>>>>>Class cDFBtrDrvHandler Is An Array
76606>>>>>>>
76606>>>>>>>    Procedure Construct_Object Integer iImage
76608>>>>>>>        Forward Send Construct_object iImage
76610>>>>>>>
76610>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
76611>>>>>>>    End_Procedure // Construct_Object
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>    //***
76612>>>>>>>    //*** Function: CKRevsion
76612>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
76612>>>>>>>    //***
76612>>>>>>>
76612>>>>>>>    Function CKRevision Returns String
76614>>>>>>>        Local String  sDriverID
76614>>>>>>>        Local String  sRevision
76614>>>>>>>        Local String  sVoid
76614>>>>>>>        Local Integer iRetval
76614>>>>>>>
76614>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76614>>>>>>>        // This error would otherwise be raised when we have an older
76614>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76614>>>>>>>        Send Ignore_error To Error_object_Id 20491
76615>>>>>>>        Get psDriverID To sDriverID
76616>>>>>>>        Move (Repeat(" ", 255)) To sRevision
76617>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76622>>>>>>>        Send Trap_Error To Error_object_Id 20491
76623>>>>>>>        If (Trim(sRevision) = "") Begin
76625>>>>>>>            // Unable to get the revision. return all zeroes.
76625>>>>>>>            Move "0.0.0.0" To sRevision
76626>>>>>>>        End
76626>>>>>>>>
76626>>>>>>>        Function_Return sRevision
76627>>>>>>>    End_Function // CKRevision
76628>>>>>>>
76628>>>>>>>    Function CkUsesUri Returns Integer
76630>>>>>>>        Local String  sDriverID
76630>>>>>>>        Local String  sVoid1
76630>>>>>>>        Local String  sVoid2
76630>>>>>>>        Local Integer iRetval
76630>>>>>>>
76630>>>>>>>        Get psDriverID To sDriverID
76631>>>>>>>
76631>>>>>>>        Move 0 To iRetval
76632>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76632>>>>>>>        // This error would otherwise be raised when we have an older
76632>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
76632>>>>>>>        Send Ignore_error To Error_object_Id 20491
76633>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
76638>>>>>>>        Send Trap_Error To Error_object_Id 20491
76639>>>>>>>
76639>>>>>>>        Function_Return iRetval
76640>>>>>>>    End_Function // CKUsesUri
76641>>>>>>>
76641>>>>>>>
76641>>>>>>>
76641>>>>>>>    //***
76641>>>>>>>    //*** Function: ExtractPartFromRevsion
76641>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76641>>>>>>>    //***
76641>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76641>>>>>>>    //***
76641>>>>>>>
76641>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76643>>>>>>>        Local Integer iPartRev
76643>>>>>>>        Local Integer iCurrentPart
76643>>>>>>>        Local Integer iSeparatorPos
76643>>>>>>>
76643>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76646>>>>>>>
76646>>>>>>>        Move 0 To iCurrentPart
76647>>>>>>>        Repeat
76647>>>>>>>>
76647>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76648>>>>>>>            If (iSeparatorPos > 0) Begin
76650>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76651>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76652>>>>>>>                Increment iCurrentPart
76653>>>>>>>            End
76653>>>>>>>>
76653>>>>>>>            Else If (sRevision <> "") Begin
76656>>>>>>>                Move sRevision To iPartRev
76657>>>>>>>                Move "" To sRevision
76658>>>>>>>                Increment iCurrentPart
76659>>>>>>>            End
76659>>>>>>>>
76659>>>>>>>            Else ;                Move -1 To iPartRev
76661>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76663>>>>>>>
76663>>>>>>>        Function_Return iPartRev
76664>>>>>>>    End_Function // EcxtractPartFromRevision
76665>>>>>>>
76665>>>>>>>
76665>>>>>>>
76665>>>>>>>    //***
76665>>>>>>>    //*** Function: CKMajorRevision
76665>>>>>>>    //*** Purpose : Returns the major revision of the CK
76665>>>>>>>    //***
76665>>>>>>>
76665>>>>>>>    Function CKMajorRevision Returns Integer
76667>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76668>>>>>>>    End_Function // CKMajorRevision
76669>>>>>>>
76669>>>>>>>
76669>>>>>>>
76669>>>>>>>    //***
76669>>>>>>>    //*** Function: CKMinorRevision
76669>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76669>>>>>>>    //***
76669>>>>>>>
76669>>>>>>>    Function CKMinorRevision Returns Integer
76671>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76672>>>>>>>    End_Function // CKMinorRevision
76673>>>>>>>
76673>>>>>>>
76673>>>>>>>
76673>>>>>>>    //***
76673>>>>>>>    //*** Function: CKReleaseRevision
76673>>>>>>>    //*** Purpose : Returns the release revision of the CK
76673>>>>>>>    //***
76673>>>>>>>
76673>>>>>>>    Function CKReleaseRevision Returns Integer
76675>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76676>>>>>>>    End_Function // CKReleaseRevision
76677>>>>>>>
76677>>>>>>>
76677>>>>>>>
76677>>>>>>>    //***
76677>>>>>>>    //*** Function: CKBuildRevision
76677>>>>>>>    //*** Purpose : Returns the major revision of the CK
76677>>>>>>>    //***
76677>>>>>>>
76677>>>>>>>    Function CKBuildRevision Returns Integer
76679>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76680>>>>>>>    End_Function // CKBuildRevision
76681>>>>>>>
76681>>>>>>>
76681>>>>>>>
76681>>>>>>>    //***
76681>>>>>>>    //*** Function: IsMinimalRevision
76681>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76681>>>>>>>    //***
76681>>>>>>>
76681>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76683>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76686>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76689>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76692>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76695>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76698>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76702>>>>>>>            End
76702>>>>>>>>
76702>>>>>>>        End
76702>>>>>>>>
76702>>>>>>>
76702>>>>>>>        Function_Return (FALSE)
76703>>>>>>>    End_Function // IsMinimalRevision
76704>>>>>>>
76704>>>>>>>    //   Functions to query the Pervasive.SQL version:
76704>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
76704>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
76704>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
76704>>>>>>>    //
76704>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
76704>>>>>>>    //   in the following format:
76704>>>>>>>    //       <version>.<revision>.<type>
76704>>>>>>>    //   possible values for <type>:
76704>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
76704>>>>>>>    //         server using Workgroup authentication mode
76704>>>>>>>    //       C for client cache engine
76704>>>>>>>    //       D for DOS workstation
76704>>>>>>>    //       N for client Requester
76704>>>>>>>    //       S for NetWare server
76704>>>>>>>    //       T for 32-bit Windows server engine
76704>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
76704>>>>>>>    //
76704>>>>>>>    //   example:
76704>>>>>>>    //       8.50.T
76704>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
76704>>>>>>>    //   32-bits Windows server.
76704>>>>>>>    //
76704>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
76704>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
76704>>>>>>>    //
76704>>>>>>>    //   If the version information is not available or can not be obtained
76704>>>>>>>    //   the functions will return "0.0.0"
76704>>>>>>>
76704>>>>>>>
76704>>>>>>>    //***
76704>>>>>>>    //*** Function: PSQLRequesterVersionInfo
76704>>>>>>>    //*** Purpose : Returns the version information of the
76704>>>>>>>    //***           Pervasive.SQL Client requester.
76704>>>>>>>
76704>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76706>>>>>>>
76706>>>>>>>        Local String  sDriverID
76706>>>>>>>        Local String  sVersion
76706>>>>>>>        Local String  sVoid
76706>>>>>>>        Local Integer iRetval
76706>>>>>>>
76706>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76706>>>>>>>        // This error would otherwise be raised when we have an older
76706>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76706>>>>>>>        Send Ignore_error To Error_object_Id 20491
76707>>>>>>>        Get psDriverID To sDriverID
76708>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76709>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76714>>>>>>>        Send Trap_Error To Error_object_Id 20491
76715>>>>>>>        If (Trim(sVersion) = "") Begin
76717>>>>>>>            // Unable to get the revision. return all zeroes.
76717>>>>>>>            Move "0.0.0" To sVersion
76718>>>>>>>        End
76718>>>>>>>>
76718>>>>>>>        Function_Return sVersion
76719>>>>>>>    End_Function //  PSQLRequesterVersion
76720>>>>>>>
76720>>>>>>>    //***
76720>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
76720>>>>>>>    //*** Purpose : Returns the version information of the
76720>>>>>>>    //***           Pervasive.SQL Local Engine
76720>>>>>>>
76720>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76722>>>>>>>
76722>>>>>>>        Local String  sDriverID
76722>>>>>>>        Local String  sVersion
76722>>>>>>>        Local String  sVoid
76722>>>>>>>        Local Integer iRetval
76722>>>>>>>
76722>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76722>>>>>>>        // This error would otherwise be raised when we have an older
76722>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76722>>>>>>>        Send Ignore_error To Error_object_Id 20491
76723>>>>>>>        Get psDriverID To sDriverID
76724>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76725>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76730>>>>>>>        Send Trap_Error To Error_object_Id 20491
76731>>>>>>>        If (Trim(sVersion) = "") Begin
76733>>>>>>>            // Unable to get the revision. return all zeroes.
76733>>>>>>>            Move "0.0.0" To sVersion
76734>>>>>>>        End
76734>>>>>>>>
76734>>>>>>>        Function_Return sVersion
76735>>>>>>>    End_Function //  PSQLLocalEngineVersion
76736>>>>>>>
76736>>>>>>>    //***
76736>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
76736>>>>>>>    //*** Purpose : Returns the version information of the
76736>>>>>>>    //***           Pervasive.SQL Server Engine
76736>>>>>>>
76736>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76738>>>>>>>
76738>>>>>>>        Local String  sDriverID
76738>>>>>>>        Local String  sVersion
76738>>>>>>>        Local String  sVoid
76738>>>>>>>        Local Integer iRetval
76738>>>>>>>
76738>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76738>>>>>>>        // This error would otherwise be raised when we have an older
76738>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76738>>>>>>>        Send Ignore_error To Error_object_Id 20491
76739>>>>>>>        Get psDriverID To sDriverID
76740>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76741>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76746>>>>>>>        Send Trap_Error To Error_object_Id 20491
76747>>>>>>>        If (Trim(sVersion) = "") Begin
76749>>>>>>>            // Unable to get the revision. return all zeroes.
76749>>>>>>>            Move "0.0.0" To sVersion
76750>>>>>>>        End
76750>>>>>>>>
76750>>>>>>>        Function_Return sVersion
76751>>>>>>>    End_Function //  PSQLServerEngineVersion
76752>>>>>>>
76752>>>>>>>End_Class // cDfbtrdrvHandler
76753>>>>>>>
76753>>>>>
76753>>>>>
76753>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
76754>>>>>
76754>>>>>Register_Function phoWorkspace Returns Handle
76754>>>>>Register_Function Help_filename Returns String
76754>>>>>Register_Function GetHelpFile Returns String
76754>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
76754>>>>>
76754>>>>>//****************************************************************************
76754>>>>>// $Module type: FUNCTION
76754>>>>>// $Module name: Network_User_Name
76754>>>>>// $Author     : AK/VOO/KCR
76754>>>>>// Created     : 09-24-96 @ 19:17
76754>>>>>//
76754>>>>>// Description
76754>>>>>//    This function reads the current username Of windows and returns that
76754>>>>>//    name or an text unknown user
76754>>>>>//
76754>>>>>// $Rev History
76754>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
76754>>>>>//  07/25/2003  Replaced obsolete code
76754>>>>>//  09/24/1996  Module header created
76754>>>>>//****************************************************************************
76754>>>>>Function Network_User_Name for cDesktop Returns String
76756>>>>>    String sName
76756>>>>>    Integer iRetval iLength
76756>>>>>
76756>>>>>    Move 0 to iLength
76757>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
76758>>>>>    ZeroString iLength to sName
76759>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
76760>>>>>
76760>>>>>    If (iRetval = NO_ERROR) Begin
76762>>>>>        Function_Return (CString (sName))
76763>>>>>    End
76763>>>>>>
76763>>>>>    
76763>>>>>    Function_Return "User Unknown"
76764>>>>>End_Function
76765>>>>>
76765>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
76765>>>>>Type MEMORYSTATUS
76765>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
76765>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
76765>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
76765>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
76765>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
76765>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
76765>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
76765>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
76765>>>>>End_Type // MEMORYSTATUS
76765>>>>>
76765>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
76766>>>>>
76766>>>>>Struct tWinMemoryStatusEx
76766>>>>>    UInteger dwLength                
76766>>>>>    UInteger dwMemoryLoad          
76766>>>>>    UBigInt ullTotalPhys           
76766>>>>>    UBigInt ullAvailPhys           
76766>>>>>    UBigInt ullTotalPageFile       
76766>>>>>    UBigInt ullAvailPageFile       
76766>>>>>    UBigInt ullTotalVirtual        
76766>>>>>    UBigInt ullAvailVirtual        
76766>>>>>    UBigInt ullAvailExtendedVirtual
76766>>>>>End_Struct
76766>>>>>
76766>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
76767>>>>>
76767>>>>>Class SysinfoDisplay is a cTextEdit
76768>>>>>    Procedure Construct_Object
76770>>>>>        Forward Send Construct_Object
76772>>>>>
76772>>>>>        Set Location To 6 6
76773>>>>>        Set Size To 110 255
76774>>>>>        Set Read_Only_State To True
76775>>>>>        Set pbWrap to False
76776>>>>>    End_Procedure
76777>>>>>
76777>>>>>    //****************************************************************************
76777>>>>>    // $Module type: PROCEDURE
76777>>>>>    // $Module name: Show_Current_Directory
76777>>>>>    // $Author     : VOO
76777>>>>>    // Created     : 06-10-96 @ 15:24
76777>>>>>    //
76777>>>>>    // Description
76777>>>>>    //    This method will show the name Of the current directory in the system
76777>>>>>    //    information box
76777>>>>>    //
76777>>>>>    // $Rev History
76777>>>>>    //    06-10-96  Module header created
76777>>>>>    //****************************************************************************
76777>>>>>    Procedure Show_Current_Directory
76779>>>>>        String sDir
76779>>>>>
76779>>>>>        Get_Current_Directory To sDir
76780>>>>>
76780>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
76781>>>>>    End_Procedure
76782>>>>>
76782>>>>>    Procedure Show_Windows_Directory
76784>>>>>        String sWindir
76784>>>>>
76784>>>>>        Get_Windows_Directory To sWindir
76785>>>>>
76785>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
76786>>>>>    End_Procedure
76787>>>>>
76787>>>>>    Procedure Show_Current_User
76789>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
76790>>>>>    End_Procedure
76791>>>>>
76791>>>>>    Procedure Show_Number_Format
76793>>>>>        Integer iFormat
76793>>>>>        String sFormatText
76793>>>>>
76793>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
76796>>>>>        Move (Character (iFormat)) To sFormatText
76797>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
76798>>>>>
76798>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
76801>>>>>        Move (Character (iFormat)) to sFormatText
76802>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
76803>>>>>    End_Procedure
76804>>>>>
76804>>>>>    Procedure Show_Filelist_Name
76806>>>>>        String sFilename
76806>>>>>
76806>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
76809>>>>>
76809>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
76810>>>>>        Send AppendTextLn ""
76811>>>>>    End_Procedure
76812>>>>>
76812>>>>>    Procedure Show_Lock_Delay
76814>>>>>        Integer iLockdelay
76814>>>>>
76814>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
76817>>>>>
76817>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
76818>>>>>    End_Procedure
76819>>>>>
76819>>>>>    Procedure Show_Lock_Timeout
76821>>>>>        Integer iLockTimeout
76821>>>>>
76821>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
76824>>>>>
76824>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
76825>>>>>    End_Procedure
76826>>>>>
76826>>>>>    Procedure Show_Screen_Size
76828>>>>>        Integer iYscreensize iXscreensize
76828>>>>>
76828>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
76829>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
76830>>>>>
76830>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
76831>>>>>    End_Procedure
76832>>>>>
76832>>>>>    Procedure Show_Page_Size
76834>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
76835>>>>>    End_procedure
76836>>>>>
76836>>>>>    Procedure Show_Date
76838>>>>>        Date dToday
76838>>>>>
76838>>>>>        Sysdate dToday
76839>>>>>
76839>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
76840>>>>>    End_procedure
76841>>>>>
76841>>>>>    Procedure Show_Date_Format
76843>>>>>        Integer iDateFormat
76843>>>>>        String sDateFormat
76843>>>>>
76843>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
76846>>>>>        Case Begin
76846>>>>>            Case (iDateFormat = DF_DATE_USA)
76848>>>>>                Move C_$USA To sDateFormat
76849>>>>>                Case Break
76850>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
76853>>>>>                Move C_$European To sDateFormat
76854>>>>>                Case Break
76855>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
76858>>>>>                Move C_$Military To sDateFormat
76859>>>>>                Case Break
76860>>>>>            Case Else
76860>>>>>                Move C_$UnknownDateType To sDateFormat
76861>>>>>                Case Break
76862>>>>>        Case End
76862>>>>>
76862>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
76863>>>>>    End_Procedure
76864>>>>>
76864>>>>>    Procedure Show_Systemresources
76866>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76866>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76866>>>>>        Integer iRetval
76866>>>>>
76866>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
76867>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
76868>>>>>        If (iRetval = 0) Begin
76870>>>>>            Move (ShowLastError ()) to iRetval
76871>>>>>        End
76871>>>>>>
76871>>>>>
76871>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
76872>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
76873>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
76874>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
76875>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
76876>>>>>    End_Procedure
76877>>>>>
76877>>>>>    Procedure Show_Registration
76879>>>>>        String sRegName
76879>>>>>        Integer iSN iMaxUsers
76879>>>>>
76879>>>>>        Registration sRegName iSN
76880>>>>>>
76880>>>>>        
76880>>>>>        Get_Licensed_Max_Users to iMaxUsers
76881>>>>>
76881>>>>>        Send AppendTextLn ""
76882>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
76883>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
76884>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
76885>>>>>    End_Procedure
76886>>>>>
76886>>>>>    //****************************************************************************
76886>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
76886>>>>>    // To the workspace object passing the an object and message To send back
76886>>>>>    // To this object. It is expected that the workspace object will send this
76886>>>>>    // message for every line Of information it wants displayed (passing the
76886>>>>>    // information To be displayed
76886>>>>>    //****************************************************************************
76886>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
76886>>>>>
76886>>>>>    Procedure Show_ServicePack
76888>>>>>        String sKey sVersionDescription sVersion 
76888>>>>>        Handle hoRegistry
76888>>>>>        Boolean bExists bOpened
76888>>>>>        
76888>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
76889>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
76890>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
76891>>>>>
76891>>>>>        Move C_DFVersionRegistryRoot to sKey
76892>>>>>        Get KeyExists of hoRegistry sKey to bExists
76893>>>>>        If (bExists) Begin
76895>>>>>            Get OpenKey of hoRegistry sKey to bOpened
76896>>>>>            If (bOpened) Begin
76898>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
76899>>>>>                If (bExists) Begin
76901>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
76902>>>>>                End
76902>>>>>>
76902>>>>>                
76902>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
76903>>>>>                If (bExists) Begin
76905>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
76906>>>>>                End                
76906>>>>>>
76906>>>>>                Send CloseKey of hoRegistry
76907>>>>>            End
76907>>>>>>
76907>>>>>        End
76907>>>>>>
76907>>>>>        Send Destroy of hoRegistry
76908>>>>>
76908>>>>>        If (sVersionDescription <> "") Begin
76910>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
76911>>>>>           Send AppendTextLn ""
76912>>>>>        End
76912>>>>>>
76912>>>>>    End_Procedure
76913>>>>>    
76913>>>>>
76913>>>>>    Procedure Show_WorkspaceInformation
76915>>>>>        Integer hoWorkspace
76915>>>>>
76915>>>>>        If (ghoApplication <> 0) Begin
76917>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
76918>>>>>            If (hoWorkspace <> 0) Begin
76920>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
76921>>>>>                Send AppendTextLn ""
76922>>>>>            End
76922>>>>>>
76922>>>>>        End
76922>>>>>>
76922>>>>>    End_Procedure
76923>>>>>
76923>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
76925>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
76926>>>>>    End_Function
76927>>>>>
76927>>>>>    Procedure Show_Versions
76929>>>>>        Integer iVersion iRevision iBuild
76929>>>>>
76929>>>>>        Version_Information iVersion iRevision iBuild
76931>>>>>
76931>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
76932>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
76933>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
76934>>>>>    End_Procedure
76935>>>>>    
76935>>>>>    Function CKRevisionNumber String sDriverID Returns String
76937>>>>>        Handle hoCLIHandler
76937>>>>>        Handle hoDFBtrDrvHandler
76937>>>>>        String sCKRevision
76937>>>>>
76937>>>>>
76937>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
76939>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
76940>>>>>            Set psDriverID of hoCLIHandler to sDriverID
76941>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
76942>>>>>            Send Destroy of hoCLIHandler
76943>>>>>        End
76943>>>>>>
76943>>>>>        Else Begin
76944>>>>>            If (sDriverID = "DFBTRDRV") Begin
76946>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
76947>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
76948>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
76949>>>>>                Send Destroy of hoDFBtrDrvHandler
76950>>>>>            End
76950>>>>>>
76950>>>>>        End
76950>>>>>>
76950>>>>>        
76950>>>>>        Function_Return sCKRevision
76951>>>>>    End_Function
76952>>>>>    
76952>>>>>    
76952>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
76954>>>>>        
76954>>>>>        If (sDriverID = "DATAFLEX") Begin
76956>>>>>            Function_Return False
76957>>>>>        End
76957>>>>>>
76957>>>>>    
76957>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
76958>>>>>    End_Function    
76959>>>>>
76959>>>>>
76959>>>>>    //***
76959>>>>>    //*** BW
76959>>>>>    //*** Procedure: Show_Drivers
76959>>>>>    //*** Purpose  : Show loaded database drivers
76959>>>>>    //***
76959>>>>>
76959>>>>>    Procedure Show_Drivers
76961>>>>>        String sCurrentDriver sRevNumber
76961>>>>>        String sLoadedDrivers
76961>>>>>        Integer iNumberOfDrivers iCount
76961>>>>>        Boolean bOK
76961>>>>>
76961>>>>>        Move "" To sLoadedDrivers
76962>>>>>        Get_Attribute DF_NUMBER_DRIVERS To iNumberOfDrivers
76965>>>>>        For iCount From 1 To iNumberOfDrivers
76971>>>>>>
76971>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
76974>>>>>            If (sLoadedDrivers <> "") Begin
76976>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
76977>>>>>            End
76977>>>>>>
76977>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
76978>>>>>            If (bOK) Begin
76980>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
76981>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
76982>>>>>            End
76982>>>>>>
76982>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) To sLoadedDrivers
76983>>>>>        Loop
76984>>>>>>
76984>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
76985>>>>>    End_Procedure
76986>>>>>
76986>>>>>    Procedure Show_HelpFile
76988>>>>>        String sHelpFile
76988>>>>>        Integer eHelpType
76988>>>>>
76988>>>>>        If (ghoApplication <> 0) Begin
76990>>>>>            Get peHelpType Of ghoApplication To eHelpType
76991>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
76993>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
76994>>>>>            End
76994>>>>>>
76994>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
76997>>>>>                Get Help_filename Of Help_object_id To sHelpFile
76998>>>>>            End
76998>>>>>>
76998>>>>>            Else Begin
76999>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
77000>>>>>            End
77000>>>>>>
77000>>>>>
77000>>>>>            Send AppendTextLn ""
77001>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
77002>>>>>        End
77002>>>>>>
77002>>>>>    End_Procedure
77003>>>>>
77003>>>>>    Procedure Show_EnterAsTab
77005>>>>>        Boolean bEnterKeyAsTabKey
77005>>>>>        String sText
77005>>>>>
77005>>>>>        If (ghoApplication <> 0) Begin
77007>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
77008>>>>>            If (bEnterKeyAsTabKey) Begin
77010>>>>>                Move "True" To sText
77011>>>>>            End
77011>>>>>>
77011>>>>>            Else Begin
77012>>>>>                Move "False" To sText
77013>>>>>            End
77013>>>>>>
77013>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
77014>>>>>        End
77014>>>>>>
77014>>>>>    End_Procedure
77015>>>>>
77015>>>>>    //****************************************************************************
77015>>>>>    // $Module type: PROCEDURE
77015>>>>>    // $Module name: Add_Focus
77015>>>>>    // $Author     : VOO
77015>>>>>    // Created     : 24-09-96 @ 19:43
77015>>>>>    //
77015>>>>>    // Description
77015>>>>>    //    During activation we will remove the old information and add the newly
77015>>>>>    //    found systeminformation
77015>>>>>    //
77015>>>>>    // $Rev History
77015>>>>>    //    24-09-96  Module header created
77015>>>>>    //****************************************************************************
77015>>>>>    Procedure Add_Focus Integer hoRoot
77017>>>>>        Forward Send Add_Focus hoRoot
77019>>>>>
77019>>>>>        Send Delete_Data
77020>>>>>
77020>>>>>        Set Changed_State To False
77021>>>>>        Set Read_Only_State To True
77022>>>>>
77022>>>>>        Send Show_ServicePack
77023>>>>>        Send Show_Versions   
77024>>>>>        Send Show_Drivers         
77025>>>>>        Send Show_HelpFile
77026>>>>>        Send Show_Current_Directory
77027>>>>>        Send Show_Filelist_Name          
77028>>>>>        If (ghoApplication <> 0) Begin
77030>>>>>            Send Show_WorkSpaceInformation // added To show WS info
77031>>>>>        End
77031>>>>>>
77031>>>>>        Send Show_Current_User 
77032>>>>>        Send Show_Windows_Directory 
77033>>>>>        Send Show_Screen_Size
77034>>>>>        Send Show_Page_Size
77035>>>>>        Send Show_EnterAsTab        
77036>>>>>        Send Show_Number_Format
77037>>>>>        Send Show_Date_Format
77038>>>>>        Send Show_Lock_Delay
77039>>>>>        Send Show_Lock_Timeout
77040>>>>>        Send Show_Date
77041>>>>>        Send Show_Systemresources
77042>>>>>        Send Show_Registration
77043>>>>>        Send Beginning_of_Data
77044>>>>>
77044>>>>>        Set Icon to 'default.ico'
77045>>>>>    End_Procedure
77046>>>>>End_Class
77047>>>>>
77047>>>>>//****************************************************************************
77047>>>>>// $Module type: OBJECT
77047>>>>>// $Module name: Sysinfo_Dialog
77047>>>>>// $Author     : VOO
77047>>>>>// Created     : 24-09-96 @ 18:47
77047>>>>>//
77047>>>>>// Description
77047>>>>>//    This object shows the systeminformation on the screen
77047>>>>>//
77047>>>>>// $Rev History
77047>>>>>//    24-09-96  Module header created
77047>>>>>//****************************************************************************
77047>>>>>Class SysInfoDialog Is A ModalPanel
77048>>>>>    Procedure Construct_Object
77050>>>>>        Forward Send Construct_Object
77052>>>>>
77052>>>>>        Set Label to C_$SystemInformation
77053>>>>>        Set Size to 140 267
77054>>>>>        Set piMinSize to 140 267
77055>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77056>>>>>        Set Border_Style to Border_Thick
77057>>>>>
77057>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
77059>>>>>            Set peAnchors to anAll
77060>>>>>        End_Object
77061>>>>>
77061>>>>>        Object oCloseButton Is A Button
77063>>>>>            Set Label To C_$Close
77064>>>>>            Set Location To 120 210
77065>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
77066>>>>>            Set Default_State To True
77067>>>>>            Set peAnchors to anBottomRight
77068>>>>>        End_Object
77069>>>>>
77069>>>>>        On_Key kCancel Send Close_Panel
77070>>>>>    End_Procedure
77071>>>>>End_Class
77072>>>>>
77072>>>>>// Purpose:
77072>>>>>//
77072>>>>>// Ken Ross 12/17/96 5:16PM
77072>>>>>//
77072>>>>>Class AboutDialog Is A ModalPanel
77073>>>>>    Procedure Construct_Object
77075>>>>>        String sVdfRootDir
77075>>>>>
77075>>>>>        Forward Send Construct_Object
77077>>>>>
77077>>>>>        Set Label To C_$About
77078>>>>>        Set Size to 89 212
77079>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77080>>>>>
77080>>>>>        Object oSysInfoDialog Is A SysInfoDialog
77082>>>>>        End_Object
77083>>>>>
77083>>>>>        Object oBox Is A Container3d
77085>>>>>            Set Border_Style To Border_StaticEdge
77086>>>>>            Set Size to 63 202
77087>>>>>            Set Location To 4 5
77088>>>>>
77088>>>>>            Object oAboutGraphic Is A BitmapContainer
77090>>>>>                Set Border_Style To Border_None
77091>>>>>                Set Bitmap_Style To Bitmap_Center
77092>>>>>                Set Size To 48 48
77093>>>>>                Set Location To 7 2
77094>>>>>            End_Object
77095>>>>>
77095>>>>>            Object oProductName Is A TextBox
77097>>>>>                Set Label To C_$ProductName
77098>>>>>                Set Size To 10 45
77099>>>>>                Set Location To 8 53
77100>>>>>            End_Object
77101>>>>>
77101>>>>>            Object oVersion Is A TextBox
77103>>>>>                Set Label To C_$Version
77104>>>>>                Set Size To 10 25
77105>>>>>                Set Location To 21 53
77106>>>>>            End_Object
77107>>>>>
77107>>>>>            Object oCopyright Is A TextBox
77109>>>>>                Set Label To C_$Copyright
77110>>>>>                Set Size To 10 31
77111>>>>>                Set Location To 34 53
77112>>>>>            End_Object
77113>>>>>
77113>>>>>            Object oAuthor Is A TextBox
77115>>>>>                Set Label To C_$Author
77116>>>>>                Set Size To 10 22
77117>>>>>                Set Location To 46 53
77118>>>>>            End_Object
77119>>>>>        End_Object
77120>>>>>
77120>>>>>        Object oOKButton Is A Button
77122>>>>>            On_Item C_$OK Send Close_Panel
77123>>>>>            Set Size To 14 50
77124>>>>>            Set Location To 71 157
77125>>>>>        End_Object
77126>>>>>
77126>>>>>        Object oSysInfoButton Is A Button
77128>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
77129>>>>>            Set Size To 14 50
77130>>>>>            Set Location To 71 101
77131>>>>>        End_Object
77132>>>>>
77132>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
77133>>>>>
77133>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
77134>>>>>    End_Procedure
77135>>>>>
77135>>>>>    Procedure Set ProductName String sProductName
77137>>>>>        Set Label Of oProductName To sProductName
77138>>>>>    End_Procedure
77139>>>>>
77139>>>>>    Procedure Set Version String sVersion
77141>>>>>        Set Label Of oVersion To sVersion
77142>>>>>    End_Procedure
77143>>>>>
77143>>>>>    Procedure Set Copyright string sCopyright
77145>>>>>        Set Label Of oCopyright To sCopyright
77146>>>>>    End_Procedure
77147>>>>>
77147>>>>>    Procedure Set Author String sAuthor
77149>>>>>        Set Label Of oAuthor To sAuthor
77150>>>>>    End_Procedure
77151>>>>>
77151>>>>>    Procedure Set Logo string sLogo
77153>>>>>        // square bitmaps Of 42x42 work best
77153>>>>>        Set Bitmap Of oAboutGraphic To sLogo
77154>>>>>    End_Procedure
77155>>>>>
77155>>>>>    Procedure Show_Sysinfo
77157>>>>>        Send Popup_Modal Of oSysinfoDialog
77158>>>>>    End_Procedure
77159>>>>>
77159>>>>>    Procedure End_Construct_Object
77161>>>>>        Handle hoVersionInfo
77161>>>>>        Boolean bIncluded
77161>>>>>        Integer iMajor iMinor iRelease iBuild
77161>>>>>        String sLabel
77161>>>>>
77161>>>>>        Get Label Of oVersion To sLabel
77162>>>>>        If (sLabel = C_$VERSION) Begin
77164>>>>>            // set it To the version info Of the program, if available
77164>>>>>            If (ghoApplication <> 0) Begin
77166>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
77167>>>>>                If (hoVersionInfo <> 0) Begin
77169>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
77170>>>>>                    If (bIncluded) Begin
77172>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
77173>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
77174>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
77175>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
77176>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
77177>>>>>                        Set Version to sLabel
77178>>>>>                    End
77178>>>>>>
77178>>>>>                End
77178>>>>>>
77178>>>>>            End
77178>>>>>>
77178>>>>>        End
77178>>>>>>
77178>>>>>
77178>>>>>        Forward Send End_Construct_Object
77180>>>>>    End_Procedure
77181>>>>>End_Class
77182>>>
77182>>>// *************************************************************************
77182>>>//  Public message. This is the default message. It is expected that you will
77182>>>//   create your own message to override this
77182>>>// *************************************************************************
77182>>>
77182>>>Procedure Activate_About
77185>>>   Send DoAbout "" "" "" "" ""
77186>>>End_Procedure
77187>>>
77187>>>// *************************************************************************
77187>>>//  Public message. It is expected that you will send this message (most
77187>>>//  likely from Activate_About. This creates an about object, activates it
77187>>>//  and destroys it when done. It is not exepected that you will augment this.
77187>>>// *************************************************************************
77187>>>
77187>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
77190>>>        integer hoObj hoMain
77190>>>
77190>>>        // create object
77190>>>        Object About is an AboutDialog
77192>>>            // if no title passed use the label of the main panel
77192>>>            // (if a main panel exists).
77192>>>            if sTitle     eq '' Begin
77194>>>                Get Main_Window of desktop to hoMain
77195>>>                if hoMain Get Label of hoMain to sTitle
77198>>>            end
77198>>>>
77198>>>            set productname to sTitle
77199>>>            set version     to sVersion
77200>>>            set copyright   to sCopyRight
77201>>>            set author      to sAuthor
77202>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
77205>>>            Move self to hoObj // object Id
77206>>>        End_Object
77207>>>        Send Popup   of hoObj    // popup the about object
77208>>>        Send Destroy of hoObj // when done, it will be destroyed
77209>>>End_procedure
77210>        Use AutoEntry.vw
Including file: AutoEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\AutoEntry.vw)
77210>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\AutoEntry.vw
77210>>>// AutoEntry
77210>>>//
77210>>>
77210>>>Use DFClient.pkg
77210>>>Use DFEntry.pkg
77210>>>Use Dfcentry.PKG
77210>>>
77210>>>Use cAutoDataDictionary.dd
Including file: cAutoDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cAutoDataDictionary.dd)
77210>>>>>Use DataDict.pkg
77210>>>>>
77210>>>>>Open Auto
Including file: Auto.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\Auto.fd)
77212>>>>>Open Fuvarlevel
Including file: Fuvarlevel.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\Fuvarlevel.fd)
77214>>>>>
77214>>>>>Register_Object Auto_sl
77214>>>>>
77214>>>>>Class cAutoDataDictionary is a DataDictionary
77215>>>>>    
77215>>>>>    Procedure Construct_Object
77217>>>>>        Forward Send Construct_Object
77219>>>>>        Set Main_File to Auto.File_Number
77220>>>>>
77220>>>>>        Set Add_Client_File to Fuvarlevel.File_Number
77221>>>>>
77221>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77222>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77223>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77224>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77225>>>>>
77225>>>>>        Set Field_Option Field Auto.auto_rendszam DD_AUTOFIND to True
77226>>>>>        Set Field_Mask Field Auto.auto_rendszam to "@@@-###"
77227>>>>>        Set Key_Field_State Field Auto.auto_rendszam to True
77228>>>>>        Set Field_Label_Long Field Auto.auto_rendszam to "Rendsz m"
77229>>>>>        Set Field_Prompt_Object Field Auto.auto_rendszam to Auto_sl
77230>>>>>
77230>>>>>        Set Field_Option Field Auto.auto_tipus DD_AUTOFIND to True
77231>>>>>        Set Field_Label_Long Field Auto.auto_tipus to "Aut¢ t¡pus"
77232>>>>>        Set Field_Prompt_Object Field Auto.auto_tipus to Auto_sl
77233>>>>>
77233>>>>>    End_Procedure
77234>>>>>
77234>>>>>End_Class
77235>>>>>
77235>>>>>Use Auto.sl
Including file: Auto.sl    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\Auto.sl)
77235>>>>>>>// Auto.sl
77235>>>>>>>// Auto lista
77235>>>>>>>
77235>>>>>>>Use DFClient.pkg
77235>>>>>>>Use cDbCJGridPromptList.pkg
77235>>>>>>>Use cDbCJGridColumn.pkg
77235>>>>>>>Use Windows.pkg
77235>>>>>>>
77235>>>>>>>Use cAutoDataDictionary.dd
77235>>>>>>>
77235>>>>>>>CD_Popup_Object Auto_sl is a dbModalPanel
77253>>>>>>>>
77253>>>>>>>    Set Location to 5 5
77254>>>>>>>    Set Size to 134 214
77255>>>>>>>    Set Label To "Auto lista"
77256>>>>>>>    Set Border_Style to Border_Thick
77257>>>>>>>    Set Minimize_Icon to False
77258>>>>>>>
77258>>>>>>>
77258>>>>>>>    Object oAuto_DD is a cAutoDataDictionary
77260>>>>>>>    End_Object 
77261>>>>>>>
77261>>>>>>>    Set Main_DD To oAuto_DD
77262>>>>>>>    Set Server  To oAuto_DD
77263>>>>>>>
77263>>>>>>>
77263>>>>>>>
77263>>>>>>>    Object oSelList is a cDbCJGridPromptList
77265>>>>>>>        Set Size to 105 204
77266>>>>>>>        Set Location to 5 5
77267>>>>>>>        Set peAnchors to anAll
77268>>>>>>>        Set psLayoutSection to "Auto_sl_oSelList"
77269>>>>>>>        Set Ordering to 1
77270>>>>>>>        Set pbAutoServer to True
77271>>>>>>>
77271>>>>>>>        Object oAuto_auto_rendszam is a cDbCJGridColumn
77273>>>>>>>            Entry_Item Auto.auto_rendszam
77274>>>>>>>            Set piWidth to 88
77275>>>>>>>            Set psCaption to "Rendsz m"
77276>>>>>>>        End_Object 
77277>>>>>>>
77277>>>>>>>        Object oAuto_auto_tipus is a cDbCJGridColumn
77279>>>>>>>            Entry_Item Auto.auto_tipus
77280>>>>>>>            Set piWidth to 300
77281>>>>>>>            Set psCaption to "Aut¢ t¡pus"
77282>>>>>>>        End_Object 
77283>>>>>>>
77283>>>>>>>
77283>>>>>>>    End_Object 
77284>>>>>>>
77284>>>>>>>    Object oOk_bn is a Button
77286>>>>>>>        Set Label to "&Ok"
77287>>>>>>>        Set Location to 115 51
77288>>>>>>>        Set peAnchors to anBottomRight
77289>>>>>>>
77289>>>>>>>        Procedure OnClick
77292>>>>>>>            Send OK of oSelList
77293>>>>>>>        End_Procedure
77294>>>>>>>
77294>>>>>>>    End_Object 
77295>>>>>>>
77295>>>>>>>    Object oCancel_bn is a Button
77297>>>>>>>        Set Label to "&Cancel"
77298>>>>>>>        Set Location to 115 105
77299>>>>>>>        Set peAnchors to anBottomRight
77300>>>>>>>
77300>>>>>>>        Procedure OnClick
77303>>>>>>>            Send Cancel of oSelList
77304>>>>>>>        End_Procedure
77305>>>>>>>
77305>>>>>>>    End_Object 
77306>>>>>>>
77306>>>>>>>    Object oSearch_bn is a Button
77308>>>>>>>        Set Label to "&Search..."
77309>>>>>>>        Set Location to 115 159
77310>>>>>>>        Set peAnchors to anBottomRight
77311>>>>>>>
77311>>>>>>>        Procedure OnClick
77314>>>>>>>            Send Search of oSelList
77315>>>>>>>        End_Procedure
77316>>>>>>>
77316>>>>>>>    End_Object 
77317>>>>>>>
77317>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77318>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77319>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77320>>>>>>>
77320>>>>>>>
77320>>>>>>>CD_End_Object // Auto_sl
77322>>>>>>>>
77322>>>
77322>>>ACTIVATE_VIEW Activate_oAutoEntry FOR oAutoEntry
77332>>>>
77332>>>Object oAutoEntry is a dbView
77334>>>    Set Location to 5 5
77335>>>    Set Size to 38 247
77336>>>    Set Label to "Aut¢"
77337>>>    Set Border_Style to Border_Thick
77338>>>
77338>>>
77338>>>    Object oAuto_DD is a cAutoDataDictionary
77340>>>    End_Object 
77341>>>
77341>>>    Set Main_DD To oAuto_DD
77342>>>    Set Server  To oAuto_DD
77343>>>
77343>>>
77343>>>
77343>>>    Object oAutoauto_rendszam is a dbForm
77345>>>        Entry_Item Auto.auto_rendszam
77346>>>        Set Size to 13 48
77347>>>        Set Location to 5 56
77348>>>        Set peAnchors to anTopLeftRight
77349>>>        Set Label to "Rendsz m"
77350>>>        Set Label_Justification_mode to jMode_Left
77351>>>        Set Label_Col_Offset to 51
77352>>>        Set Label_row_Offset to 0
77353>>>    End_Object 
77354>>>
77354>>>    Object oAutoauto_tipus is a dbForm
77356>>>        Entry_Item Auto.auto_tipus
77357>>>        Set Size to 13 186
77358>>>        Set Location to 20 56
77359>>>        Set peAnchors to anTopLeftRight
77360>>>        Set Label to "T¡pus"
77361>>>        Set Label_Justification_mode to jMode_Left
77362>>>        Set Label_Col_Offset to 51
77363>>>        Set Label_row_Offset to 0
77364>>>    End_Object 
77365>>>
77365>>>
77365>>>End_Object 
77366>        Use SoforEntry.vw
Including file: SoforEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\SoforEntry.vw)
77366>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\SoforEntry.vw
77366>>>// SoforEntry
77366>>>//
77366>>>
77366>>>Use DFClient.pkg
77366>>>Use DFEntry.pkg
77366>>>Use Dfcentry.PKG
77366>>>
77366>>>Use cSoforDataDictionary.dd
Including file: cSoforDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cSoforDataDictionary.dd)
77366>>>>>Use DataDict.pkg
77366>>>>>
77366>>>>>Open Sofor
Including file: Sofor.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\Sofor.fd)
77368>>>>>Open Fuvarlevel
77370>>>>>Open system_table
Including file: system_table.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\system_table.fd)
77372>>>>>
77372>>>>>Register_Object Sofor_sl
77372>>>>>
77372>>>>>Class cSoforDataDictionary is a DataDictionary
77373>>>>>    
77373>>>>>    Procedure Construct_Object
77375>>>>>        Forward Send Construct_Object
77377>>>>>        Set Main_File to Sofor.File_Number
77378>>>>>
77378>>>>>        Set Add_Client_File to Fuvarlevel.File_Number
77379>>>>>
77379>>>>>        Set Add_System_File to system_table.File_Number DD_Lock_On_All
77380>>>>>
77380>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77381>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77382>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77383>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77384>>>>>
77384>>>>>        Set Field_Option Field Sofor.sofor_azonosito DD_AUTOFIND to True
77385>>>>>        Set Field_Auto_Increment Field Sofor.sofor_azonosito to File_Field system_table.sofor_azonosito
77386>>>>>        Set Key_Field_State Field Sofor.sofor_azonosito to True
77387>>>>>        Set Field_Label_Long Field Sofor.sofor_azonosito to "Sof‹r id"
77388>>>>>        Set Field_Label_Short Field Sofor.sofor_azonosito to "Azonos¡t¢"
77389>>>>>        Set Field_Prompt_Object Field Sofor.sofor_azonosito to Sofor_sl
77390>>>>>
77390>>>>>        Set Field_Label_Long Field Sofor.sofor_nev to "Sof‹r neve"
77391>>>>>        Set Field_Label_Short Field Sofor.sofor_nev to "N‚v"
77392>>>>>        Set Field_Prompt_Object Field Sofor.sofor_nev to Sofor_sl
77393>>>>>
77393>>>>>        Set Field_Label_Long Field Sofor.sofor_szigsz to "Szigsz."
77394>>>>>        Set Field_Prompt_Object Field Sofor.sofor_szigsz to Sofor_sl
77395>>>>>
77395>>>>>    End_Procedure
77396>>>>>
77396>>>>>End_Class
77397>>>>>
77397>>>>>Use Sofor.sl
Including file: Sofor.sl    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\Sofor.sl)
77397>>>>>>>// Sofor.sl
77397>>>>>>>// Sof‹r lista
77397>>>>>>>
77397>>>>>>>Use DFClient.pkg
77397>>>>>>>Use cDbCJGridPromptList.pkg
77397>>>>>>>Use cDbCJGridColumn.pkg
77397>>>>>>>Use Windows.pkg
77397>>>>>>>
77397>>>>>>>Use cSoforDataDictionary.dd
77397>>>>>>>
77397>>>>>>>CD_Popup_Object Sofor_sl is a dbModalPanel
77415>>>>>>>>
77415>>>>>>>    Set Location to 5 5
77416>>>>>>>    Set Size to 134 285
77417>>>>>>>    Set Label To "Sof‹r lista"
77418>>>>>>>    Set Border_Style to Border_Thick
77419>>>>>>>    Set Minimize_Icon to False
77420>>>>>>>
77420>>>>>>>
77420>>>>>>>    Object oSofor_DD is a cSoforDataDictionary
77422>>>>>>>    End_Object 
77423>>>>>>>
77423>>>>>>>    Set Main_DD To oSofor_DD
77424>>>>>>>    Set Server  To oSofor_DD
77425>>>>>>>
77425>>>>>>>
77425>>>>>>>
77425>>>>>>>    Object oSelList is a cDbCJGridPromptList
77427>>>>>>>        Set Size to 105 275
77428>>>>>>>        Set Location to 5 5
77429>>>>>>>        Set peAnchors to anAll
77430>>>>>>>        Set psLayoutSection to "Sofor_sl_oSelList"
77431>>>>>>>        Set Ordering to 1
77432>>>>>>>        Set pbAutoServer to True
77433>>>>>>>
77433>>>>>>>        Object oSofor_sofor_azonosito is a cDbCJGridColumn
77435>>>>>>>            Entry_Item Sofor.sofor_azonosito
77436>>>>>>>            Set piWidth to 86
77437>>>>>>>            Set psCaption to "Azonos¡t¢"
77438>>>>>>>        End_Object 
77439>>>>>>>
77439>>>>>>>        Object oSofor_sofor_nev is a cDbCJGridColumn
77441>>>>>>>            Entry_Item Sofor.sofor_nev
77442>>>>>>>            Set piWidth to 300
77443>>>>>>>            Set psCaption to "N‚v"
77444>>>>>>>        End_Object 
77445>>>>>>>
77445>>>>>>>        Object oSofor_sofor_szigsz is a cDbCJGridColumn
77447>>>>>>>            Entry_Item Sofor.sofor_szigsz
77448>>>>>>>            Set piWidth to 144
77449>>>>>>>            Set psCaption to "Szigsz."
77450>>>>>>>        End_Object 
77451>>>>>>>
77451>>>>>>>
77451>>>>>>>    End_Object 
77452>>>>>>>
77452>>>>>>>    Object oOk_bn is a Button
77454>>>>>>>        Set Label to "&Ok"
77455>>>>>>>        Set Location to 115 122
77456>>>>>>>        Set peAnchors to anBottomRight
77457>>>>>>>
77457>>>>>>>        Procedure OnClick
77460>>>>>>>            Send OK of oSelList
77461>>>>>>>        End_Procedure
77462>>>>>>>
77462>>>>>>>    End_Object 
77463>>>>>>>
77463>>>>>>>    Object oCancel_bn is a Button
77465>>>>>>>        Set Label to "&Cancel"
77466>>>>>>>        Set Location to 115 176
77467>>>>>>>        Set peAnchors to anBottomRight
77468>>>>>>>
77468>>>>>>>        Procedure OnClick
77471>>>>>>>            Send Cancel of oSelList
77472>>>>>>>        End_Procedure
77473>>>>>>>
77473>>>>>>>    End_Object 
77474>>>>>>>
77474>>>>>>>    Object oSearch_bn is a Button
77476>>>>>>>        Set Label to "&Search..."
77477>>>>>>>        Set Location to 115 230
77478>>>>>>>        Set peAnchors to anBottomRight
77479>>>>>>>
77479>>>>>>>        Procedure OnClick
77482>>>>>>>            Send Search of oSelList
77483>>>>>>>        End_Procedure
77484>>>>>>>
77484>>>>>>>    End_Object 
77485>>>>>>>
77485>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77486>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77487>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77488>>>>>>>
77488>>>>>>>
77488>>>>>>>CD_End_Object // Sofor_sl
77490>>>>>>>>
77490>>>
77490>>>ACTIVATE_VIEW Activate_oSoforEntry FOR oSoforEntry
77500>>>>
77500>>>Object oSoforEntry is a dbView
77502>>>    Set Location to 5 5
77503>>>    Set Size to 38 236
77504>>>    Set Label to "Sof‹r"
77505>>>    Set Border_Style to Border_Thick
77506>>>
77506>>>
77506>>>    Object oSofor_DD is a cSoforDataDictionary
77508>>>    End_Object 
77509>>>
77509>>>    Set Main_DD To oSofor_DD
77510>>>    Set Server  To oSofor_DD
77511>>>
77511>>>
77511>>>
77511>>>    Object oSoforsofor_nev is a dbForm
77513>>>        Entry_Item Sofor.sofor_nev
77514>>>        Set Size to 13 186
77515>>>        Set Location to 5 45
77516>>>        Set peAnchors to anTopLeftRight
77517>>>        Set Label to "Sof‹r neve"
77518>>>        Set Label_Justification_mode to jMode_Left
77519>>>        Set Label_Col_Offset to 40
77520>>>        Set Label_row_Offset to 0
77521>>>    End_Object 
77522>>>
77522>>>    Object oSoforsofor_szigsz is a dbForm
77524>>>        Entry_Item Sofor.sofor_szigsz
77525>>>        Set Size to 13 78
77526>>>        Set Location to 20 45
77527>>>        Set peAnchors to anTopLeftRight
77528>>>        Set Label to "Szigsz."
77529>>>        Set Label_Justification_mode to jMode_Left
77530>>>        Set Label_Col_Offset to 40
77531>>>        Set Label_row_Offset to 0
77532>>>    End_Object 
77533>>>
77533>>>
77533>>>End_Object 
77534>        Use TermekEntry.vw
Including file: TermekEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\TermekEntry.vw)
77534>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\TermekEntry.vw
77534>>>// Term‚k
77534>>>//
77534>>>
77534>>>Use DFClient.pkg
77534>>>Use DFEntry.pkg
77534>>>Use Dfcentry.PKG
77534>>>
77534>>>Use cTermekDataDictionary.dd
Including file: cTermekDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cTermekDataDictionary.dd)
77534>>>>>Use DataDict.pkg
77534>>>>>
77534>>>>>Open Termek
Including file: Termek.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\Termek.fd)
77536>>>>>Open FuvarlevelTetel
Including file: FuvarlevelTetel.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\FuvarlevelTetel.fd)
77538>>>>>Open system_table
77540>>>>>
77540>>>>>Register_Object Termek_sl
77540>>>>>
77540>>>>>Class cTermekDataDictionary is a DataDictionary
77541>>>>>    
77541>>>>>    Procedure Construct_Object
77543>>>>>        Forward Send Construct_Object
77545>>>>>        Set Main_File to Termek.File_Number
77546>>>>>
77546>>>>>        Set Add_Client_File to FuvarlevelTetel.File_Number
77547>>>>>
77547>>>>>        Set Add_System_File to system_table.File_Number DD_Lock_On_All
77548>>>>>
77548>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77549>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77550>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77551>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77552>>>>>
77552>>>>>        Set Field_Option Field Termek.termek_azonosito DD_AUTOFIND to True
77553>>>>>        Set Field_Auto_Increment Field Termek.termek_azonosito to File_Field system_table.termek_azonosito
77554>>>>>        Set Key_Field_State Field Termek.termek_azonosito to True
77555>>>>>        Set Field_Prompt_Object Field Termek.termek_azonosito to Termek_sl
77556>>>>>
77556>>>>>        Set Field_Label_Long Field Termek.termek_megnevezes to "N‚v"
77557>>>>>        Set Field_Label_Short Field Termek.termek_megnevezes to "N‚v"
77558>>>>>        Set Field_Prompt_Object Field Termek.termek_megnevezes to Termek_sl
77559>>>>>
77559>>>>>        Set Field_Label_Long Field Termek.termek_egysegar to "Egys‚g r (Ft)"
77560>>>>>        Set Field_Label_Short Field Termek.termek_egysegar to "µr (Ft)"
77561>>>>>
77561>>>>>    End_Procedure
77562>>>>>
77562>>>>>End_Class
77563>>>>>
77563>>>>>Use Termek.sl
Including file: Termek.sl    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\Termek.sl)
77563>>>>>>>// Termek.sl
77563>>>>>>>// Term‚k lista
77563>>>>>>>
77563>>>>>>>Use DFClient.pkg
77563>>>>>>>Use cDbCJGridPromptList.pkg
77563>>>>>>>Use cDbCJGridColumn.pkg
77563>>>>>>>Use Windows.pkg
77563>>>>>>>
77563>>>>>>>Use cTermekDataDictionary.dd
77563>>>>>>>
77563>>>>>>>CD_Popup_Object Termek_sl is a dbModalPanel
77581>>>>>>>>
77581>>>>>>>    Set Location to 5 5
77582>>>>>>>    Set Size to 134 242
77583>>>>>>>    Set Label To "Term‚k lista"
77584>>>>>>>    Set Border_Style to Border_Thick
77585>>>>>>>    Set Minimize_Icon to False
77586>>>>>>>
77586>>>>>>>
77586>>>>>>>    Object oTermek_DD is a cTermekDataDictionary
77588>>>>>>>    End_Object 
77589>>>>>>>
77589>>>>>>>    Set Main_DD To oTermek_DD
77590>>>>>>>    Set Server  To oTermek_DD
77591>>>>>>>
77591>>>>>>>
77591>>>>>>>
77591>>>>>>>    Object oSelList is a cDbCJGridPromptList
77593>>>>>>>        Set Size to 105 232
77594>>>>>>>        Set Location to 5 5
77595>>>>>>>        Set peAnchors to anAll
77596>>>>>>>        Set psLayoutSection to "Termek_sl_oSelList"
77597>>>>>>>        Set Ordering to 1
77598>>>>>>>        Set pbAutoServer to True
77599>>>>>>>
77599>>>>>>>        Object oTermek_termek_azonosito is a cDbCJGridColumn
77601>>>>>>>            Entry_Item Termek.termek_azonosito
77602>>>>>>>            Set piWidth to 72
77603>>>>>>>            Set psCaption to "Id"
77604>>>>>>>        End_Object 
77605>>>>>>>
77605>>>>>>>        Object oTermek_termek_megnevezes is a cDbCJGridColumn
77607>>>>>>>            Entry_Item Termek.termek_megnevezes
77608>>>>>>>            Set piWidth to 300
77609>>>>>>>            Set psCaption to "N‚v"
77610>>>>>>>        End_Object 
77611>>>>>>>
77611>>>>>>>        Object oTermek_termek_egysegar is a cDbCJGridColumn
77613>>>>>>>            Entry_Item Termek.termek_egysegar
77614>>>>>>>            Set piWidth to 72
77615>>>>>>>            Set psCaption to "µr (Ft)"
77616>>>>>>>        End_Object 
77617>>>>>>>
77617>>>>>>>
77617>>>>>>>    End_Object 
77618>>>>>>>
77618>>>>>>>    Object oOk_bn is a Button
77620>>>>>>>        Set Label to "&Ok"
77621>>>>>>>        Set Location to 115 79
77622>>>>>>>        Set peAnchors to anBottomRight
77623>>>>>>>
77623>>>>>>>        Procedure OnClick
77626>>>>>>>            Send OK of oSelList
77627>>>>>>>        End_Procedure
77628>>>>>>>
77628>>>>>>>    End_Object 
77629>>>>>>>
77629>>>>>>>    Object oCancel_bn is a Button
77631>>>>>>>        Set Label to "&Cancel"
77632>>>>>>>        Set Location to 115 133
77633>>>>>>>        Set peAnchors to anBottomRight
77634>>>>>>>
77634>>>>>>>        Procedure OnClick
77637>>>>>>>            Send Cancel of oSelList
77638>>>>>>>        End_Procedure
77639>>>>>>>
77639>>>>>>>    End_Object 
77640>>>>>>>
77640>>>>>>>    Object oSearch_bn is a Button
77642>>>>>>>        Set Label to "&Search..."
77643>>>>>>>        Set Location to 115 187
77644>>>>>>>        Set peAnchors to anBottomRight
77645>>>>>>>
77645>>>>>>>        Procedure OnClick
77648>>>>>>>            Send Search of oSelList
77649>>>>>>>        End_Procedure
77650>>>>>>>
77650>>>>>>>    End_Object 
77651>>>>>>>
77651>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77652>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77653>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77654>>>>>>>
77654>>>>>>>
77654>>>>>>>CD_End_Object // Termek_sl
77656>>>>>>>>
77656>>>
77656>>>ACTIVATE_VIEW Activate_oTermekEntry FOR oTermekEntry
77666>>>>
77666>>>Object oTermekEntry is a dbView
77668>>>    Set Location to 5 5
77669>>>    Set Size to 38 241
77670>>>    Set Label To "Term‚k"
77671>>>    Set Border_Style to Border_Thick
77672>>>
77672>>>
77672>>>    Object oTermek_DD is a cTermekDataDictionary
77674>>>    End_Object 
77675>>>
77675>>>    Set Main_DD To oTermek_DD
77676>>>    Set Server  To oTermek_DD
77677>>>
77677>>>
77677>>>
77677>>>    Object oTermektermek_megnevezes is a dbForm
77679>>>        Entry_Item Termek.termek_megnevezes
77680>>>        Set Size to 13 186
77681>>>        Set Location to 5 50
77682>>>        Set peAnchors to anTopLeftRight
77683>>>        Set Label to "N‚v"
77684>>>        Set Label_Justification_mode to jMode_Left
77685>>>        Set Label_Col_Offset to 45
77686>>>        Set Label_row_Offset to 0
77687>>>    End_Object 
77688>>>
77688>>>    Object oTermektermek_egysegar is a dbForm
77690>>>        Entry_Item Termek.termek_egysegar
77691>>>        Set Size to 13 42
77692>>>        Set Location to 20 50
77693>>>        Set peAnchors to anTopLeftRight
77694>>>        Set Label to "Egys‚g r (Ft)"
77695>>>        Set Label_Justification_mode to jMode_Left
77696>>>        Set Label_Col_Offset to 45
77697>>>        Set Label_row_Offset to 0
77698>>>    End_Object 
77699>>>
77699>>>
77699>>>End_Object 
77700>        Use FuvarlevelEntry.vw
Including file: FuvarlevelEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\FuvarlevelEntry.vw)
77700>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\FuvarlevelEntry.vw
77700>>>// Fuvarlev‚l
77700>>>//
77700>>>
77700>>>Use DFClient.pkg
77700>>>Use DFEntry.pkg
77700>>>Use cDbCJGrid.pkg
77700>>>Use cDbCJGridColumn.pkg
77700>>>
77700>>>Use cTermekDataDictionary.dd
77700>>>Use cSoforDataDictionary.dd
77700>>>Use cAutoDataDictionary.dd
77700>>>Use cFuvarlevelDataDictionary.dd
Including file: cFuvarlevelDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cFuvarlevelDataDictionary.dd)
77700>>>>>Use DataDict.pkg
77700>>>>>
77700>>>>>Open Fuvarlevel
77702>>>>>Open FuvarlevelTetel
77704>>>>>Open Sofor
77706>>>>>Open Auto
77708>>>>>Open system_table
77710>>>>>
77710>>>>>Register_Object Auto_sl
77710>>>>>Register_Object Sofor_sl
77710>>>>>Register_Object Fuvarlevel_sl
77710>>>>>
77710>>>>>Class cFuvarlevelDataDictionary is a DataDictionary
77711>>>>>    
77711>>>>>    Procedure Construct_Object
77713>>>>>        Forward Send Construct_Object
77715>>>>>        Set Main_File to Fuvarlevel.File_Number
77716>>>>>
77716>>>>>        Set Add_Server_File to Auto.File_Number
77717>>>>>        Set Add_Server_File to Sofor.File_Number
77718>>>>>
77718>>>>>        Set Add_System_File to system_table.File_Number DD_Lock_On_All
77719>>>>>
77719>>>>>        Set Add_Client_File to FuvarlevelTetel.File_Number
77720>>>>>
77720>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77721>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77722>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77723>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77724>>>>>
77724>>>>>        Set Field_Auto_Increment Field Fuvarlevel.fuvarl_azonosito to File_Field system_table.fuvarl_azonosito
77725>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_azonosito DD_AUTOFIND to True
77726>>>>>        Set Key_Field_State Field Fuvarlevel.fuvarl_azonosito to True
77727>>>>>        Set Field_Prompt_Object Field Fuvarlevel.fuvarl_azonosito to Fuvarlevel_sl
77728>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_auto_rendszam to "Rendsz m"
77729>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_auto_rendszam DD_AUTOFIND to True
77730>>>>>        Set Field_Prompt_Object Field Fuvarlevel.fuvarl_auto_rendszam to Auto_sl
77731>>>>>
77731>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_sofor_azonosito DD_REQUIRED to True
77732>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_sofor_azonosito to "Sof‹r"
77733>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_sofor_azonosito DD_AUTOFIND to True
77734>>>>>        Set Field_Prompt_Object Field Fuvarlevel.fuvarl_sofor_azonosito to Sofor_sl
77735>>>>>
77735>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_munkaido_menyiseg DD_REQUIRED to True
77736>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_munkaido_menyiseg to "Munkaid‹ (¢ra)"
77737>>>>>
77737>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_datum DD_REQUIRED to True
77738>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_datum to "Teljes¡t‚s d tuma"
77739>>>>>        Set Field_Label_Short Field Fuvarlevel.fuvarl_datum to "D tum"
77740>>>>>        Set Field_Value_Range Field Fuvarlevel.fuvarl_datum to 01/01/2015 12/31/2017
77741>>>>>        Set Field_Mask Field Fuvarlevel.fuvarl_datum to "####.##.##"
77742>>>>>        Set Field_Mask_Type Field Fuvarlevel.fuvarl_datum to Mask_Window
77743>>>>>
77743>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_uzemanyag_mennyiseg DD_REQUIRED to True
77744>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_uzemanyag_mennyiseg to "šzemanyag (liter)"
77745>>>>>        Set Field_Label_Short Field Fuvarlevel.fuvarl_uzemanyag_mennyiseg to "šzemanyag (l)"
77746>>>>>
77746>>>>>        Set Field_Option Field Fuvarlevel.fuvarl_uzemanyag_egysegar DD_REQUIRED to True
77747>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_uzemanyag_egysegar to "šzemanyag egys‚g r"
77748>>>>>        Set Field_Label_Short Field Fuvarlevel.fuvarl_uzemanyag_egysegar to "ša. e r."
77749>>>>>
77749>>>>>        Set Field_Label_Long Field Fuvarlevel.fuvarl_teljesitett_km to "Teljes¡tett kil¢m‚ter"
77750>>>>>        Set Field_Label_Short Field Fuvarlevel.fuvarl_teljesitett_km to "Kil¢m‚ter"
77751>>>>>
77751>>>>>    End_Procedure
77752>>>>>
77752>>>>>End_Class
77753>>>>>
77753>>>>>Use Fuvarlevel.sl
Including file: Fuvarlevel.sl    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\Fuvarlevel.sl)
77753>>>>>>>// Fuvarlevel.sl
77753>>>>>>>// Fuvarlev‚l lista
77753>>>>>>>
77753>>>>>>>Use DFClient.pkg
77753>>>>>>>Use cDbCJGridPromptList.pkg
77753>>>>>>>Use cDbCJGridColumn.pkg
77753>>>>>>>Use Windows.pkg
77753>>>>>>>
77753>>>>>>>Use cSoforDataDictionary.dd
77753>>>>>>>Use cAutoDataDictionary.dd
77753>>>>>>>Use cFuvarlevelDataDictionary.dd
77753>>>>>>>
77753>>>>>>>CD_Popup_Object Fuvarlevel_sl is a dbModalPanel
77771>>>>>>>>
77771>>>>>>>    Set Location to 5 5
77772>>>>>>>    Set Size to 134 482
77773>>>>>>>    Set Label To "Fuvarlev‚l lista"
77774>>>>>>>    Set Border_Style to Border_Thick
77775>>>>>>>    Set Minimize_Icon to False
77776>>>>>>>
77776>>>>>>>
77776>>>>>>>    Object oSofor_DD is a cSoforDataDictionary
77778>>>>>>>    End_Object 
77779>>>>>>>
77779>>>>>>>    Object oAuto_DD is a cAutoDataDictionary
77781>>>>>>>    End_Object 
77782>>>>>>>
77782>>>>>>>    Object oFuvarlevel_DD is a cFuvarlevelDataDictionary
77784>>>>>>>        Set DDO_Server To oAuto_DD
77785>>>>>>>        Set DDO_Server To oSofor_DD
77786>>>>>>>    End_Object 
77787>>>>>>>
77787>>>>>>>    Set Main_DD To oFuvarlevel_DD
77788>>>>>>>    Set Server  To oFuvarlevel_DD
77789>>>>>>>
77789>>>>>>>
77789>>>>>>>
77789>>>>>>>    Object oSelList is a cDbCJGridPromptList
77791>>>>>>>        Set Size to 105 472
77792>>>>>>>        Set Location to 5 5
77793>>>>>>>        Set peAnchors to anAll
77794>>>>>>>        Set psLayoutSection to "Fuvarlevel_sl_oSelList"
77795>>>>>>>        Set Ordering to 1
77796>>>>>>>        Set pbAutoServer to True
77797>>>>>>>
77797>>>>>>>        Object oFuvarlevel_fuvarl_azonosito is a cDbCJGridColumn
77799>>>>>>>            Entry_Item Fuvarlevel.fuvarl_azonosito
77800>>>>>>>            Set piWidth to 120
77801>>>>>>>            Set psCaption to "Id"
77802>>>>>>>        End_Object 
77803>>>>>>>
77803>>>>>>>        Object oFuvarlevel_fuvarl_datum is a cDbCJGridColumn
77805>>>>>>>            Entry_Item Fuvarlevel.fuvarl_datum
77806>>>>>>>            Set piWidth to 120
77807>>>>>>>            Set psCaption to "D tum"
77808>>>>>>>        End_Object 
77809>>>>>>>
77809>>>>>>>        Object oSofor_sofor_nev is a cDbCJGridColumn
77811>>>>>>>            Entry_Item Sofor.sofor_nev
77812>>>>>>>            Set piWidth to 300
77813>>>>>>>            Set psCaption to "N‚v"
77814>>>>>>>        End_Object 
77815>>>>>>>
77815>>>>>>>        Object oAuto_auto_tipus is a cDbCJGridColumn
77817>>>>>>>            Entry_Item Auto.auto_tipus
77818>>>>>>>            Set piWidth to 300
77819>>>>>>>            Set psCaption to "Aut¢ t¡pus"
77820>>>>>>>        End_Object 
77821>>>>>>>
77821>>>>>>>        Object oFuvarlevel_fuvarl_teljesitett_km is a cDbCJGridColumn
77823>>>>>>>            Entry_Item Fuvarlevel.fuvarl_teljesitett_km
77824>>>>>>>            Set piWidth to 84
77825>>>>>>>            Set psCaption to "Kil¢m‚ter"
77826>>>>>>>        End_Object 
77827>>>>>>>
77827>>>>>>>
77827>>>>>>>    End_Object 
77828>>>>>>>
77828>>>>>>>    Object oOk_bn is a Button
77830>>>>>>>        Set Label to "&Ok"
77831>>>>>>>        Set Location to 115 319
77832>>>>>>>        Set peAnchors to anBottomRight
77833>>>>>>>
77833>>>>>>>        Procedure OnClick
77836>>>>>>>            Send OK of oSelList
77837>>>>>>>        End_Procedure
77838>>>>>>>
77838>>>>>>>    End_Object 
77839>>>>>>>
77839>>>>>>>    Object oCancel_bn is a Button
77841>>>>>>>        Set Label to "&Cancel"
77842>>>>>>>        Set Location to 115 373
77843>>>>>>>        Set peAnchors to anBottomRight
77844>>>>>>>
77844>>>>>>>        Procedure OnClick
77847>>>>>>>            Send Cancel of oSelList
77848>>>>>>>        End_Procedure
77849>>>>>>>
77849>>>>>>>    End_Object 
77850>>>>>>>
77850>>>>>>>    Object oSearch_bn is a Button
77852>>>>>>>        Set Label to "&Search..."
77853>>>>>>>        Set Location to 115 427
77854>>>>>>>        Set peAnchors to anBottomRight
77855>>>>>>>
77855>>>>>>>        Procedure OnClick
77858>>>>>>>            Send Search of oSelList
77859>>>>>>>        End_Procedure
77860>>>>>>>
77860>>>>>>>    End_Object 
77861>>>>>>>
77861>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
77862>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77863>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
77864>>>>>>>
77864>>>>>>>
77864>>>>>>>CD_End_Object // Fuvarlevel_sl
77866>>>>>>>>
77866>>>>>Use Sofor.sl
77866>>>>>Use Auto.sl
77866>>>Use cFuvarlevelTetelDataDictionary.dd
Including file: cFuvarlevelTetelDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cFuvarlevelTetelDataDictionary.dd)
77866>>>>>Use DataDict.pkg
77866>>>>>
77866>>>>>Open FuvarlevelTetel
77868>>>>>Open Fuvarlevel
77870>>>>>Open system_table
77872>>>>>Open Termek
77874>>>>>
77874>>>>>Register_Object Fuvarlevel_sl
77874>>>>>Register_Object Termek_sl
77874>>>>>
77874>>>>>Class cFuvarlevelTetelDataDictionary is a DataDictionary
77875>>>>>    
77875>>>>>    Procedure Construct_Object
77877>>>>>        Forward Send Construct_Object
77879>>>>>        Set Main_File to FuvarlevelTetel.File_Number
77880>>>>>
77880>>>>>        Set Add_System_File to system_table.File_Number DD_Lock_On_All
77881>>>>>
77881>>>>>        Set Add_Server_File to Fuvarlevel.File_Number
77882>>>>>        Set Add_Server_File to Termek.File_Number
77883>>>>>
77883>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77884>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77885>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77886>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77887>>>>>
77887>>>>>        Set Key_Field_State Field FuvarlevelTetel.fuvarl_tetel_azonosito to True
77888>>>>>        Set Field_Auto_Increment Field FuvarlevelTetel.fuvarl_tetel_azonosito to File_Field system_table.fuvarl_tetel_azonosito
77889>>>>>
77889>>>>>        Set Field_Label_Long Field FuvarlevelTetel.fuvarl_tetel_fuvarl_azonosito to "Fuvarlev‚l"
77890>>>>>        Set Field_Label_Short Field FuvarlevelTetel.fuvarl_tetel_fuvarl_azonosito to "Fuvarl."
77891>>>>>        Set Field_Prompt_Object Field FuvarlevelTetel.fuvarl_tetel_fuvarl_azonosito to Fuvarlevel_sl
77892>>>>>        Set Field_Option Field FuvarlevelTetel.fuvarl_tetel_fuvarl_azonosito DD_AUTOFIND to True
77893>>>>>
77893>>>>>        Set Field_Label_Long Field FuvarlevelTetel.fuvarl_tetel_termek_azonosito to "Term‚k"
77894>>>>>        Set Field_Label_Short Field FuvarlevelTetel.fuvarl_tetel_termek_azonosito to "Term‚k"
77895>>>>>        Set Field_Prompt_Object Field FuvarlevelTetel.fuvarl_tetel_termek_azonosito to Termek_sl
77896>>>>>        Set Field_Option Field FuvarlevelTetel.fuvarl_tetel_termek_azonosito DD_AUTOFIND to True
77897>>>>>
77897>>>>>        Set Field_Label_Long Field FuvarlevelTetel.fuvarl_tetel_termek_mennyiseg to "Mennyis‚g"
77898>>>>>        Set Field_Label_Short Field FuvarlevelTetel.fuvarl_tetel_termek_mennyiseg to "Mennyis‚g"
77899>>>>>
77899>>>>>    End_Procedure
77900>>>>>
77900>>>>>End_Class
77901>>>>>
77901>>>>>Use Termek.sl
77901>>>>>Use Fuvarlevel.sl
77901>>>
77901>>>ACTIVATE_VIEW Activate_oFuvarlevelEntry FOR oFuvarlevelEntry
77911>>>>
77911>>>Object oFuvarlevelEntry is a dbView
77913>>>    Set Location to 5 5
77914>>>    Set Size to 222 522
77915>>>    Set Label To "Fuvarlev‚l"
77916>>>    Set Border_Style to Border_Thick
77917>>>
77917>>>
77917>>>    Object oTermek_DD is a cTermekDataDictionary
77919>>>    End_Object 
77920>>>
77920>>>    Object oSofor_DD is a cSoforDataDictionary
77922>>>    End_Object 
77923>>>
77923>>>    Object oAuto_DD is a cAutoDataDictionary
77925>>>    End_Object 
77926>>>
77926>>>    Object oFuvarlevel_DD is a cFuvarlevelDataDictionary
77928>>>        Set DDO_Server To oAuto_DD
77929>>>        Set DDO_Server To oSofor_DD
77930>>>        // this lets you save a new parent DD from within child DD
77930>>>        Set Allow_Foreign_New_Save_State to True
77931>>>    End_Object 
77932>>>
77932>>>    Object oFuvarlevelTetel_DD is a cFuvarlevelTetelDataDictionary
77934>>>        Set DDO_Server To oFuvarlevel_DD
77935>>>        Set DDO_Server To oTermek_DD
77936>>>        Set Constrain_File To Fuvarlevel.File_Number
77937>>>    End_Object 
77938>>>
77938>>>    Set Main_DD To oFuvarlevel_DD
77939>>>    Set Server  To oFuvarlevel_DD
77940>>>
77940>>>
77940>>>
77940>>>    Object oFuvarlevelfuvarl_azonosito is a dbForm
77942>>>        Entry_Item Fuvarlevel.fuvarl_azonosito
77943>>>        Set Size to 13 127
77944>>>        Set Location to 5 78
77945>>>        Set peAnchors to anTopLeftRight
77946>>>        Set Label to "fuvarl azonosito"
77947>>>        Set Label_Justification_mode to jMode_Left
77948>>>        Set Label_Col_Offset to 73
77949>>>        Set Label_row_Offset to 0
77950>>>    End_Object 
77951>>>
77951>>>    Object oFuvarlevelfuvarl_datum is a dbForm
77953>>>        Entry_Item Fuvarlevel.fuvarl_datum
77954>>>        Set Size to 13 128
77955>>>        Set Location to 20 78
77956>>>        Set peAnchors to anTopLeftRight
77957>>>        Set Label to "Teljes¡t‚s d tuma"
77958>>>        Set Label_Justification_mode to jMode_Left
77959>>>        Set Label_Col_Offset to 73
77960>>>        Set Label_row_Offset to 0
77961>>>    End_Object 
77962>>>
77962>>>    Object oSoforsofor_azonosito is a dbForm
77964>>>        Entry_Item Sofor.sofor_azonosito
77965>>>        Set Size to 13 127
77966>>>        Set Location to 35 78
77967>>>        Set peAnchors to anTopLeftRight
77968>>>        Set Label to "Sof‹r"
77969>>>        Set Label_Justification_mode to jMode_Left
77970>>>        Set Label_Col_Offset to 73
77971>>>        Set Label_row_Offset to 0
77972>>>    End_Object 
77973>>>
77973>>>    Object oFuvarlevelfuvarl_munkaido_menyiseg is a dbForm
77975>>>        Entry_Item Fuvarlevel.fuvarl_munkaido_menyiseg
77976>>>        Set Size to 13 129
77977>>>        Set Location to 50 78
77978>>>        Set peAnchors to anTopLeftRight
77979>>>        Set Label to "Munkaid‹ (¢ra)"
77980>>>        Set Label_Justification_mode to jMode_Left
77981>>>        Set Label_Col_Offset to 73
77982>>>        Set Label_row_Offset to 0
77983>>>    End_Object 
77984>>>
77984>>>    Object oAutoauto_rendszam is a dbForm
77986>>>        Entry_Item Auto.auto_rendszam
77987>>>        Set Size to 13 129
77988>>>        Set Location to 65 78
77989>>>        Set peAnchors to anTopLeftRight
77990>>>        Set Label to "Rendsz m"
77991>>>        Set Label_Justification_mode to jMode_Left
77992>>>        Set Label_Col_Offset to 73
77993>>>        Set Label_row_Offset to 0
77994>>>    End_Object 
77995>>>
77995>>>    Object oFuvarlevelfuvarl_teljesitett_km is a dbForm
77997>>>        Entry_Item Fuvarlevel.fuvarl_teljesitett_km
77998>>>        Set Size to 13 130
77999>>>        Set Location to 80 78
78000>>>        Set peAnchors to anTopLeftRight
78001>>>        Set Label to "Teljes¡tett kil¢m‚ter"
78002>>>        Set Label_Justification_mode to jMode_Left
78003>>>        Set Label_Col_Offset to 73
78004>>>        Set Label_row_Offset to 0
78005>>>    End_Object 
78006>>>
78006>>>    Object oFuvarlevelfuvarl_uzemanyag_mennyiseg is a dbForm
78008>>>        Entry_Item Fuvarlevel.fuvarl_uzemanyag_mennyiseg
78009>>>        Set Size to 13 131
78010>>>        Set Location to 95 78
78011>>>        Set peAnchors to anTopLeftRight
78012>>>        Set Label to "šzemanyag (liter)"
78013>>>        Set Label_Justification_mode to jMode_Left
78014>>>        Set Label_Col_Offset to 73
78015>>>        Set Label_row_Offset to 0
78016>>>    End_Object 
78017>>>
78017>>>    Object oFuvarlevelfuvarl_uzemanyag_egysegar is a dbForm
78019>>>        Entry_Item Fuvarlevel.fuvarl_uzemanyag_egysegar
78020>>>        Set Size to 13 131
78021>>>        Set Location to 110 78
78022>>>        Set peAnchors to anTopLeftRight
78023>>>        Set Label to "šzemanyag egys‚g r"
78024>>>        Set Label_Justification_mode to jMode_Left
78025>>>        Set Label_Col_Offset to 73
78026>>>        Set Label_row_Offset to 0
78027>>>    End_Object 
78028>>>
78028>>>    Object oDetailGrid is a cDbCJGrid
78030>>>        Set Size to 84 464
78031>>>        Set Location to 133 5
78032>>>        Set Server to oFuvarlevelTetel_DD
78033>>>        Set Ordering to 5
78034>>>        Set peAnchors to anAll
78035>>>        Set psLayoutSection to "oFuvarlevelEntry_oDetailGrid"
78036>>>        Set pbAllowInsertRow to False
78037>>>        Set pbHeaderPrompts to True
78038>>>
78038>>>        Object oTermek_termek_azonosito is a cDbCJGridColumn
78040>>>            Entry_Item Termek.termek_azonosito
78041>>>            Set piWidth to 412
78042>>>            Set psCaption to "Term‚k"
78043>>>        End_Object 
78044>>>
78044>>>        Object oFuvarlevelTetel_fuvarl_tetel_termek_mennyiseg is a cDbCJGridColumn
78046>>>            Entry_Item FuvarlevelTetel.fuvarl_tetel_termek_mennyiseg
78047>>>            Set piWidth to 516
78048>>>            Set psCaption to "Mennyis‚g"
78049>>>        End_Object 
78050>>>
78050>>>    End_Object 
78051>>>
78051>>>    //-----------------------------------------------------------------------
78051>>>    // Create custom confirmation messages for save and delete
78051>>>    // We must create the new functions and assign verify messages
78051>>>    // to them.
78051>>>    //-----------------------------------------------------------------------
78051>>>
78051>>>    Function ConfirmDeleteHeader Returns Boolean
78054>>>        Boolean bFail
78054>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
78055>>>        Function_Return bFail
78056>>>    End_Function 
78057>>>
78057>>>    // Only confirm on the saving of new records
78057>>>    Function ConfirmSaveHeader Returns Boolean
78060>>>        Boolean bNoSave bHasRecord
78060>>>        Handle  hoSrvr
78060>>>        Get Server to hoSrvr
78061>>>        Get HasRecord of hoSrvr to bHasRecord
78062>>>        If not bHasRecord Begin
78064>>>            Get Confirm "Save this NEW header?" to bNoSave
78065>>>        End
78065>>>>
78065>>>        Function_Return bNoSave
78066>>>    End_Function 
78067>>>
78067>>>    // Define alternate confirmation Messages
78067>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
78068>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
78069>>>    // Saves in header should not clear the view
78069>>>    Set Auto_Clear_Deo_State to False
78070>>>
78070>>>
78070>>>End_Object 
78071>        Use FuvarlevelTetelEntry.vw
Including file: FuvarlevelTetelEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\FuvarlevelTetelEntry.vw)
78071>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\FuvarlevelTetelEntry.vw
78071>>>// Fuvarlev‚l t‚tel
78071>>>//
78071>>>
78071>>>Use DFClient.pkg
78071>>>Use DFEntry.pkg
78071>>>
78071>>>Use cTermekDataDictionary.dd
78071>>>Use cSoforDataDictionary.dd
78071>>>Use cAutoDataDictionary.dd
78071>>>Use cFuvarlevelDataDictionary.dd
78071>>>Use cFuvarlevelTetelDataDictionary.dd
78071>>>
78071>>>ACTIVATE_VIEW Activate_oFuvarlevelTetelEntry FOR oFuvarlevelTetelEntry
78081>>>>
78081>>>Object oFuvarlevelTetelEntry is a dbView
78083>>>    Set Location to 5 5
78084>>>    Set Size to 66 288
78085>>>    Set Label To "Fuvarlev‚l t‚tel"
78086>>>    Set Border_Style to Border_Thick
78087>>>
78087>>>
78087>>>    Object oTermek_DD is a cTermekDataDictionary
78089>>>    End_Object 
78090>>>
78090>>>    Object oSofor_DD is a cSoforDataDictionary
78092>>>    End_Object 
78093>>>
78093>>>    Object oAuto_DD is a cAutoDataDictionary
78095>>>    End_Object 
78096>>>
78096>>>    Object oFuvarlevel_DD is a cFuvarlevelDataDictionary
78098>>>        Set DDO_Server To oAuto_DD
78099>>>        Set DDO_Server To oSofor_DD
78100>>>    End_Object 
78101>>>
78101>>>    Object oFuvarlevelTetel_DD is a cFuvarlevelTetelDataDictionary
78103>>>        Set DDO_Server To oFuvarlevel_DD
78104>>>        Set DDO_Server To oTermek_DD
78105>>>    End_Object 
78106>>>
78106>>>    Set Main_DD To oFuvarlevelTetel_DD
78107>>>    Set Server  To oFuvarlevelTetel_DD
78108>>>
78108>>>
78108>>>
78108>>>    Object oFuvarlevelfuvarl_azonosito is a dbForm
78110>>>        Entry_Item Fuvarlevel.fuvarl_azonosito
78111>>>        Set Size to 13 241
78112>>>        Set Location to 5 42
78113>>>        Set peAnchors to anTopLeftRight
78114>>>        Set Label to "Fuvarlev‚l"
78115>>>        Set Label_Justification_mode to jMode_Left
78116>>>        Set Label_Col_Offset to 37
78117>>>        Set Label_row_Offset to 0
78118>>>    End_Object 
78119>>>
78119>>>    Object oTermektermek_azonosito is a dbForm
78121>>>        Entry_Item Termek.termek_azonosito
78122>>>        Set Size to 13 217
78123>>>        Set Location to 20 42
78124>>>        Set peAnchors to anTopLeftRight
78125>>>        Set Label to "Term‚k"
78126>>>        Set Label_Justification_mode to jMode_Left
78127>>>        Set Label_Col_Offset to 37
78128>>>        Set Label_row_Offset to 0
78129>>>    End_Object 
78130>>>
78130>>>    Object oFuvarlevelTetelfuvarl_tetel_termek_mennyiseg is a dbForm
78132>>>        Entry_Item FuvarlevelTetel.fuvarl_tetel_termek_mennyiseg
78133>>>        Set Size to 13 209
78134>>>        Set Location to 35 42
78135>>>        Set peAnchors to anTopLeftRight
78136>>>        Set Label to "Mennyis‚g"
78137>>>        Set Label_Justification_mode to jMode_Left
78138>>>        Set Label_Col_Offset to 37
78139>>>        Set Label_row_Offset to 0
78140>>>    End_Object 
78141>>>
78141>>>
78141>>>End_Object 
78142>        Use SoforReport.rv
Including file: SoforReport.rv    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\SoforReport.rv)
78142>>>// SoforReport.rv
78142>>>// SoforReport
78142>>>Register_Object oReport
78142>>>
78142>>>Use DFRptVw.pkg
78142>>>Use cWinReport2.pkg
Including file: cWinReport2.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cWinReport2.pkg)
78142>>>>>// cWinReport2.pkg
78142>>>>>
78142>>>>>// defines support for new Winprint2 cWinReport2 class
78142>>>>>
78142>>>>>
78142>>>>>Use DFRpt.pkg              // BasicReport RO Class for VDF
78142>>>>>Use WinPrint2.pkg          // WinPrint2 engine
Including file: Winprint2.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\Winprint2.pkg)
78142>>>>>>>// WinPrint2.pkg
78142>>>>>>>//
78142>>>>>>>Use windows.pkg
78142>>>>>>>Use LanguageText.pkg
78142>>>>>>>Use DLL.pkg
78142>>>>>>>Use WinPrint2_Api.pkg
Including file: WinPrint2_API.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\WinPrint2_API.pkg)
78142>>>>>>>>>//WinPrint2_API.pkg
78142>>>>>>>>>
78142>>>>>>>>>Use DLL.pkg
78142>>>>>>>>>
78142>>>>>>>>>External_Function WP_IsPrinterValid "IsPrinterValid" WinPrint.dll ;Returns Boolean // True if the the current printer is a valid one. False, otherwise.
78143>>>>>>>>>
78143>>>>>>>>>External_Function WP_ArePrintersInstalled "ArePrintersInstalled" WinPrint.dll ; // determines whether at least one printer is installedReturns Boolean // True, if a printer is installed, False if it is not.
78144>>>>>>>>>
78144>>>>>>>>>External_Function WP_ExecutePrinterSetupDialog "ExecutePrinterSetupDialog" WinPrint.dll ; // displays the "printer setup" dialog   Handle hWndParent; // window handle of the parent windowReturns Boolean // True if the OK button pressed; False, otherwise.
78145>>>>>>>>>
78145>>>>>>>>>External_Function WP_ExecutePrintDialog "ExecutePrintDialog" WinPrint.dll ; // displays the "Print" dialog   Handle hWndParent; // window handle of the parent windowReturns Boolean // True if the OK button pressed; False, otherwise.
78146>>>>>>>>>
78146>>>>>>>>>External_Function WP_GetCurrentDevice "GetCurrentDevice" WinPrint.dll ; // retrieves the name of the current printer device    Address aDevice ; // address of the string (255 chars) that will hold the device name upon returnReturns Boolean // True, if success; False if error occurred
78147>>>>>>>>>
78147>>>>>>>>>External_Function WP_GetPrintDialogFlags "GetPrintDialogFlags" WinPrint.dll ; // retrieves the current print optionsReturns UInteger // array of flags representing print-related options that are currently set
78148>>>>>>>>>
78148>>>>>>>>>External_Function WP_GetUserDefinedPapersize "GetUserDefinedPapersize" WinPrint.dll ;  // gets the size of user-defined paperReturns UInteger // // hi-word=length; lo-word=width
78149>>>>>>>>>
78149>>>>>>>>>External_Function WP_IsPrintDialogFlagSet "IsPrintDialogFlagSet" WinPrint.dll ; // determines whether a specific print-flag is set    UInteger iFlag ; // the printer flagReturns Boolean // True, if the flag is set; False, if it isn't
78150>>>>>>>>>
78150>>>>>>>>>External_Function WP_SelectPrinter "SelectPrinter" WinPrint.dll ; // selects a printer programatically    String sDevice; // the name of the printerReturns Boolean // True, if success; False, if error (such as an invalid printer name)
78151>>>>>>>>>
78151>>>>>>>>>External_Function WP_SetFirstPagePaperSource "SetFirstPagePaperSource"  WinPrint.dll ;        Integer iBin ; // the bim constantReturns Boolean // True if success, false if error
78152>>>>>>>>>
78152>>>>>>>>>External_Function WP_SetNumberOfPrintCopies "SetNumberOfPrintCopies" WinPrint.dll ; // sets the number of copies to print    UInteger iNumCopies; // number of copies to makeReturns Boolean // Always True
78153>>>>>>>>>
78153>>>>>>>>>External_Function WP_SetSpecificPrintDialogFlag "SetSpecificPrintDialogFlag" WinPrint.dll; // Sets/unsets one printer flag    UInteger fFlag; // printer flagReturns Boolean // True, if success; False if error occurred
78154>>>>>>>>>
78154>>>>>>>>>External_Function WP_SetPrintDialogFlags "SetPrintDialogFlags" WinPrint.dll; // Sets/unsets all printer flags in one call    UInteger fFlags; // printer flagsReturns Boolean // True, if success; False if error occurred
78155>>>>>>>>>
78155>>>>>>>>>External_Function WP_SetUserDefinedPapersize "SetUserDefinedPapersize" WinPrint.dll ;  // sets the size of user-defined paper    UInteger iPaperSize ; // hi-word=length; lo-word=widthReturns Boolean; // True, if success; False if error occurred
78156>>>>>>>>>External_Function WP_SetFontStyle "SetFontStyle" WinPrint.dll ; // sets multiple font attributes    Integer iStyles ; // series of flagsReturns Boolean // always True
78157>>>>>>>>>
78157>>>>>>>>>External_Function WP_SetFontBold "SetFontBold" WinPrint.dll ; // toggles the bold attribute of the current font    Boolean bBold ; // True to switch bold attribute on; False to switch it offReturns Boolean // always True
78158>>>>>>>>>
78158>>>>>>>>>External_Function WP_SetFontItalic "SetFontItalic" WinPrint.dll ; // toggles the italic attribute of the current font    Boolean bItalic ; // True to switch italic attribute on; False to switch it offReturns Boolean  // always True
78159>>>>>>>>>
78159>>>>>>>>>External_Function WP_SetFontUnderline "SetFontUnderline" WinPrint.dll ; // toggles the underline attribute of the current font    Boolean bUnderline ; // True to switch underline attribute on; False to switch it offReturns Boolean  // always True
78160>>>>>>>>>
78160>>>>>>>>>External_Function WP_SetFontStrikeout "SetFontStrikeout" WinPrint.dll ; // toggles the strikeout attribute of the current font    Boolean bStrikeout ; // True to switch strikeout attribute on; False to switch it offReturns Boolean  // always True
78161>>>>>>>>>
78161>>>>>>>>>External_Function WP_SetFontColor "SetFontColor" WinPrint.dll ; // sets the color of the current font    Integer iColor ; // color of the fontReturns Boolean  // always True
78162>>>>>>>>>
78162>>>>>>>>>External_Function WP_SetFontHeight "SetFontHeight" WinPrint.dll ; // sets the height of the font    UInteger iHeight ; // height of the font in points (multiplied by 100. Eg 12.5 point should be sent as 1250)Returns Boolean  // always True
78163>>>>>>>>>
78163>>>>>>>>>External_Function WP_SetFontName "SetFontName" WinPrint.dll ; // Sets the name of the font to use    String sFontName ; // name of the font to useReturns Boolean  // always True
78164>>>>>>>>>
78164>>>>>>>>>External_Function WP_DrawBitmap "DrawBitmap" WinPrint.dll ; // Draws a bitmap (BMP, JPG)    String  sBitmap;                 // Name of the bitmap    Integer iLeft;                   // distance from left edge to draw bitmap    Integer iTop;                    // distance from top edge to draw bitmap    Integer iWidth;                  // width of the bitmap    Integer iHeight;                 // height of the bitmap    Boolean bUpdateCurrentPosition;  // after drawing, should the current position be updated?Returns Boolean // True, if OK; False, if an error occurred.
78165>>>>>>>>>
78165>>>>>>>>>External_Function WP_DrawEllipse "DrawEllipse" WinPrint.dll ; // draws an elipse within a bounding rectangle    Integer iLeft;                   // distance from left edge to draw the ellipse    Integer iTop;                    // distance from top edge to draw the ellipse    Integer iWidth;                  // width of the bounding rectangle    Integer iHeight;                 // height of the bounding rectangle    Integer iBorderColor;            // color of the ellipse's edge    Integer iFillColor;              // internal color of the ellipse    Boolean  bFill;                  // should the ellipse be filled? (False=transparent)    UInteger iThickness;             // thickness of the elipse    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the ellipse be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
78166>>>>>>>>>
78166>>>>>>>>>External_Function WP_DrawLine "DrawLine" WinPrint.dll ; // draws a line from the current position    Integer iLeft;                   // distance from left edge to draw the line    Integer iTop;                    // distance from top edge to draw the line    Integer iLength;                 // length of the line    Boolean  bHorizontal;            // draw horizontal? (False=vertical)    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?Returns Boolean // True, if OK; False, if an error occurred.
78167>>>>>>>>>
78167>>>>>>>>>External_Function WP_DrawRectangle "DrawRectangle" WinPrint.dll ; // draws a rectangle    Integer iLeft;                   // distance from left edge to draw the rectangle    Integer iTop;                    // distance from top edge to draw the rectangle    Integer iWidth;                  // width of the rectangle    Integer iHeight;                 // height of the rectangle    Integer iBorderColor;            // color of the rectangle's border    Integer iFillColor;              // internal color of the rectangle    Boolean  bFill;                  // should the rectangle be filled? (False=transparent)    UInteger iThickness;             // thickness of the rectangle's border    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the rectangle be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
78168>>>>>>>>>
78168>>>>>>>>>External_Function WP_DrawXYLine "DrawXYLine" WinPrint.dll ; // draws a line between two points    Integer iLeftStart;              // distance from left edge to draw from    Integer iTopStart;               // distance from top edge to draw from    Integer iLeftEnd;                // distance from left edge to draw to    Integer iTopEnd;                 // distance from top edge to draw to    Integer iColor;                  // color of the line    UInteger iThickness;             // thickness of the line    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?    Boolean  bWrap;                  // Should the line be drawn on future soft-page breaks?Returns Boolean // True, if OK; False, if an error occurred.
78169>>>>>>>>>
78169>>>>>>>>>External_Function WP_SetAbsoluteMargins "SetAbsoluteMargins" WinPrint.dll ; // modifies the top/bottom non-printable margin    UInteger iTop;      // the top margin offset    UInteger iBottom;   // the bottom margin offset    Boolean  bAllPages; // should all pages be affected? True=AllPages; False=first page onlyReturns Boolean // always True
78170>>>>>>>>>
78170>>>>>>>>>External_Function WP_SetMargins "SetMargins" WinPrint.dll ; // Sets the user-margins    UInteger iLeft;   // the left margin    UInteger iTop;    // the top margin    UInteger iRight;  // the right margin    UInteger iBottom; // the bottom marginReturns Boolean // always True
78171>>>>>>>>>
78171>>>>>>>>>External_Function WP_CreateDiagram "CreateDiagram" WinPrint.dll ; // Creates a new diagram    UInteger eType;       // type of diagram (Bar, Line, Pie)    UInteger eEffect;     // how it is drawn (2d or 3d, etc)    UInteger iWidth;      // width of the diagram    UInteger iHeight;     // height of the diagram    Boolean  bDrawXyAxis; // draw the xy-axis (for bar charts only)?Returns Handle // unique id for the diagram used in other diagram funtions
78172>>>>>>>>>
78172>>>>>>>>>External_Function WP_AddDiagramEntry "AddDiagramEntry" WinPrint.dll ; // Adds an item into a diagram    Handle   hDiagram;          // diagram handle returned by CreateDiagram()    String   sValueDescription; // description of the item    String   sValue;            // value of the item    Integer iBorderColor;       // color of the item's border    Integer iFillColor;         // color of the item's interior    Boolean  bFilled;           // should the item be drawn filled (with iFillColor), or transparent?    UInteger iNumDecimals;      // Number of decimals in the sValue argument    UInteger eValueOrPercent;   // How the value should be displayed (as value or percentage, etc)    Boolean  bExploded;         // should the value be "pulled out" (pie charts only)Returns Boolean // True, if success; False, if error
78173>>>>>>>>>
78173>>>>>>>>>External_Function WP_DrawDiagram "DrawDiagram" WinPrint.dll ; // draws a diagram    Handle   hDiagram;               // diagram handle returned by CreateDiagram()    UInteger iLeft;                  // x-coordinate to draw the diagram    UInteger iTop;                   // y-coordinate to draw the diagram    Boolean  bUpdateCurrentPosition; // after drawing, should the current position be updated?Returns Boolean // True, if success; False, if error
78174>>>>>>>>>
78174>>>>>>>>>External_Function WP_LockDiagram "LockDiagram" WinPrint.dll ; // Locks a diagram so that no more entries can be added    Handle hDiagram; // diagram handle returned by CreateDiagram()Returns Boolean // True, if success; False, if error
78175>>>>>>>>>
78175>>>>>>>>>External_Function WP_SetDiagramCaption "SetDiagramCaption" WinPrint.dll ; // Sets the caption of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sCaption; // the diagram's captionReturns Boolean // True, if success; False, if error
78176>>>>>>>>>
78176>>>>>>>>>External_Function WP_SetDiagramXText "SetDiagramXText" WinPrint.dll ; // Sets the horizontal label of a diagram    Handle hDiagram; // diagram handle returned by CreateDiagram()    String sText;    // the diagram's horizonal labelReturns Boolean // True, if success; False, if error
78177>>>>>>>>>
78177>>>>>>>>>External_Function WP_SetDiagramYText "SetDiagramYText" WinPrint.dll ; // Sets the vertical label of a diagram    Handle  hDiagram;      // diagram handle returned by CreateDiagram()    String  sText;         // the diagram's vertical label    Boolean bVerticalText; // should the text be drawn vertically (False=horizontally)Returns Boolean // True, if success; False, if error
78178>>>>>>>>>
78178>>>>>>>>>External_Function WP_BeginHeader "BeginHeader" WinPrint.dll ; // creates a new header    UInteger iHeaderType; // the type of header    UInteger iSubHeaderNum; // for subheaders, then number (1-0)Returns Boolean // always True
78179>>>>>>>>>
78179>>>>>>>>>External_Function WP_EndHeader "EndHeader" WinPrint.dll ; // declares the end of the current headerReturns Boolean // always True
78180>>>>>>>>>
78180>>>>>>>>>External_Function WP_SetExtraLineCheck "SetExtraLineCheck" WinPrint.dll ; // forces a soft page break if header plus number of lines don't fit on page    UInteger iNumLines; // number of lines in addition to header required before forcing a soft page-breakReturns Boolean; // always True
78181>>>>>>>>>External_Function WP_SetHeaderFrame "SetHeaderFrame" WinPrint.dll ; // sets the style, color and frame of a header    UInteger eFrame;     // style of frame (margin-to-margin, etc)    Integer iColor;      // color of the frame's edge    UInteger iThickness; // thickness of the frame    Integer iFillCol;    // the internal color of the frame (only used if bBilled=True)    Boolean  bFilled;    // True, if the frame should be filled with the iFillColor (False=Transparent)Returns Boolean // Always True
78182>>>>>>>>>
78182>>>>>>>>>External_Function WP_SetHeaderMargin "SetHeaderMargin" WinPrint.dll ; // Sets a margin of space on the inside and outside of the current header    UInteger eType;      // Specifies which margin areas is being set.    Integer  iSize;      // Size of the margin setting in the current report metricsReturns Boolean  // False if document is not started
78183>>>>>>>>>
78183>>>>>>>>>External_Function WP_SetHeaderPlacement "SetHeaderPlacement" WinPrint.dll ; // placement (left, center or right) of the header    UInteger ePlacement; // placed left, center or rightReturns Boolean //always True
78184>>>>>>>>>
78184>>>>>>>>>External_Function WP_SetHeaderWrap "SetHeaderWrap" WinPrint.dll ; // determines whether the current header is drawn on soft page-breaks    Boolean bWrap; // True, to wrap onto following pages; False, for current page onlyReturns Boolean // always True
78185>>>>>>>>>
78185>>>>>>>>>External_Function WP_WriteHeader "WriteHeader" WinPrint.dll ; // writes a header to the current page    UInteger eHeaderType;   // type of header    UInteger iSubHeaderNum; // for subheaders, the number (1-9)Returns Boolean // True, if success; False, if error
78186>>>>>>>>>
78186>>>>>>>>>External_Function WP_RGBToDFPrintColor "RGBToDFPrintColor" WinPrint.dll ; // converts R, G, and B values into a composite color that WinPrint expects    UInteger iRed;   // red component (1-255)    UInteger iGreen; // green component (1-255)    UInteger iBlue;  // blue component (1-255)Returns Integer // composite color
78187>>>>>>>>>
78187>>>>>>>>>External_Function WP_GetMetrics "GetMetrics" WinPrint.dll ; // gets the current unit of measurementReturns UInteger // unit of measurement (Inch or CM)
78188>>>>>>>>>
78188>>>>>>>>>External_Function WP_SetMetrics "SetMetrics" WinPrint.dll ; // sets the unit of measurement   UInteger eMetrics; // Inch or CMReturns Boolean // always True
78189>>>>>>>>>
78189>>>>>>>>>External_Function WP_ClearDocument "ClearDocument" WinPrint.dll ; // clears the resources of the document from memoryReturns Boolean // always True
78190>>>>>>>>>
78190>>>>>>>>>External_Function WP_NewDocument "NewDocument" WinPrint.dll ; // starts a new document, but preserves the printer settings   Boolean bAutoPreview ; // Should the Previewer be displayed immediatelyReturns Boolean // True, if success; False, if an error occurred
78191>>>>>>>>>
78191>>>>>>>>>External_Function WP_EndDocument "EndDocument" WinPrint.dll ; // Indicates that the document is finishedReturns Boolean // always True
78192>>>>>>>>>
78192>>>>>>>>>External_Function WP_ClearPrinter "ClearPrinter" WinPrint.dll ; // clears all printer and document resourcesReturns Boolean // True, if success; False, if an error occurred
78193>>>>>>>>>
78193>>>>>>>>>External_Function WP_ConfirmLines "ConfirmLines" WinPrint.dll ; // ensures that a specified number of lines will fit on the page; if not, a soft page-break is performed automatically    UInteger iNumLines; // number of lines that must fit on the pageReturns Boolean // True, if success; False, if an error occurred
78194>>>>>>>>>
78194>>>>>>>>>External_Function WP_CreatePage "CreatePage" WinPrint.dll ; // creates a new page of specified columns   UInteger iNumColumns; // number of columns (zero= no columns)Returns UInteger; // page number that was created
78195>>>>>>>>>External_Function WP_PreviewDocument "PreviewDocument" WinPrint.dll ; // previews the current document    Boolean bPrintDialog; // Determines whether the Print Dialog (range, etc) is displayed when the "print" button is clicked in the preview window.    Boolean bPrintSetup;  // Determines whether the Print Setup button is enabled (allows to change orientation, etc)    Boolean bPrint;       // Determines whether the Print button is enabledReturns Handle // non-zero = hViewerProcess; zero= error
78196>>>>>>>>>
78196>>>>>>>>>External_Function WP_ClosePreview "ClosePreview" WinPrint.dll ; // closes the preview windowReturns Boolean // True, if closed; False, if an error occurred (such as it not being already open)
78197>>>>>>>>>
78197>>>>>>>>>External_Function WP_PrintDocument "PrintDocument" WinPrint.dll ; // prints the current document    Handle hWndParent; // window handle of object to use for any modal outputReturns Boolean // True, if success; False, if an error occurred
78198>>>>>>>>>
78198>>>>>>>>>External_Function WP_SetAlign "SetAlign" WinPrint.dll ; // align future text    UInteger eAlign; // left, center or rightReturns Boolean // always True
78199>>>>>>>>>
78199>>>>>>>>>External_Function WP_WriteText "WriteText" WinPrint.dll ; // write text to the current position or column    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iColumnNum;        // number of the column to write to (zero=no column, use current position)    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncatingReturns Boolean // True, if success; False, if an error occurred
78200>>>>>>>>>
78200>>>>>>>>>External_Function WP_WriteTextAtPosition "WriteTextAtPosition" WinPrint.dll ; // writes text to a specific position    String sText;               // the text to write    Boolean bNewLineAfterPrint; // should a "CR" be written after the text    UInteger iPosition;         // horizontal position to write the text    Integer iNumDecimals;       // number of decimals in the text (-1 means sText is a string)    UInteger iWidth;            // width of text before truncatingReturns Boolean // True, if success; False, if an error occurred
78201>>>>>>>>>
78201>>>>>>>>>External_Function WP_SetProgressCaption "SetProgressCaption" WinPrint.dll ;    String sProgressCaption ;Returns Boolean
78202>>>>>>>>>
78202>>>>>>>>>External_Function WP_SetReportTitle     "SetReportTitle"     WinPrint.dll ;    String sCaption ;Returns Boolean
78203>>>>>>>>>
78203>>>>>>>>>External_Function WP_ViewerWantsToClose "ViewerWantsToClose" WinPrint.dll ;Returns Integer
78204>>>>>>>>>
78204>>>>>>>>>External_Function WP_DisplayMessageBox  "DisplayMessageBox"  WinPrint.dll ;    String sCaption String sText ;Returns Integer
78205>>>>>>>>>
78205>>>>>>>>>External_Function WP_GetViewerWindow "GetViewerWindow" Winprint.dll ;Returns Handle
78206>>>>>>>>>
78206>>>>>>>>>External_Function WP_GetDocumentStatus "GetDocumentStatus" Winprint.dll ;Returns Integer // returns dsNotStarted, dsStarted, or dsFinished
78207>>>>>>>>>
78207>>>>>>>Use WinPrint_Constants.pkg
78207>>>>>>>Use Rgb.pkg
78207>>>>>>>Use GlobalFunctionsProcedures.pkg
78207>>>>>>>
78207>>>>>>>DEFINE INFINITE for -1
78207>>>>>>>DEFINE WAIT_TIMEOUT for |CI$00000102
78207>>>>>>>
78207>>>>>>>
78207>>>>>>>DEFINE QS_KEY            for |CI$0001
78207>>>>>>>DEFINE QS_MOUSEMOVE      for |CI$0002
78207>>>>>>>DEFINE QS_MOUSEBUTTON    for |CI$0004
78207>>>>>>>DEFINE QS_POSTMESSAGE    for |CI$0008
78207>>>>>>>DEFINE QS_TIMER          for |CI$0010
78207>>>>>>>DEFINE QS_PAINT          for |CI$0020
78207>>>>>>>DEFINE QS_SENDMESSAGE    for |CI$0040
78207>>>>>>>DEFINE QS_HOTKEY         for |CI$0080
78207>>>>>>>DEFINE QS_ALLPOSTMESSAGE for |CI$0100
78207>>>>>>>DEFINE QS_MOUSE          for (QS_MOUSEMOVE ior QS_MOUSEBUTTON)
78207>>>>>>>DEFINE QS_INPUT          for (QS_MOUSE ior QS_KEY)
78207>>>>>>>DEFINE QS_ALLEVENTS      for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY)
78207>>>>>>>DEFINE QS_ALLINPUT       for (QS_INPUT ior QS_POSTMESSAGE ior QS_TIMER ior QS_PAINT ior QS_HOTKEY ior QS_SENDMESSAGE)
78207>>>>>>>
78207>>>>>>>External_Function WaitForSingleObject "WaitForSingleObject" Kernel32.dll Handle hHandle Dword dwMilliseconds Returns DWord
78208>>>>>>>External_Function GetCurrentProcessId "GetCurrentProcessId" Kernel32.dll Returns DWord
78209>>>>>>>External_Function GetCurrentProcess "GetCurrentProcess" Kernel32.dll Returns DWord
78210>>>>>>>
78210>>>>>>>External_Function MsgWaitForMultipleObjects "MsgWaitForMultipleObjects" User32.dll ;    DWORD nCount;             // number of handles in the object handle array    Address pHandles;     // pointer to the object-handle array    Boolean fWaitAll;     // wait for all or wait for one    DWORD dwMilliseconds; // time-out interval in milliseconds    DWORD dwWakeMask;     // type of input events to wait forReturns Dword
78211>>>>>>>
78211>>>>>>>Use GlobalFunctionsProcedures.pkg
78211>>>>>>>
78211>>>>>>>Class cWinPrint2 is a cObject // JJT: Will we need a windows handle for this like old one
78212>>>>>>>    Procedure Construct_Object
78214>>>>>>>        forward send construct_object
78216>>>>>>>
78216>>>>>>>        //*** internal properties
78216>>>>>>>        Property Integer DFCurrent_Color       0
78217>>>>>>>        Property String  DFCurrent_OutPut      "WinPrint"
78218>>>>>>>        Property Integer DFCurrent_Diagram     0
78219>>>>>>>        Property Integer DFCurrent_HeaderType  0
78220>>>>>>>        Property Integer DFCurrent_HeaderNr    0
78221>>>>>>>        Property Number  DFCurrent_FontSize    10
78222>>>>>>>        Property String  DFCurrent_Font        "Arial"
78223>>>>>>>
78223>>>>>>>        //*** Default values for margins 2.53 CM = 1 inch
78223>>>>>>>        Property Number  DFLeft_Margin    2.53
78224>>>>>>>        Property Number  DFTop_Margin     2.53
78225>>>>>>>        Property Number  DFright_Margin   2.53
78226>>>>>>>        Property Number  DFBottom_Margin  2.53
78227>>>>>>>
78227>>>>>>>        // If WP1 this defaults to false. In 2, it is true which means that the print job
78227>>>>>>>        // dialog appears when you hitprint in previewer.
78227>>>>>>>        Property Integer PrintDlgInPreview   1
78228>>>>>>>         // This does nothing in Wp2 (because you can't to this anyway)
78228>>>>>>>        Property Integer EnablePrintSetupFromPreview  True
78229>>>>>>>        Property Integer EnablePrintFromPreview  1
78230>>>>>>>
78230>>>>>>>        // is the GUI Suspended. This is privately maintained and is used
78230>>>>>>>        // to figure out if a preview panel is up or not
78230>>>>>>>        Property Integer pbIsSuspended False
78231>>>>>>>
78231>>>>>>>        Object oDFColorArray is an Array
78233>>>>>>>           //Moved into array
78233>>>>>>>           Set Value  0  To RGB_WHITE
78234>>>>>>>           Set Value  1  To RGB_RED
78235>>>>>>>           Set Value  2  To RGB_BLUE
78236>>>>>>>           Set Value  3  To RGB_GREEN
78237>>>>>>>           Set Value  4  To RGB_YELLOW
78238>>>>>>>           Set Value  5  To RGB_GREY
78239>>>>>>>           Set Value  6  To RGB_CYAN
78240>>>>>>>           Set Value  7  To RGB_MAGENTA
78241>>>>>>>           Set Value  8  To RGB_DRED
78242>>>>>>>           Set Value  9  To RGB_DBLUE
78243>>>>>>>           Set Value  10 To RGB_DGREEN
78244>>>>>>>           Set Value  11 To RGB_DYELLOW
78245>>>>>>>           Set Value  12 To RGB_DGREY
78246>>>>>>>           Set Value  13 To RGB_DCYAN
78247>>>>>>>           Set Value  14 To RGB_DMAGENTA
78248>>>>>>>           Set Value  15 To RGB_BLACK
78249>>>>>>>        End_Object
78250>>>>>>>
78250>>>>>>>        Object oDiagramArray is an Array
78252>>>>>>>        End_Object
78253>>>>>>>
78253>>>>>>>    End_Procedure
78254>>>>>>>
78254>>>>>>>    Function ViewerWantsToClose returns Boolean
78256>>>>>>>        Function_return (WP_ViewerWantsToClose())
78257>>>>>>>    end_Function
78258>>>>>>>
78258>>>>>>>    Function IsViewerActive returns boolean
78260>>>>>>>        Function_Return (WP_GetViewerWindow()<>0)
78261>>>>>>>    end_function
78262>>>>>>>
78262>>>>>>>    Function IsPrinterValid Returns Boolean
78264>>>>>>>        Function_Return (WP_IsPrinterValid()<>0)
78265>>>>>>>    End_Function
78266>>>>>>>
78266>>>>>>>    Function ArePrintersInstalled returns boolean
78268>>>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
78269>>>>>>>    End_Function
78270>>>>>>>
78270>>>>>>>
78270>>>>>>>    // returns docucument state: dsNotStarted, dsStarted, dsFinished
78270>>>>>>>    Function DocumentStatus returns Integer
78272>>>>>>>        Function_Return (WP_GetDocumentStatus())
78273>>>>>>>    end_function
78274>>>>>>>
78274>>>>>>>    // Might still be called from report class. Leave dummy stub
78274>>>>>>>    Procedure DFZeroCounters
78276>>>>>>>    End_Procedure
78277>>>>>>>
78277>>>>>>>    //***
78277>>>>>>>    Function DFNewPage Integer Columns Returns Integer
78279>>>>>>>        Integer iPageNum
78279>>>>>>>        // This returns a page number used in report object....(this may change)
78279>>>>>>>        Move (WP_CreatePage(Columns)) To iPageNum
78280>>>>>>>        If (iPageNum=0) Begin
78282>>>>>>>            Error DFERR_WINPRINT DFPrintError900
78283>>>>>>>>
78283>>>>>>>        End
78283>>>>>>>>
78283>>>>>>>        Function_Return iPageNum
78284>>>>>>>    End_Function
78285>>>>>>>
78285>>>>>>>    //***Return handle to use for winprint dialog. If main_window
78285>>>>>>>    //   exists, use it. Else, get object's handle
78285>>>>>>>    Function Report_Window_Handle returns handle
78287>>>>>>>        Handle hWnd
78287>>>>>>>        Handle hoObj
78287>>>>>>>        Get Focus of desktop to hoObj // start with the focus
78288>>>>>>>        Move (gOwnerWindowHandle(hoObj)) to hWnd // global function finds the right handle for us
78289>>>>>>>        function_return hWnd
78290>>>>>>>    End_Function
78291>>>>>>>
78291>>>>>>>
78291>>>>>>>    //***
78291>>>>>>>    Function DFPrintDialog Returns Boolean
78293>>>>>>>        Handle hwnd
78293>>>>>>>        Boolean bOk
78293>>>>>>>
78293>>>>>>>        Get Report_Window_Handle to hWnd
78294>>>>>>>        Move (WP_ExecutePrintDialog(hwnd)) To bOk
78295>>>>>>>
78295>>>>>>>        Function_Return bOk
78296>>>>>>>    End_Function
78297>>>>>>>
78297>>>>>>>
78297>>>>>>>    //*** You can only invoke the print setup if the report is cleared. If you try to to do this in
78297>>>>>>>    //    the wrong state you will get an error.
78297>>>>>>>    Function DFPrintSetupDialog Returns Boolean
78299>>>>>>>        Handle hwnd
78299>>>>>>>        Boolean bOk
78299>>>>>>>        Integer iStatus
78299>>>>>>>        Get ArePrintersInstalled to bOk
78300>>>>>>>        If not bOk Begin
78302>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
78303>>>>>>>>
78303>>>>>>>        End
78303>>>>>>>>
78303>>>>>>>        Else Begin
78304>>>>>>>            Get DocumentStatus to iStatus
78305>>>>>>>            
78305>>>>>>>            If (iStatus=dsNotStarted) Begin
78307>>>>>>>                Get Report_Window_Handle to hWnd
78308>>>>>>>                Move (WP_ExecutePrinterSetupDialog(hwnd)) to bOk
78309>>>>>>>                
78309>>>>>>>                // test that the selected printer is valid....
78309>>>>>>>                If bOK Begin
78311>>>>>>>                    Get IsPrinterValid to bOk // if printer not valid, it's not ok
78312>>>>>>>                    If not bOk Begin
78314>>>>>>>                        Error DFERR_WINPRINT DFPrintError936  // could not select a valid printer
78315>>>>>>>>
78315>>>>>>>                    End
78315>>>>>>>>
78315>>>>>>>                End
78315>>>>>>>>
78315>>>>>>>            End
78315>>>>>>>>
78315>>>>>>>            Else Begin
78316>>>>>>>               Error DFERR_WINPRINT DFPrintError966      // cannot change printer when report is active
78317>>>>>>>>
78317>>>>>>>            End
78317>>>>>>>>
78317>>>>>>>        End
78317>>>>>>>>
78317>>>>>>>        Function_Return bOk
78318>>>>>>>    End_Function
78319>>>>>>>
78319>>>>>>>
78319>>>>>>>    //*** Provided for backwards compatibility. DFPrintSetupDialog is more flexible because it returns a
78319>>>>>>>    //    false if cancel was selected.
78319>>>>>>>    Procedure DFPrintSetup
78321>>>>>>>        Boolean bOk
78321>>>>>>>        Get DFPrintSetupDialog to bOk
78322>>>>>>>    End_Procedure
78323>>>>>>>
78323>>>>>>>    //*** This invokes the print job dialog, prints the report, then clears the report document.
78323>>>>>>>    //    This should be called after the report is complete.
78323>>>>>>>    Procedure DFPrint
78325>>>>>>>        Integer bOk
78325>>>>>>>        Get DFPrintDialog To bOk
78326>>>>>>>        If bOk Begin
78328>>>>>>>            Send DFPrintDoc
78329>>>>>>>            Send DFClearDoc
78330>>>>>>>        End
78330>>>>>>>>
78330>>>>>>>    End_Procedure
78331>>>>>>>
78331>>>>>>>    Procedure DFSuspendGui boolean bSuspend
78333>>>>>>>        If (bSuspend<>pbIsSuspended(self)) begin
78335>>>>>>>            Send SuspendGui of Desktop bSuspend
78336>>>>>>>            Set pbIsSuspended to bSuspend
78337>>>>>>>        end
78337>>>>>>>>
78337>>>>>>>    end_procedure
78338>>>>>>>
78338>>>>>>>    // this is protected so that the queue is only pumped if the
78338>>>>>>>    // gui is suspended.
78338>>>>>>>    Procedure PumpMsgQueue
78340>>>>>>>        If (pbIsSuspended(self)) begin
78342>>>>>>>            Send PumpMsgQueue of desktop // permit painting
78343>>>>>>>        end
78343>>>>>>>>
78343>>>>>>>    end_procedure
78344>>>>>>>
78344>>>>>>>
78344>>>>>>>    //*** This does a modeless preview. This is what you'd want during
78344>>>>>>>    //    report generation and it may be what you want for report viewing.
78344>>>>>>>    Procedure DFPreviewNoWait
78346>>>>>>>        Boolean bOk
78346>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
78346>>>>>>>        integer iStatus
78346>>>>>>>        Get PrintDlgInPreview to bPrntDlg
78347>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
78348>>>>>>>        Get EnablePrintFromPreview to bPrint
78349>>>>>>>        Get DocumentStatus to iStatus
78350>>>>>>>        If (iStatus=dsStarted) begin
78352>>>>>>>            Send DfSuspendGui True
78353>>>>>>>        end
78353>>>>>>>>
78353>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) To bOk
78354>>>>>>>        If not bOk Begin
78356>>>>>>>            Error DFERR_WINPRINT DFPrintError901
78357>>>>>>>>
78357>>>>>>>            Send DfSuspendGui False
78358>>>>>>>        End
78358>>>>>>>>
78358>>>>>>>    End_Procedure
78359>>>>>>>
78359>>>>>>>
78359>>>>>>>    //*** This does a modal preview. You might want this for report
78359>>>>>>>    //    viewing as the program knows when the viewer is closed
78359>>>>>>>    // Note that this is a private message and it was never intended that this
78359>>>>>>>    // should be used. We expect winprint reports to use modeless viewers.
78359>>>>>>>    Procedure DFPreviewWait
78361>>>>>>>        Handle hViewerProcess
78361>>>>>>>        Boolean bPrntDlg bPrintSetup bPrint
78361>>>>>>>        Integer iRetVal
78361>>>>>>>        Integer hwMain hMain
78361>>>>>>>
78361>>>>>>>        Get PrintDlgInPreview to bPrntDlg
78362>>>>>>>        Get EnablePrintSetupFromPreview to bPrintSetup
78363>>>>>>>        Get EnablePrintFromPreview to bPrint
78364>>>>>>>
78364>>>>>>>        Send DfSuspendGui True
78365>>>>>>>        Move (WP_PreviewDocument(bPrntDlg,bPrintSetup,bPrint)) To hViewerProcess
78366>>>>>>>
78366>>>>>>>        If (hViewerProcess = 0) Begin
78368>>>>>>>            Error DFERR_WINPRINT DFPrintError901
78369>>>>>>>>
78369>>>>>>>        End
78369>>>>>>>>
78369>>>>>>>        Else Begin
78370>>>>>>>            // We need to wait for either the Viewer to close, or a WM_PAINT message in the thread's queue...
78370>>>>>>>            Repeat
78370>>>>>>>>
78370>>>>>>>               Move (MsgWaitForMultipleObjects(1, AddressOf(hViewerProcess), False, INFINITE, QS_PAINT)) To iRetVal
78371>>>>>>>               Send PumpMsgQueue // permit painting
78372>>>>>>>            Until (iRetVal = 0) // 0 means that the viewer process terminated
78374>>>>>>>        end
78374>>>>>>>>
78374>>>>>>>        Send DfSuspendGui False
78375>>>>>>>
78375>>>>>>>       // Do what we can to force VDF application to the top.
78375>>>>>>>       // As 12.0 dfSuspendGUI actually properly disables the underlying windows. When the viewer
78375>>>>>>>       // is closed it cannot give the focus back to this so it goes elsewhere. This will force it
78375>>>>>>>       // back. 
78375>>>>>>>
78375>>>>>>>       Get main_window of desktop to hMain
78376>>>>>>>       If hMain Begin
78378>>>>>>>          Get window_handle of hMain to hwMain
78379>>>>>>>          If hwMain Begin
78381>>>>>>>              If (GetForegroundWindow()<>hwMain) Begin
78383>>>>>>>                  Move (SetForegroundWindow(hwMain)) to hwMain
78384>>>>>>>              End
78384>>>>>>>>
78384>>>>>>>          End
78384>>>>>>>>
78384>>>>>>>       End
78384>>>>>>>>
78384>>>>>>>
78384>>>>>>>    End_Procedure
78385>>>>>>>
78385>>>>>>>    Procedure DfPreview
78387>>>>>>>        send DfPreviewNoWait
78388>>>>>>>    end_procedure
78389>>>>>>>
78389>>>>>>>
78389>>>>>>>    //***
78389>>>>>>>    Procedure DFPrintDoc
78391>>>>>>>        Handle hwnd
78391>>>>>>>        Boolean bOk
78391>>>>>>>        Get Report_Window_Handle to hWnd
78392>>>>>>>        Move (WP_PrintDocument(hwnd)) To bOk
78393>>>>>>>
78393>>>>>>>        If not bOk Begin
78395>>>>>>>            Error DFERR_WINPRINT DFPrintError902
78396>>>>>>>>
78396>>>>>>>        End
78396>>>>>>>>
78396>>>>>>>    End_Procedure
78397>>>>>>>
78397>>>>>>>
78397>>>>>>>    //***
78397>>>>>>>    Procedure DFClearDoc
78399>>>>>>>        Boolean bOk
78399>>>>>>>        Get ArePrintersInstalled to bOk
78400>>>>>>>        If bOk begin
78402>>>>>>>            Move (WP_ClearDocument()) To bOk
78403>>>>>>>            Send DFSuspendGUI False
78404>>>>>>>            If not bOk Begin
78406>>>>>>>               Error DFERR_WINPRINT DFPrintError903 // error number right?
78407>>>>>>>>
78407>>>>>>>            End
78407>>>>>>>>
78407>>>>>>>        End
78407>>>>>>>>
78407>>>>>>>    End_Procedure
78408>>>>>>>
78408>>>>>>>    Procedure DFNewDoc Boolean bAutoPreview
78410>>>>>>>        Boolean bOk
78410>>>>>>>        // this is the most likely place we will encounter when we start a report. Check for
78410>>>>>>>        // printers and return an explicit error to make it easy to identify the error
78410>>>>>>>        Get ArePrintersInstalled to bOk
78411>>>>>>>        If not bOk begin
78413>>>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
78414>>>>>>>>
78414>>>>>>>        end
78414>>>>>>>>
78414>>>>>>>        else begin
78415>>>>>>>            Send DfClearDoc //JJT - a new doc should always start with a clear
78416>>>>>>>            If bAutoPreview Send DFSuspendGUI True
78419>>>>>>>            Move (WP_NewDocument(bAutoPreview)) To bOk
78420>>>>>>>
78420>>>>>>>            If not bOk Begin
78422>>>>>>>               Error DFERR_WINPRINT DFPrintError902  // could not print document
78423>>>>>>>>
78423>>>>>>>               Send DFSuspendGUI False
78424>>>>>>>            End
78424>>>>>>>>
78424>>>>>>>        end
78424>>>>>>>>
78424>>>>>>>    End_Procedure
78425>>>>>>>
78425>>>>>>>    //***
78425>>>>>>>    Procedure DFSetFont String sFontName
78427>>>>>>>        boolean bOk
78427>>>>>>>        Move (WP_SetFontName(sFontName)) To bOk
78428>>>>>>>
78428>>>>>>>        If not bOK Begin
78430>>>>>>>            Error DFERR_WINPRINT DFPrintError904
78431>>>>>>>>
78431>>>>>>>        End
78431>>>>>>>>
78431>>>>>>>    End_Procedure
78432>>>>>>>
78432>>>>>>>
78432>>>>>>>    //***
78432>>>>>>>    Procedure DFSetFontSize Integer iHeight Integer iWidth
78434>>>>>>>        boolean bOk
78434>>>>>>>        // note that width is ignored in new implementation
78434>>>>>>>        Move (WP_SetFontHeight(iHeight)) To bOk
78435>>>>>>>
78435>>>>>>>        If not bOK Begin
78437>>>>>>>            Error DFERR_WINPRINT  DFPrintError905
78438>>>>>>>>
78438>>>>>>>        End
78438>>>>>>>>
78438>>>>>>>    End_Procedure
78439>>>>>>>
78439>>>>>>>
78439>>>>>>>    //***
78439>>>>>>>    Procedure DFSetFontStyle DWORD dwStyle
78441>>>>>>>        boolean bOk
78441>>>>>>>        Move (WP_SetFontStyle(dwStyle)) To bOk
78442>>>>>>>
78442>>>>>>>        If not bOK Begin
78444>>>>>>>            Error DFERR_WINPRINT DFPrintError906
78445>>>>>>>>
78445>>>>>>>        End
78445>>>>>>>>
78445>>>>>>>    End_Procedure
78446>>>>>>>
78446>>>>>>>
78446>>>>>>>    //***
78446>>>>>>>    Procedure DFSetUnderline boolean bUnderline
78448>>>>>>>        boolean bOk
78448>>>>>>>
78448>>>>>>>        Move (WP_SetFontUnderline(bUnderline)) To bOk
78449>>>>>>>
78449>>>>>>>        If not bOK Begin
78451>>>>>>>            Error DFERR_WINPRINT DFPrintError907
78452>>>>>>>>
78452>>>>>>>        End
78452>>>>>>>>
78452>>>>>>>    End_Procedure
78453>>>>>>>
78453>>>>>>>
78453>>>>>>>    //***
78453>>>>>>>    Procedure DFSetBold Boolean bBold
78455>>>>>>>        Boolean bOk
78455>>>>>>>
78455>>>>>>>        Move (WP_SetFontBold(bBold)) To bOk
78456>>>>>>>
78456>>>>>>>        If not bOK Begin
78458>>>>>>>            Error DFERR_WINPRINT DFPrintError908
78459>>>>>>>>
78459>>>>>>>        End
78459>>>>>>>>
78459>>>>>>>    End_Procedure
78460>>>>>>>
78460>>>>>>>
78460>>>>>>>    //***
78460>>>>>>>    Procedure DFSetItalic Boolean bItalic
78462>>>>>>>        Boolean bOk
78462>>>>>>>
78462>>>>>>>        Move (WP_SetFontItalic(bItalic)) To bOk
78463>>>>>>>
78463>>>>>>>        If not bOK Begin
78465>>>>>>>            Error DFERR_WINPRINT DFPrintError909
78466>>>>>>>>
78466>>>>>>>        End
78466>>>>>>>>
78466>>>>>>>    End_Procedure
78467>>>>>>>
78467>>>>>>>
78467>>>>>>>    //***
78467>>>>>>>    Procedure DFSetStrikeout Boolean bStrikeout
78469>>>>>>>        Boolean bOk
78469>>>>>>>
78469>>>>>>>        Move (WP_SetFontStrikeout(bStrikeout)) To bOk
78470>>>>>>>
78470>>>>>>>        If not bOK Begin
78472>>>>>>>            Error DFERR_WINPRINT DFPrintError910
78473>>>>>>>>
78473>>>>>>>        End
78473>>>>>>>>
78473>>>>>>>    End_Procedure
78474>>>>>>>
78474>>>>>>>
78474>>>>>>>    //***
78474>>>>>>>    Procedure DFSetMargins Number nLeft Number nTop Number nRight Number nBottom
78476>>>>>>>        Boolean bOk
78476>>>>>>>        integer iLeft iRight iTop iBottom
78476>>>>>>>
78476>>>>>>>        Move (nLeft   * 100) to iLeft
78477>>>>>>>        Move (nRight  * 100) to iRight
78478>>>>>>>        Move (nTop    * 100) to iTop
78479>>>>>>>        Move (nBottom * 100) to iBottom
78480>>>>>>>
78480>>>>>>>        Move (WP_SetMargins(iLeft,iTop,iRight,iBottom)) To bOk
78481>>>>>>>
78481>>>>>>>        If bOk Begin
78483>>>>>>>            Set DFLeft_Margin   To nLeft
78484>>>>>>>            Set DFTop_Margin    To nTop
78485>>>>>>>            Set DFRight_Margin  To nRight
78486>>>>>>>            Set DFBottom_Margin To nBottom
78487>>>>>>>        End
78487>>>>>>>>
78487>>>>>>>        Else Begin
78488>>>>>>>            Error DFERR_WINPRINT DFPrintError911
78489>>>>>>>>
78489>>>>>>>        End
78489>>>>>>>>
78489>>>>>>>    End_Procedure
78490>>>>>>>
78490>>>>>>>
78490>>>>>>>    //***
78490>>>>>>>    Procedure DFSetLeftMargin Number nLeft
78492>>>>>>>        number  nTop nRight nBottom
78492>>>>>>>        Get DFTop_Margin    To nTop
78493>>>>>>>        Get DFRight_Margin  To nRight
78494>>>>>>>        Get DFBottom_Margin To nBottom
78495>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
78496>>>>>>>    End_Procedure
78497>>>>>>>
78497>>>>>>>
78497>>>>>>>    //***
78497>>>>>>>    Procedure DFSetRightMargin Number nRight
78499>>>>>>>        number  nLeft nTop nBottom
78499>>>>>>>        Get DFLeft_Margin   To nLeft
78500>>>>>>>        Get DFTop_Margin    To nTop
78501>>>>>>>        Get DFBottom_Margin To nBottom
78502>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
78503>>>>>>>    End_Procedure
78504>>>>>>>
78504>>>>>>>
78504>>>>>>>    //***
78504>>>>>>>    Procedure DFSetTopMargin Number nTop
78506>>>>>>>        number  nLeft nRight nBottom
78506>>>>>>>        Get DFLeft_Margin   To nLeft
78507>>>>>>>        Get DFRight_Margin  To nRight
78508>>>>>>>        Get DFBottom_Margin To nBottom
78509>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
78510>>>>>>>    End_Procedure
78511>>>>>>>
78511>>>>>>>
78511>>>>>>>    //***
78511>>>>>>>    Procedure DFSetBottomMargin Number nBottom
78513>>>>>>>        number  nLeft nTop nRight
78513>>>>>>>        Get DFLeft_Margin   To nLeft
78514>>>>>>>        Get DFTop_Margin    To nTop
78515>>>>>>>        Get DFRight_Margin  To nRight
78516>>>>>>>        Send DFSetMargins nLeft nTop nRight nBottom
78517>>>>>>>    End_Procedure
78518>>>>>>>
78518>>>>>>>
78518>>>>>>>    //***
78518>>>>>>>    Procedure DFWriteText String sText Integer iStyle Integer iColumn Integer iDecimal Boolean bNewLineAfterPrint
78520>>>>>>>        Boolean bOk
78520>>>>>>>
78520>>>>>>>        Send DFSetFontStyle iStyle
78521>>>>>>>        Get ToAnsi sText To sText
78522>>>>>>>        Move (WP_WriteText(sText,bNewLineAfterPrint,iColumn,iDecimal,0)) To bOk
78523>>>>>>>        If not bOk Begin
78525>>>>>>>            Error DFERR_WINPRINT DFPrintError918
78526>>>>>>>>
78526>>>>>>>        End
78526>>>>>>>>
78526>>>>>>>        Send PumpMsgQueue // permit painting //JJT!!!!!!!!!!!
78527>>>>>>>    End_Procedure
78528>>>>>>>
78528>>>>>>>    //***
78528>>>>>>>    Procedure DFWrite String sText DWORD iStyle Integer iColumn Integer iDecimal Boolean bTrim
78530>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
78532>>>>>>>            Move (Rtrim(sText)) to sText
78533>>>>>>>        end
78533>>>>>>>>
78533>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal False
78534>>>>>>>    End_Procedure
78535>>>>>>>
78535>>>>>>>    //***
78535>>>>>>>    Procedure DFWriteLn String sText DWORD iStyle Integer iColumn Integer iDecimal Boolean bTrim
78537>>>>>>>        If (Num_Arguments>=5 and bTrim) Begin
78539>>>>>>>            Move (Rtrim(sText)) to sText
78540>>>>>>>        end
78540>>>>>>>>
78540>>>>>>>        Send DFWriteText sText iStyle iColumn iDecimal True
78541>>>>>>>    End_Procedure
78542>>>>>>>
78542>>>>>>>
78542>>>>>>>    //***
78542>>>>>>>    Procedure DFWriteTextAtPosition String sText integer iStyle Number nPosition Integer iDecimal ;                                    Number nMaxLength Boolean bNewLineAfterPrint
78544>>>>>>>        Boolean bOk
78544>>>>>>>        Integer iPosition iMaxLength
78544>>>>>>>        Send DFSetFontStyle iStyle
78545>>>>>>>        Get ToAnsi sText To sText
78546>>>>>>>        Move (nPosition * 100) to iPosition
78547>>>>>>>        Move (nMaxLength * 100) to iMaxLength
78548>>>>>>>        Move (WP_WriteTextAtPosition(sText,bNewLineAfterPrint,iPosition,iDecimal,iMaxLength)) To bOk
78549>>>>>>>        If not bOk Begin
78551>>>>>>>            Error DFERR_WINPRINT DFPrintError922
78552>>>>>>>>
78552>>>>>>>        End
78552>>>>>>>>
78552>>>>>>>         Send PumpMsgQueue // permit painting //JJT!!!!!!!!!!!
78553>>>>>>>    End_Procedure
78554>>>>>>>
78554>>>>>>>    //***
78554>>>>>>>    Procedure DFWritePos String sText integer iStyle Number nPosition Integer iDecimal Number nMaxLength boolean bTrim
78556>>>>>>>        Number nMax
78556>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
78558>>>>>>>            Move (Rtrim(sText)) to sText
78559>>>>>>>        end
78559>>>>>>>>
78559>>>>>>>
78559>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
78562>>>>>>>        Else ;            Move nMaxLength to nMax
78564>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax False
78565>>>>>>>    End_Procedure
78566>>>>>>>
78566>>>>>>>    //***
78566>>>>>>>    Procedure DFWriteLnPos String sText integer iStyle Number nPosition Integer iDecimal Number nMaxLength boolean bTrim
78568>>>>>>>        Number nMax
78568>>>>>>>        If (Num_Arguments>=6 and bTrim) Begin
78570>>>>>>>            Move (Rtrim(sText)) to sText
78571>>>>>>>        end
78571>>>>>>>>
78571>>>>>>>
78571>>>>>>>        If (Num_Arguments<5) ;            Move 0 to nMax
78574>>>>>>>        Else ;            Move nMaxLength to nMax
78576>>>>>>>        Send DFWriteTextAtPosition sText iStyle nPosition iDecimal nMax True
78577>>>>>>>    End_Procedure
78578>>>>>>>
78578>>>>>>>    Procedure DFSetMetrics String sMetrics
78580>>>>>>>        integer eMetrics
78580>>>>>>>        // for backwards compatibility support both string names and integer enumerations
78580>>>>>>>        // it is better to use the enumeration value
78580>>>>>>>        If (sMetrics="INCH" or sMetrics="CM") Begin
78582>>>>>>>            Set DFCurrent_Metrics to sMetrics
78583>>>>>>>        end
78583>>>>>>>>
78583>>>>>>>        else Begin
78584>>>>>>>            Move sMetrics to eMetrics
78585>>>>>>>            Move (WP_SetMetrics(eMetrics)) To eMetrics
78586>>>>>>>        End
78586>>>>>>>>
78586>>>>>>>    End_Procedure
78587>>>>>>>
78587>>>>>>>    Function DFGetMetrics Returns Integer
78589>>>>>>>        Integer eMetrics
78589>>>>>>>        Move (WP_GetMetrics()) To eMetrics
78590>>>>>>>        Function_return eMetrics
78591>>>>>>>    End_Function
78592>>>>>>>
78592>>>>>>>
78592>>>>>>>    //**** Properties Maintained for compatibility with old Winprint (obsolete)
78592>>>>>>>    Function DFCurrent_Metrics returns string
78594>>>>>>>        Integer eMetrics
78594>>>>>>>        Get DFGetMetrics to eMetrics
78595>>>>>>>        Function_return (if(eMetrics=WPM_INCH,"INCH","CM"))
78596>>>>>>>    end_function
78597>>>>>>>
78597>>>>>>>    Procedure Set DFCurrent_Metrics string sCMorINCH
78599>>>>>>>        Send DFSetMetrics (if(sCMorINCH="INCH", WPM_INCH, WPM_CM))
78600>>>>>>>    End_Procedure
78601>>>>>>>
78601>>>>>>>
78601>>>>>>>
78601>>>>>>>
78601>>>>>>>
78601>>>>>>>    //***
78601>>>>>>>    Procedure DFBeginHeaderType Integer iHeaderNr Integer eHeaderType
78603>>>>>>>        Boolean bOk
78603>>>>>>>
78603>>>>>>>        If (eHeaderType=DFSubHeader or eHeaderType=DFSubTotal) Begin
78605>>>>>>>            //*** Do nothing for the moment
78605>>>>>>>        End
78605>>>>>>>>
78605>>>>>>>        Else ;            Move 0 to iHeaderNr // If the user made a mistake
78607>>>>>>>
78607>>>>>>>        Set DFCurrent_HeaderType To eHeaderType
78608>>>>>>>        Set DFCurrent_HeaderNr   To iHeaderNr
78609>>>>>>>
78609>>>>>>>        Move (WP_BeginHeader(eHeaderType, iHeaderNr)) To bOk
78610>>>>>>>
78610>>>>>>>        If not bOk Begin
78612>>>>>>>            Error DFERR_WINPRINT DFPrintError925
78613>>>>>>>>
78613>>>>>>>        End
78613>>>>>>>>
78613>>>>>>>    End_Procedure
78614>>>>>>>
78614>>>>>>>
78614>>>>>>>    //***
78614>>>>>>>    Procedure DFEndHeaderType
78616>>>>>>>        Boolean bOk
78616>>>>>>>
78616>>>>>>>        Move (WP_EndHeader()) To bOk
78617>>>>>>>
78617>>>>>>>        if not bOk begin
78619>>>>>>>            Error DFERR_WINPRINT DFPrintError926
78620>>>>>>>>
78620>>>>>>>        End
78620>>>>>>>>
78620>>>>>>>    End_Procedure
78621>>>>>>>
78621>>>>>>>
78621>>>>>>>    //***
78621>>>>>>>    Procedure DFWriteHeaderType Integer iHeaderNr Integer eHeaderType
78623>>>>>>>        Boolean bOk
78623>>>>>>>        Move (WP_WriteHeader(eHeaderType, iHeaderNr)) To bOk
78624>>>>>>>        if not bOk begin
78626>>>>>>>            Error DFERR_WINPRINT DFPrintError927
78627>>>>>>>>
78627>>>>>>>        End
78627>>>>>>>>
78627>>>>>>>    End_Procedure
78628>>>>>>>
78628>>>>>>>
78628>>>>>>>    //***
78628>>>>>>>    Procedure DFHeaderPosition Integer ePlace
78630>>>>>>>        Boolean bOk
78630>>>>>>>
78630>>>>>>>         Move (WP_SetHeaderPlacement(ePlace)) To bOk
78631>>>>>>>
78631>>>>>>>         if not bOk begin
78633>>>>>>>            Error DFERR_WINPRINT DFPrintError929
78634>>>>>>>>
78634>>>>>>>        End
78634>>>>>>>>
78634>>>>>>>    End_Procedure
78635>>>>>>>
78635>>>>>>>
78635>>>>>>>    //***
78635>>>>>>>    Procedure DFHeaderFrameType Integer eFrame integer iColor Number nWeight;                                Integer iFillColor Boolean bFillFrame
78637>>>>>>>        Integer iWeight
78637>>>>>>>        Boolean bOk
78637>>>>>>>
78637>>>>>>>        move (nWeight*100) To iWeight
78638>>>>>>>
78638>>>>>>>        Move (WP_SetHeaderFrame(eFrame,iColor,iWeight,iFillColor,bFillFrame)) To bOk
78639>>>>>>>
78639>>>>>>>         if not bOk begin
78641>>>>>>>            Error DFERR_WINPRINT DFPrintError930
78642>>>>>>>>
78642>>>>>>>        End
78642>>>>>>>>
78642>>>>>>>    End_Procedure
78643>>>>>>>
78643>>>>>>>  Procedure DFHeaderMargin Integer eType Number nSize
78645>>>>>>>        Boolean bOk
78645>>>>>>>        Integer iSize
78645>>>>>>>
78645>>>>>>>        move (nSize * 100) to iSize
78646>>>>>>>
78646>>>>>>>        move (WP_SetHeaderMargin(eType, iSize)) To bOk
78647>>>>>>>
78647>>>>>>>        if not bOk begin
78649>>>>>>>            Error DFERR_WINPRINT DFPrintError930
78650>>>>>>>>
78650>>>>>>>        end
78650>>>>>>>>
78650>>>>>>>    End_Procedure
78651>>>>>>>
78651>>>>>>>
78651>>>>>>>    //***
78651>>>>>>>    Procedure DFHeaderWrap Integer eOnOff
78653>>>>>>>         Boolean bOk
78653>>>>>>>
78653>>>>>>>         Move (WP_SetHeaderWrap(eOnOff)) To bOk
78654>>>>>>>
78654>>>>>>>         if not bOk begin
78656>>>>>>>            Error DFERR_WINPRINT DFPrintError931
78657>>>>>>>>
78657>>>>>>>        End
78657>>>>>>>>
78657>>>>>>>    End_Procedure
78658>>>>>>>
78658>>>>>>>    //***
78658>>>>>>>    Procedure DFWriteBMP String sFileName Number nStartX Number nStartY Number nHeight Number nWidth Boolean bUCp
78660>>>>>>>        Boolean bOk
78660>>>>>>>        Integer iStartX iStartY iHeight iWidth
78660>>>>>>>
78660>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX to iStartX
78663>>>>>>>        else ;            move (nStartX*100) To iStartX
78665>>>>>>>
78665>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY to iStartY
78668>>>>>>>        else ;            move (nStartY*100) To iStartY
78670>>>>>>>
78670>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
78673>>>>>>>        else ;            move (nWidth*100) To iWidth
78675>>>>>>>
78675>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
78678>>>>>>>        else ;            move (nHeight*100) To iHeight
78680>>>>>>>
78680>>>>>>>        Get_File_Path sFileName To sFileName
78681>>>>>>>        Move (WP_DrawBitmap(sFileName,iStartX,iStartY,iWidth,iHeight,bUCp)) to bOk
78682>>>>>>>
78682>>>>>>>        If not bOk Begin
78684>>>>>>>            Error DFERR_WINPRINT DFPrintError932
78685>>>>>>>>
78685>>>>>>>        End
78685>>>>>>>>
78685>>>>>>>    End_Procedure
78686>>>>>>>
78686>>>>>>>
78686>>>>>>>    //***
78686>>>>>>>    Procedure DFHeaderLineCheck Integer iLines
78688>>>>>>>        Boolean bOk
78688>>>>>>>
78688>>>>>>>         Move (WP_SetExtraLineCheck(iLines)) To bOk
78689>>>>>>>
78689>>>>>>>        If not bOk begin
78691>>>>>>>            Error DFERR_WINPRINT DFPrintError934
78692>>>>>>>>
78692>>>>>>>        End
78692>>>>>>>>
78692>>>>>>>    End_Procedure
78693>>>>>>>
78693>>>>>>>
78693>>>>>>>    //***
78693>>>>>>>    Procedure DFPrintFlags Integer Flags
78695>>>>>>>        Boolean bOk
78695>>>>>>>
78695>>>>>>>         Move (WP_SetPrintDialogFlags(Flags)) To bOk
78696>>>>>>>
78696>>>>>>>        If not bOk begin
78698>>>>>>>            Error DFERR_WINPRINT DFPrintError935
78699>>>>>>>>
78699>>>>>>>        End
78699>>>>>>>>
78699>>>>>>>    End_Procedure
78700>>>>>>>
78700>>>>>>>
78700>>>>>>>    //*** obsolete and maintained for winprint-I backwards compatibility (maybe should be removed)
78700>>>>>>>    //
78700>>>>>>>    Procedure DFSelectPrinter String sDriver String sDevice String sPort Boolean bUpdate
78702>>>>>>>        Send DFSetDevice sDevice
78703>>>>>>>    End_Procedure
78704>>>>>>>
78704>>>>>>>    //*** Preferred usage for WinprintII
78704>>>>>>>    Procedure DFSetDevice String sDevice
78706>>>>>>>        Boolean bOk
78706>>>>>>>
78706>>>>>>>        Move (WP_SelectPrinter(sDevice)) To bOk
78707>>>>>>>
78707>>>>>>>        If not bOk Begin
78709>>>>>>>            Error DFERR_WINPRINT DFPrintError936
78710>>>>>>>>
78710>>>>>>>        End
78710>>>>>>>>
78710>>>>>>>    End_Procedure
78711>>>>>>>
78711>>>>>>>    Procedure DFPrinterBinFirstPage Integer eBin
78713>>>>>>>        Boolean bOk
78713>>>>>>>
78713>>>>>>>         Move (WP_SetFirstPagePaperSource(eBin)) To bOk
78714>>>>>>>
78714>>>>>>>        If not bOk Begin
78716>>>>>>>            Error DFERR_WINPRINT DFPrintError937
78717>>>>>>>>
78717>>>>>>>        End
78717>>>>>>>>
78717>>>>>>>    End_Procedure
78718>>>>>>>
78718>>>>>>>
78718>>>>>>>    //***
78718>>>>>>>    Function DFGetDFColor Integer iRed Integer iGreen Integer iBlue Returns Integer
78720>>>>>>>        Integer iColor
78720>>>>>>>
78720>>>>>>>         Move (WP_RGBToDFPrintColor(iRed,iGreen,iBlue)) To iColor
78721>>>>>>>
78721>>>>>>>        If (iColor=0) Begin
78723>>>>>>>            Error DFERR_WINPRINT DFPrintError938
78724>>>>>>>>
78724>>>>>>>        End
78724>>>>>>>>
78724>>>>>>>        Function_Return iColor
78725>>>>>>>    End_Function
78726>>>>>>>
78726>>>>>>>
78726>>>>>>>    //***
78726>>>>>>>    Procedure DFSetDFColor Dword dwColor
78728>>>>>>>        Integer bOk
78728>>>>>>>
78728>>>>>>>         Move (WP_SetFontColor(dwColor)) To bOk
78729>>>>>>>
78729>>>>>>>        If not bOk Begin
78731>>>>>>>            Error DFERR_WINPRINT DFPrintError939
78732>>>>>>>>
78732>>>>>>>        End
78732>>>>>>>>
78732>>>>>>>    End_Procedure
78733>>>>>>>
78733>>>>>>>
78733>>>>>>>    //***
78733>>>>>>>    Procedure DFSetTopBottom Number nTop Number nBottom Boolean bAllPages
78735>>>>>>>        Boolean bOk
78735>>>>>>>        Integer iTop iBottom
78735>>>>>>>
78735>>>>>>>        move (nTop*100)    To iTop
78736>>>>>>>        move (nBottom*100) To iBottom
78737>>>>>>>
78737>>>>>>>        Move (WP_SetAbsoluteMargins(iTop,iBottom,bAllPages)) To bOk
78738>>>>>>>
78738>>>>>>>        If Not bOk Begin
78740>>>>>>>            Error DFERR_WINPRINT DFPrintError940
78741>>>>>>>>
78741>>>>>>>        End
78741>>>>>>>>
78741>>>>>>>    End_Procedure
78742>>>>>>>
78742>>>>>>>
78742>>>>>>>    //***
78742>>>>>>>    Procedure DFSetJMode Integer eAlign
78744>>>>>>>        Boolean bOk
78744>>>>>>>
78744>>>>>>>        Move (WP_SetAlign(eAlign)) To bOk
78745>>>>>>>
78745>>>>>>>        If Not bOk Begin
78747>>>>>>>            Error DFERR_WINPRINT DFPrintError941
78748>>>>>>>>
78748>>>>>>>        End
78748>>>>>>>>
78748>>>>>>>    End_Procedure
78749>>>>>>>
78749>>>>>>>
78749>>>>>>>    //***
78749>>>>>>>    Procedure DFWriteEllip Number nStartX Number nStartY Number nHeight Number nWidth ;              Dword dwBColor Dword dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
78751>>>>>>>
78751>>>>>>>        Boolean bOk
78751>>>>>>>        Integer iWeight
78751>>>>>>>        Integer iStartX iStartY iHeight iWidth
78751>>>>>>>
78751>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX To iStartX
78754>>>>>>>        else ;            move (nStartX*100) To iStartX
78756>>>>>>>
78756>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY To iStartY
78759>>>>>>>        else ;            move (nStartY*100) To iStartY
78761>>>>>>>
78761>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
78764>>>>>>>        else ;            move (nWidth*100) To iWidth
78766>>>>>>>
78766>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
78769>>>>>>>        else ;            move (nHeight*100) To iHeight
78771>>>>>>>
78771>>>>>>>        move (nWeight*100) To iWeight
78772>>>>>>>
78772>>>>>>>
78772>>>>>>>        Move (WP_DrawEllipse(iStartX,iStartY,iWidth,iHeight,;                        dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) To bOk
78773>>>>>>>
78773>>>>>>>        If Not bOk Begin
78775>>>>>>>            Error DFERR_WINPRINT DFPrintError942
78776>>>>>>>>
78776>>>>>>>        End
78776>>>>>>>>
78776>>>>>>>    End_Procedure
78777>>>>>>>
78777>>>>>>>
78777>>>>>>>
78777>>>>>>>
78777>>>>>>>    //***
78777>>>>>>>    Procedure DFWriteRect Number nStartX Number nStartY Number nHeight Number nWidth;              Dword dwBColor Dword dwFColor Boolean bFill Number nWeight Boolean bWrap Boolean bUCp
78779>>>>>>>
78779>>>>>>>        Boolean bOk
78779>>>>>>>        Integer iWeight
78779>>>>>>>        Integer iStartX iStartY iHeight iWidth
78779>>>>>>>
78779>>>>>>>        If ((nStartX = -998) or (nStartX = -999));            move nStartX To iStartX
78782>>>>>>>        else ;            move (nStartX*100) To iStartX
78784>>>>>>>
78784>>>>>>>        If ((nStartY = -998) or (nStartY = -999));            move nStartY To iStartY
78787>>>>>>>        else ;            move (nStartY*100) To iStartY
78789>>>>>>>
78789>>>>>>>        If ((nWidth = -998) or (nWidth = -999));            move nWidth To iWidth
78792>>>>>>>        else ;            move (nWidth*100) To iWidth
78794>>>>>>>
78794>>>>>>>        If ((nHeight = -998) or (nHeight = -999));            move nHeight To iHeight
78797>>>>>>>        else ;            move (nHeight*100) To iHeight
78799>>>>>>>
78799>>>>>>>        move (nWeight*100) To iWeight
78800>>>>>>>
78800>>>>>>>        Move (WP_DrawRectangle(iStartX,iStartY,iWidth,iHeight,;                            dwBColor,dwFColor,bFill,iWeight,bUCp,bWrap)) To bOk
78801>>>>>>>
78801>>>>>>>        If Not bOk Begin
78803>>>>>>>            Error DFERR_WINPRINT DFPrintError944
78804>>>>>>>>
78804>>>>>>>        End
78804>>>>>>>>
78804>>>>>>>    End_Procedure
78805>>>>>>>
78805>>>>>>>
78805>>>>>>>
78805>>>>>>>
78805>>>>>>>    //***
78805>>>>>>>    Procedure DFLineCheck Integer iLines
78807>>>>>>>        Boolean bOk
78807>>>>>>>
78807>>>>>>>        Move (WP_ConfirmLines(iLines)) To bOk
78808>>>>>>>
78808>>>>>>>        If Not bOk Begin
78810>>>>>>>            Error DFERR_WINPRINT DFPrintError946
78811>>>>>>>>
78811>>>>>>>        End
78811>>>>>>>>
78811>>>>>>>    End_Procedure
78812>>>>>>>
78812>>>>>>>
78812>>>>>>>    //***
78812>>>>>>>    Procedure DFCreateDiagram Integer eType Integer eFx Number nHeight Number nWidth Integer bXyAxis
78814>>>>>>>        Handle hDiagram
78814>>>>>>>        Integer iWidth iHeight
78814>>>>>>>
78814>>>>>>>        move (nHeight*100) To iHeight
78815>>>>>>>        move (nWidth*100)  To iWidth
78816>>>>>>>
78816>>>>>>>        Set DFCurrent_Color To 0
78817>>>>>>>
78817>>>>>>>        Move (WP_CreateDiagram(eType,eFx,iWidth,iHeight,bXyAxis)) To hDiagram
78818>>>>>>>
78818>>>>>>>        If (hDiagram) Begin
78820>>>>>>>            Error DFERR_WINPRINT DFPrintError947
78821>>>>>>>>
78821>>>>>>>        End
78821>>>>>>>>
78821>>>>>>>        Else Begin
78822>>>>>>>            Set DFCurrent_Diagram To hDiagram
78823>>>>>>>        end
78823>>>>>>>>
78823>>>>>>>    End_Procedure
78824>>>>>>>
78824>>>>>>>
78824>>>>>>>    //***
78824>>>>>>>    Procedure DFDiagram_Item handle hDiagram String sLabel Number nValue;                             Dword dwBColor Dword dwFColor Integer eFill;                             Integer iDec Integer eValueOrPercent Integer eExt
78826>>>>>>>
78826>>>>>>>        Boolean bOk
78826>>>>>>>        Integer iCurrColor iValue
78826>>>>>>>
78826>>>>>>>        If (dwFColor = -1) Begin
78828>>>>>>>            Get DFCurrent_Color To iCurrColor
78829>>>>>>>            Increment iCurrColor
78830>>>>>>>            If (iCurrColor>15) Move 1 To iCurrColor
78833>>>>>>>            Set DFCurrent_Color To iCurrColor
78834>>>>>>>            Get DFGetColor iCurrColor To dwFColor
78835>>>>>>>        End
78835>>>>>>>>
78835>>>>>>>
78835>>>>>>>        Move (nValue *100) to iValue
78836>>>>>>>
78836>>>>>>>        Get ToAnsi sLabel To sLabel
78837>>>>>>>
78837>>>>>>>        Move (WP_AddDiagramEntry(hDiagram,sLabel,iValue,dwBColor,dwFColor,eFill,iDec,eValueorPercent,eExt)) To bOk
78838>>>>>>>
78838>>>>>>>        If not bOk Begin
78840>>>>>>>            Error DFERR_WINPRINT DFPrintError948
78841>>>>>>>>
78841>>>>>>>        End
78841>>>>>>>>
78841>>>>>>>    End_Procedure
78842>>>>>>>
78842>>>>>>>
78842>>>>>>>    //***
78842>>>>>>>    Procedure DFLockDiagram Handle hDiagram
78844>>>>>>>        Boolean bOk
78844>>>>>>>
78844>>>>>>>        Move (WP_LockDiagram(hDiagram)) To bOk
78845>>>>>>>
78845>>>>>>>        If not bOk Begin
78847>>>>>>>            Error DFERR_WINPRINT DFPrintError949
78848>>>>>>>>
78848>>>>>>>        End
78848>>>>>>>>
78848>>>>>>>    End_Procedure
78849>>>>>>>
78849>>>>>>>
78849>>>>>>>
78849>>>>>>>    //***
78849>>>>>>>    Procedure DFDrawDiagram Handle hDiagram Number nYPos Number nXPos Boolean bUCp
78851>>>>>>>        Boolean bOk
78851>>>>>>>        Integer iXPos
78851>>>>>>>        Integer iYPos
78851>>>>>>>
78851>>>>>>>        move (nXPos*100) To iXPos
78852>>>>>>>        move (nYPos*100) To iYPos
78853>>>>>>>
78853>>>>>>>        If nYPos Eq -999 Move -999 To iYPos
78856>>>>>>>
78856>>>>>>>        Move (WP_DrawDiagram(hDiagram,iXPos,iYPos,bUCp)) To bOk
78857>>>>>>>
78857>>>>>>>        If not bOk Begin
78859>>>>>>>            Error DFERR_WINPRINT DFPrintError950
78860>>>>>>>>
78860>>>>>>>        End
78860>>>>>>>>
78860>>>>>>>    End_Procedure
78861>>>>>>>
78861>>>>>>>
78861>>>>>>>
78861>>>>>>>    //***
78861>>>>>>>    Procedure DFDiagramLabel handle hDiagram String sLabel
78863>>>>>>>        Boolean bOk
78863>>>>>>>        Integer iLabelLen
78863>>>>>>>
78863>>>>>>>        Get ToAnsi sLabel To sLabel
78864>>>>>>>
78864>>>>>>>        Move (WP_SetDiagramCaption(hDiagram,sLabel)) To bOk
78865>>>>>>>
78865>>>>>>>        if not bOk Begin
78867>>>>>>>            Error DFERR_WINPRINT DFPrintError952
78868>>>>>>>>
78868>>>>>>>        End
78868>>>>>>>>
78868>>>>>>>    End_Procedure
78869>>>>>>>
78869>>>>>>>
78869>>>>>>>    //***
78869>>>>>>>    Procedure DFDiagramXLabel handle hDiagram String sLabel
78871>>>>>>>        Boolean bOk
78871>>>>>>>        Get ToAnsi sLabel To sLabel
78872>>>>>>>
78872>>>>>>>        Move (WP_SetDiagramXText(hDiagram,sLabel)) To bOk
78873>>>>>>>
78873>>>>>>>        if not bOk Begin
78875>>>>>>>            Error DFERR_WINPRINT DFPrintError953
78876>>>>>>>>
78876>>>>>>>        End
78876>>>>>>>>
78876>>>>>>>    End_Procedure
78877>>>>>>>
78877>>>>>>>
78877>>>>>>>    //***
78877>>>>>>>    Procedure DFDiagramYLabel handle hDiagram String sLabel Boolean bVertical
78879>>>>>>>        Boolean bOk
78879>>>>>>>        Get ToAnsi sLabel To sLabel
78880>>>>>>>
78880>>>>>>>        Move (WP_SetDiagramYText(hDiagram,sLabel,bVertical)) To bOk
78881>>>>>>>
78881>>>>>>>        if not bOk Begin
78883>>>>>>>            Error DFERR_WINPRINT DFPrintError954
78884>>>>>>>>
78884>>>>>>>        End
78884>>>>>>>>
78884>>>>>>>    End_Procedure
78885>>>>>>>
78885>>>>>>>
78885>>>>>>>    //***
78885>>>>>>>    Procedure DFWriteXYLine Number nStartX Number nStartY Number nStopX Number nStopY;              Dword dwColor Number nWeight Boolean bWrap Boolean bUCp
78887>>>>>>>
78887>>>>>>>        Boolean bOk
78887>>>>>>>        Integer iStartX iStartY iStopX iStopY
78887>>>>>>>        Integer iWeight
78887>>>>>>>
78887>>>>>>>        move (nStartX*100)  To iStartX
78888>>>>>>>        move (nStartY*100)  To iStartY
78889>>>>>>>        move (nStopX*100)   To iStopX
78890>>>>>>>        move (nStopY*100)   To iStopY
78891>>>>>>>
78891>>>>>>>        move (nWeight*100) To iWeight
78892>>>>>>>
78892>>>>>>>        If (nStopY  = -998) Move -998 To iStopY
78895>>>>>>>        If (nStopX  = -998) Move -998 To iStopX
78898>>>>>>>
78898>>>>>>>        If (nStartY  = -999) Move -999 To iStartY
78901>>>>>>>        If (nStartX  = -999) Move -999 To iStartX
78904>>>>>>>
78904>>>>>>>        Move (WP_DrawXYLine(iStartX,iStartY,iStopX,iStopY,dwColor,iWeight,bUCp,bWrap)) To bOk
78905>>>>>>>
78905>>>>>>>        if not bOk Begin
78907>>>>>>>            Error DFERR_WINPRINT DFPrintError955
78908>>>>>>>>
78908>>>>>>>        End
78908>>>>>>>>
78908>>>>>>>    End_Procedure
78909>>>>>>>
78909>>>>>>>
78909>>>>>>>    //***
78909>>>>>>>    Procedure DFWriteLine Number nStartX Number nStartY Number nLength;                          Boolean bHorizontal Dword dwColor Number nWeight Boolean bUCp
78911>>>>>>>
78911>>>>>>>        Boolean bOk
78911>>>>>>>        Integer iStartX iStartY iLength
78911>>>>>>>        Integer iWeight
78911>>>>>>>
78911>>>>>>>        move (nStartX*100)  To iStartX
78912>>>>>>>        move (nStartY*100)  To iStartY
78913>>>>>>>        move (nLength*100)  To iLength
78914>>>>>>>        move (nWeight*100)  To iWeight
78915>>>>>>>
78915>>>>>>>        If (nStartY = -999) Move -999 To iStartY
78918>>>>>>>        If (nStartX = -999) Move -999 To iStartX
78921>>>>>>>        If (nLength = -998) Move -998 To iLength
78924>>>>>>>
78924>>>>>>>        Move (WP_DrawLine(iSTartX,iStartY,iLength,bHorizontal,dwColor,iWeight,bUCp)) To bOk
78925>>>>>>>
78925>>>>>>>        if not bOk Begin
78927>>>>>>>            Error DFERR_WINPRINT DFPrintError956
78928>>>>>>>>
78928>>>>>>>        End
78928>>>>>>>>
78928>>>>>>>    End_Procedure
78929>>>>>>>
78929>>>>>>>
78929>>>>>>>    //***
78929>>>>>>>    Procedure DFClearPrinter
78931>>>>>>>        Boolean bOk
78931>>>>>>>
78931>>>>>>>        Move (WP_ClearPrinter()) To bOk
78932>>>>>>>
78932>>>>>>>        If not bOk Begin
78934>>>>>>>            Error DFERR_WINPRINT DFPrintError957
78935>>>>>>>>
78935>>>>>>>        End
78935>>>>>>>>
78935>>>>>>>    End_Procedure
78936>>>>>>>
78936>>>>>>>
78936>>>>>>>
78936>>>>>>>    //***
78936>>>>>>>     Function DFGetCurrentDevice Returns String
78938>>>>>>>        Boolean bOk
78938>>>>>>>        String  sDFStr
78938>>>>>>>        Address pDFStr
78938>>>>>>>
78938>>>>>>>        Move (Repeat( Character(0), 255 )) to sDFStr
78939>>>>>>>        GetAddress of sDFStr to pDFStr
78940>>>>>>>
78940>>>>>>>        Move (WP_GetCurrentDevice(pDFStr)) To bOk
78941>>>>>>>
78941>>>>>>>        If not bOk Begin
78943>>>>>>>            Error DFERR_WINPRINT DFPrintError959
78944>>>>>>>>
78944>>>>>>>        End
78944>>>>>>>>
78944>>>>>>>
78944>>>>>>>        Move (CString(sDFStr)) To sDFStr
78945>>>>>>>        Function_Return sDFStr
78946>>>>>>>     End_Function
78947>>>>>>>
78947>>>>>>>
78947>>>>>>>    // Note: DfGetCurrentPort and DFGetCurrentDriver do not exist in winprint2. Trying to
78947>>>>>>>    //       use these will result in a runtime error (which is good - don't use them)
78947>>>>>>>
78947>>>>>>>
78947>>>>>>>    //***
78947>>>>>>>     Function DFGetPrintDialogFlags Returns Dword
78949>>>>>>>        Dword dwRetVal
78949>>>>>>>
78949>>>>>>>        Move (WP_GetPrintDialogFlags()) To dwRetVal
78950>>>>>>>
78950>>>>>>>        Function_Return dwRetVal
78951>>>>>>>     End_Function
78952>>>>>>>
78952>>>>>>>
78952>>>>>>>    //***
78952>>>>>>>    //*** Returns PRN_TRUE=  if the flag is set     (1)
78952>>>>>>>    //*** Returns PRN_FALSE= If the flag not is set (0)
78952>>>>>>>    //***
78952>>>>>>>     Function DFCheckPrintDialogFlag Dword dwPDFlag Returns Boolean
78954>>>>>>>        Boolean bIsSet
78954>>>>>>>
78954>>>>>>>        Move (WP_IsPrintDialogFlagSet(dwPDFlag)) To bIsSet
78955>>>>>>>
78955>>>>>>>        Function_Return bIsSet
78956>>>>>>>     End_Function
78957>>>>>>>
78957>>>>>>>
78957>>>>>>>    //***
78957>>>>>>>     Procedure DFSetSpecPrintFlag Dword dwPDFlag
78959>>>>>>>        Boolean bOk
78959>>>>>>>
78959>>>>>>>        Move (WP_SetSpecificPrintDialogFlag(dwPDFlag)) To bOk
78960>>>>>>>
78960>>>>>>>        If not bOk Begin
78962>>>>>>>            Error DFERR_WINPRINT DFPrintError961
78963>>>>>>>>
78963>>>>>>>        End
78963>>>>>>>>
78963>>>>>>>     End_Procedure
78964>>>>>>>
78964>>>>>>>
78964>>>>>>>    //***
78964>>>>>>>     Function DFGetUserDefinedLength Returns Number
78966>>>>>>>        Integer iRetVal
78966>>>>>>>        Number  nRetVal
78966>>>>>>>
78966>>>>>>>        Move (WP_GetUserDefinedPapersize()) To iRetVal
78967>>>>>>>
78967>>>>>>>        If (iRetVal=0) Begin
78969>>>>>>>            Error DFERR_WINPRINT DFPrintError962
78970>>>>>>>>
78970>>>>>>>            Function_Return 0
78971>>>>>>>        End
78971>>>>>>>>
78971>>>>>>>
78971>>>>>>>        Move (Hi(iRetVal)) To nRetVal
78972>>>>>>>        move (nRetVal/100) To nRetVal //Returns CM
78973>>>>>>>
78973>>>>>>>        Function_Return nRetVal
78974>>>>>>>     End_Function
78975>>>>>>>
78975>>>>>>>
78975>>>>>>>    //***
78975>>>>>>>     Function DFGetUserDefinedWidth Returns Number
78977>>>>>>>        Integer iRetVal
78977>>>>>>>        Number  nRetVal
78977>>>>>>>
78977>>>>>>>        Move (WP_GetUserDefinedPapersize()) To iRetVal
78978>>>>>>>
78978>>>>>>>        If (iRetVal=0) Begin
78980>>>>>>>            Error DFERR_WINPRINT DFPrintError963
78981>>>>>>>>
78981>>>>>>>            Function_Return 0
78982>>>>>>>        End
78982>>>>>>>>
78982>>>>>>>
78982>>>>>>>        Move (Low(iRetVal)) To nRetVal
78983>>>>>>>        Move (nRetVal/100) To nRetVal //Returns CM
78984>>>>>>>
78984>>>>>>>        Function_Return nRetVal
78985>>>>>>>     End_Function
78986>>>>>>>
78986>>>>>>>
78986>>>>>>>    //*** To be set in CM
78986>>>>>>>     Procedure DFSetUserDefinedPapersize Number nLength Number nWidth
78988>>>>>>>        Integer bOk
78988>>>>>>>        Integer iLength iWidth iSize
78988>>>>>>>
78988>>>>>>>        move (nLength*100) To iLength
78989>>>>>>>        move (nWidth*100)  To iWidth
78990>>>>>>>        move ((iLength*65536)+iWidth) To iSize
78991>>>>>>>
78991>>>>>>>        Move (WP_SetUserDefinedPapersize(iSize)) To bOk
78992>>>>>>>
78992>>>>>>>        If not bOk Begin
78994>>>>>>>            Error DFERR_WINPRINT DFPrintError964
78995>>>>>>>>
78995>>>>>>>        End
78995>>>>>>>>
78995>>>>>>>     End_Procedure
78996>>>>>>>
78996>>>>>>>     Procedure DFSetNumberOfCopies Integer iNrOfCopies
78998>>>>>>>        Boolean bOk
78998>>>>>>>
78998>>>>>>>        Move (WP_SetNumberOfPrintCopies(iNrOfCopies)) to bOk
78999>>>>>>>
78999>>>>>>>        If not bOk Begin
79001>>>>>>>            Error DFERR_WINPRINT DFPrintError965
79002>>>>>>>>
79002>>>>>>>        end
79002>>>>>>>>
79002>>>>>>>     End_Procedure
79003>>>>>>>
79003>>>>>>>
79003>>>>>>>
79003>>>>>>>
79003>>>>>>>    //*************************************************************
79003>>>>>>>    //*** This procedures and functions are used when building  ***
79003>>>>>>>    //*** complex graphics when you need to change value of the ***
79003>>>>>>>    //*** current diagram, so you can mix diagrams within each  ***
79003>>>>>>>    //*** other.                                                ***
79003>>>>>>>    //*************************************************************
79003>>>>>>>
79003>>>>>>>
79003>>>>>>>    Function DFGetCurrentDiagram Returns Integer
79005>>>>>>>        Integer iRetVal
79005>>>>>>>        Get DFCurrent_Diagram To iRetVal
79006>>>>>>>        Function_Return iRetVal
79007>>>>>>>    End_Function
79008>>>>>>>
79008>>>>>>>    Procedure DFSetCurrentDiagram Integer iDiagram
79010>>>>>>>        Set DFCurrent_Diagram To iDiagram
79011>>>>>>>    End_Procedure
79012>>>>>>>
79012>>>>>>>    Procedure DFSetDiagramList Integer iItem Integer iDiagram
79014>>>>>>>        Set Value of oDiagramArray iItem To iDiagram
79015>>>>>>>    End_Procedure
79016>>>>>>>
79016>>>>>>>    Function DFGetDiagramList Integer iItem Returns Integer
79018>>>>>>>        Integer iRetVal
79018>>>>>>>        Get Value of oDiagramArray iItem To iRetVal
79019>>>>>>>        Function_Return iRetVal
79020>>>>>>>    End_Function
79021>>>>>>>
79021>>>>>>>    Procedure DFClearDiagramList
79023>>>>>>>        Send Delete_Data To oDiagramArray
79024>>>>>>>    End_Procedure
79025>>>>>>>
79025>>>>>>>
79025>>>>>>>    Function DFGetColor Integer iColor Returns Dword
79027>>>>>>>        Dword   dwRetVal
79027>>>>>>>        Get Value of oDFColorArray iColor To dwRetVal
79028>>>>>>>        Function_Return dwRetVal
79029>>>>>>>    End_Function
79030>>>>>>>
79030>>>>>>>    Function DFGetCurrentColor Returns Dword
79032>>>>>>>        Dword   dwRetVal
79032>>>>>>>        Integer iCurrColor
79032>>>>>>>
79032>>>>>>>        Get DFCurrent_Color To iCurrColor
79033>>>>>>>        Get DFGetColor iCurrColor To dwRetVal
79034>>>>>>>
79034>>>>>>>        Function_Return dwRetVal
79035>>>>>>>    End_Function
79036>>>>>>>
79036>>>>>>>    Procedure DFEndDocument
79038>>>>>>>        integer iVoid
79038>>>>>>>        Move (WP_EndDocument()) To iVoid
79039>>>>>>>        Send DfSuspendGui False
79040>>>>>>>    End_procedure
79041>>>>>>>
79041>>>>>>>    Procedure DFClosePreview
79043>>>>>>>        integer iVoid
79043>>>>>>>        Move (WP_ClosePreview()) To iVoid
79044>>>>>>>        Send DfSuspendGui False
79045>>>>>>>    End_procedure
79046>>>>>>>
79046>>>>>>>    Procedure SetProgressCaption string sCaption
79048>>>>>>>        integer iVoid
79048>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
79049>>>>>>>        Move (WP_SetProgressCaption(sCaption)) To iVoid
79050>>>>>>>    End_procedure
79051>>>>>>>
79051>>>>>>>    Procedure SetReportTitle string sTitle
79053>>>>>>>        integer iVoid
79053>>>>>>>        Move (ToAnsi(sTitle)) to sTitle
79054>>>>>>>        Move (WP_SetReportTitle(sTitle)) To iVoid
79055>>>>>>>    End_procedure
79056>>>>>>>
79056>>>>>>>    Function PreviewYesNoBox string sCaption string sText returns integer
79058>>>>>>>        integer eResult
79058>>>>>>>        Move (ToAnsi(sCaption)) to sCaption
79059>>>>>>>        Move (ToAnsi(sText))    to sText
79060>>>>>>>        Move (WP_DisplayMessageBox(sCaption, sText)) To eResult
79061>>>>>>>        Function_return eResult
79062>>>>>>>    end_function
79063>>>>>>>
79063>>>>>>>    // internal function, used to extract different printer flags ranges based on
79063>>>>>>>    // the print flag integer. These flags use a decimal style of packing information
79063>>>>>>>    // where different printer options (paper, bin, etc) use different ranges and
79063>>>>>>>    // different steps. Everything above iTopVal is removed and everything that is not
79063>>>>>>>    // within the iStep range is removed.
79063>>>>>>>    Function PrintFlagRange integer iTopVal integer iStep returns integer
79065>>>>>>>        integer iFgs iFg
79065>>>>>>>        Get DFGetPrintDialogFlags to iFg
79066>>>>>>>        Move (mod(iFg,iTopVal) / iStep * iStep ) to iFg
79067>>>>>>>        function_return iFg
79068>>>>>>>    end_Function
79069>>>>>>>
79069>>>>>>>    Procedure DFSetPrinterPaper integer ePaperType
79071>>>>>>>        Send DFSetSpecPrintFlag ePaperType
79072>>>>>>>    End_Procedure
79073>>>>>>>
79073>>>>>>>    Function DFGetPrinterPaper returns integer //ePaperType
79075>>>>>>>        integer ePaperType
79075>>>>>>>        Get PrintFlagRange 500 10 to ePaperType // 10-490 in steps of 10
79076>>>>>>>        function_return ePaperType
79077>>>>>>>    End_Function
79078>>>>>>>
79078>>>>>>>
79078>>>>>>>    Procedure DFSetPrinterBin integer eBinType
79080>>>>>>>        Send DFSetSpecPrintFlag eBinType
79081>>>>>>>    End_Procedure
79082>>>>>>>
79082>>>>>>>    Function DFGetPrinterBin returns integer //eBinType
79084>>>>>>>        integer eBinType
79084>>>>>>>        Get PrintFlagRange 10000 500 to eBinType // 1000-9000 steps 500
79085>>>>>>>        function_return eBinType
79086>>>>>>>    End_Function
79087>>>>>>>
79087>>>>>>>
79087>>>>>>>    Procedure DFSetPrinterResolution integer eResType
79089>>>>>>>        Send DFSetSpecPrintFlag eResType
79090>>>>>>>    End_Procedure
79091>>>>>>>
79091>>>>>>>    Function DFGetPrinterResolution returns integer //eResType
79093>>>>>>>        integer eResType
79093>>>>>>>        Get PrintFlagRange 50000 10000 to eResType // 10000-500000 steps 10000
79094>>>>>>>        function_return eResType
79095>>>>>>>    End_Function
79096>>>>>>>
79096>>>>>>>
79096>>>>>>>    Procedure DFSetLandscape boolean bIsLandscape
79098>>>>>>>        Send DFSetSpecPrintFlag (If(bIsLandscape,DF_Landscape,DF_Portrait))
79099>>>>>>>    End_Procedure
79100>>>>>>>
79100>>>>>>>    Function DFGetLandscape returns boolean // bIsLandscape
79102>>>>>>>        boolean bIsLandscape
79102>>>>>>>        Get DFCheckPrintDialogFlag DF_Landscape to bIsLandscape
79103>>>>>>>        function_return bIsLandscape
79104>>>>>>>    End_Function
79105>>>>>>>
79105>>>>>>>    Function RGBToWPColor integer iRgb returns integer
79107>>>>>>>        integer iRed iGreen iBlue
79107>>>>>>>        integer iWPColor
79107>>>>>>>        Move (R_from_rgb(iRGB)) to iRed
79108>>>>>>>        Move (G_from_rgb(iRGB)) to iGreen
79109>>>>>>>        Move (B_from_rgb(iRGB)) to iBlue
79110>>>>>>>        Get DfGetDfColor iRed iGreen iBlue to iWPColor
79111>>>>>>>        function_Return iWPColor
79112>>>>>>>    end_function
79113>>>>>>>
79113>>>>>>>
79113>>>>>>>
79113>>>>>>>End_Class
79114>>>>>>>
79114>>>>>>>Global_Variable Integer ghoWinPrint2
79114>>>>>>>
79114>>>>>>>Get Create of desktop U_cWinPrint2 to ghoWinPrint2
79115>>>>>>>
79115>>>>>>>
79115>>>>>Use Winprint_Commands.pkg  // commands used by this class
79115>>>>>
79115>>>>>Class cWinReport2 is a BasicReport
79116>>>>>
79116>>>>>    Procedure Construct_Object
79118>>>>>        Forward send construct_object
79120>>>>>
79120>>>>>        Date Today
79120>>>>>        Sysdate Today
79121>>>>>
79121>>>>>        // should use built in DF function CurrentDateTime()
79121>>>>>        Property Date  RptToday    Today
79122>>>>>
79122>>>>>        Object RptTotal is an Array
79124>>>>>        End_Object
79125>>>>>
79125>>>>>        // If true, report is output upon completion. Either preview
79125>>>>>        // or printer depending on output_device_mode
79125>>>>>        Property Boolean AutoOutput_State True
79126>>>>>
79126>>>>>        // When a new page is created (DFNew_Page) and the number
79126>>>>>        // of columns is not passed, this is used.
79126>>>>>        Property Integer Print_Columns 0
79127>>>>>
79127>>>>>        // This determines if a DFNew_Page should be executed when the
79127>>>>>        // report starts. In some rare cases, you would not want this to
79127>>>>>        // occur until a subheader
79127>>>>>        Property Boolean AutoNew_Page_State True
79128>>>>>
79128>>>>>        // Output device (print or preview). Normally this is delegated to
79128>>>>>        // the report view.
79128>>>>>        //
79128>>>>>
79128>>>>>        Property Integer Private.Output_Device_Mode PRINT_TO_UNDEFINED
79129>>>>>
79129>>>>>        Property Handle phoWinPrint  ghoWinPrint2 // the report engine to use.
79130>>>>>
79130>>>>>        // JJT: For now this is for testing.
79130>>>>>        Property boolean pbModalViewer False
79131>>>>>
79131>>>>>        Property boolean pbMultiReports False
79132>>>>>
79132>>>>>        Property boolean pbFirstPagePrinted false
79133>>>>>
79133>>>>>    End_Procedure
79134>>>>>
79134>>>>>    // returns the current status of Winprint Document object. dsNotStarted, dsStarted, dsFinished
79134>>>>>    // note that the status can reflect a status from a different report. The winprint object is global.
79134>>>>>    Function DocumentStatus returns Boolean
79136>>>>>        integer iStatus
79136>>>>>        Get DocumentStatus of (phoWinprint(self)) to iStatus
79137>>>>>        function_return iStatus
79138>>>>>    End_function
79139>>>>>
79139>>>>>    Function IsViewerActive Returns Boolean
79141>>>>>        Boolean bIsActive
79141>>>>>        Get IsViewerActive of (phoWinPrint(Self)) to bIsActive
79142>>>>>        Function_Return bIsActive
79143>>>>>    End_Function
79144>>>>>
79144>>>>>    Function IsPrinterValid Returns Boolean
79146>>>>>        Function_Return (WP_IsPrinterValid()<>0)
79147>>>>>    End_Function
79148>>>>>
79148>>>>>    Function ArePrintersInstalled Returns Boolean
79150>>>>>        Function_Return (WP_ArePrintersInstalled()<>0)
79151>>>>>    End_Function
79152>>>>>
79152>>>>>
79152>>>>>    // All subtotal commands use the outer main report. This makes it easier to keep
79152>>>>>    // track of these numbers
79152>>>>>
79152>>>>>    Procedure Add_SubTotal Integer iCounter Number nData
79154>>>>>        Number nValue
79154>>>>>        Integer iObj
79154>>>>>        Move (RptTotal(Main_Report_Id(Self))) to iObj
79155>>>>>        Get Number_Value of iObj iCounter To nValue
79156>>>>>        Add nData To nValue
79157>>>>>        Set Array_Value of iObj iCounter To nValue
79158>>>>>    End_Procedure
79159>>>>>
79159>>>>>    Procedure Clr_SubTotal Integer iCounter
79161>>>>>        Set Array_Value of (RptTotal(Main_Report_Id(Self))) iCounter To 0
79162>>>>>    End_Procedure
79163>>>>>
79163>>>>>    Procedure Clr_AllSubTotals
79165>>>>>        Send Delete_Data of (RptTotal(Main_Report_Id(Self)))
79166>>>>>    End_Procedure
79167>>>>>
79167>>>>>    Function Sum_SubTotal Integer iTotal Returns Number
79169>>>>>        Number nRetVal
79169>>>>>        Get Number_Value of (RptTotal(Main_Report_Id(Self))) iTotal To nRetVal
79170>>>>>        Function_Return nRetVal
79171>>>>>    End_Function
79172>>>>>
79172>>>>>    //Return sub-total and clear accumulator
79172>>>>>    //
79172>>>>>    Function SubTotal Integer iTotal Returns Number
79174>>>>>        Number nRetVal
79174>>>>>        Get Sum_SubTotal  iTotal to nRetVal
79175>>>>>        Send Clr_SubTotal iTotal
79176>>>>>        Function_Return nRetVal
79177>>>>>    End_Function
79178>>>>>
79178>>>>>
79178>>>>>    // Note: Cols is optional. If no argument is passed it will use
79178>>>>>    //       the object's property Print_Columns (0 by default)
79178>>>>>    //
79178>>>>>    Procedure DFNew_Page Integer Cols
79180>>>>>        Integer PageNumber Columns
79180>>>>>        Boolean bFirstPagePrinted
79180>>>>>        // If no args passed used default setting
79180>>>>>        If (Num_Arguments=0) ;           Move (Print_Columns(Main_Report_id(Self))) to Columns
79183>>>>>        Else ;           Move Cols to Columns
79185>>>>>        Set Page_Feed   to -2   // No FormFeed
79186>>>>>        If (Child_Rpt_State(self)) ;            Send DFNew_Page of (Main_Report_Id(Self)) Columns
79189>>>>>        Else Begin
79190>>>>>            // we only want to print report_header once. When report starts
79190>>>>>            // this is set true, after the first print it is false. You can set
79190>>>>>            // this to true before and explicit dfNew_page to force a header
79190>>>>>            Get pbFirstPagePrinted to bFirstPagePrinted
79191>>>>>            Get  DFNewPage of (phoWinPrint(self)) Columns To PageNumber
79192>>>>>            If (PageNumber<>0) begin // if 0, it failed
79194>>>>>                Set No_PageCheck_State to True
79195>>>>>
79195>>>>>                //Top section
79195>>>>>                Send Page_Top
79196>>>>>                If Not bFirstPagePrinted Send Report_Header
79199>>>>>                Send Page_Header
79200>>>>>                Send Page_Title
79201>>>>>
79201>>>>>                Set New_Page_State to False
79202>>>>>                Set Page_End_State to False
79203>>>>>                Set No_PageCheck_State to False        // No longer Paging
79204>>>>>                Set pbFirstPagePrinted to True
79205>>>>>            End
79205>>>>>>
79205>>>>>        End
79205>>>>>>
79205>>>>>
79205>>>>>        // Footer section
79205>>>>>        //
79205>>>>>        // DO NOT CHANGE THE ORDER OF BOTTOM SECTIONS !!!!!
79205>>>>>        //
79205>>>>>
79205>>>>>        Send Page_Bottom
79206>>>>>
79206>>>>>        // in WinPrint it is not possible to replace Page_Footer
79206>>>>>        // with Report_Footer. If you use Report_Footer you will
79206>>>>>        // have both Page_Footer and Report_Footer
79206>>>>>        //
79206>>>>>        //If LastTime eq 0 Send Page_Footer
79206>>>>>        //else             Send Report_Footer
79206>>>>>
79206>>>>>        Send Page_Footer
79207>>>>>        Send Page_Total
79208>>>>>    End_Procedure
79209>>>>>
79209>>>>>    Procedure Ending_Main_Report
79211>>>>>        Boolean bCancel bMultiReports
79211>>>>>
79211>>>>>        Get Cancelled_state to bCancel
79212>>>>>        Get pbMultiReports to bMultiReports
79213>>>>>
79213>>>>>        Forward Send Ending_Main_Report
79215>>>>>
79215>>>>>        If bCancel Begin
79217>>>>>            Send DFEndDocument
79218>>>>>            Send DFClearDoc // this will also close the previewer
79219>>>>>        end
79219>>>>>>
79219>>>>>        Else Begin
79220>>>>>            Send Report_Footer
79221>>>>>
79221>>>>>            // if multi-reports, we don't do an end of report yet. The programmer must
79221>>>>>            // manually end the report by sending EndMultiReport
79221>>>>>            If (not(bMultiReports)) begin
79223>>>>>                Send EndWinPrintReport
79224>>>>>            end
79224>>>>>>
79224>>>>>
79224>>>>>        end
79224>>>>>>
79224>>>>>
79224>>>>>    End_Procedure
79225>>>>>
79225>>>>>    // This must get called when you are running multiple reports (pbMultiReport).
79225>>>>>    // Send this when the last report is complete.
79225>>>>>    Procedure EndMultiReport
79227>>>>>        Send EndWinPrintReport
79228>>>>>    End_procedure
79229>>>>>
79229>>>>>
79229>>>>>    Procedure EndWinPrintReport
79231>>>>>        Boolean bAutoOutput
79231>>>>>        integer iStatus eMode
79231>>>>>        Get DocumentStatus to iStatus
79232>>>>>        If (iStatus<>dsStarted) procedure_return
79235>>>>>
79235>>>>>        // this tells winprint that the report is complete
79235>>>>>        Send DFEndDocument
79236>>>>>        // if auto-output we print or display automatically.
79236>>>>>        // for winprint2, if in preview mode you must do this so the previewer can enter
79236>>>>>        // a modal state (which it may or may not need to do).
79236>>>>>        Get AutoOutput_state to bAutoOutput
79237>>>>>        Get Output_device_mode to eMode
79238>>>>>        If (bAutoOutput or eMode=PRINT_TO_WINDOW) begin
79240>>>>>            Send PrintReport
79241>>>>>            // if auto output, we assume that you are done when it is all over
79241>>>>>            // we only can do this with the modal viewer
79241>>>>>            If (bAutoOutput and pbModalViewer(self)) begin
79243>>>>>                Send DFClearDoc
79244>>>>>            end
79244>>>>>>
79244>>>>>        end
79244>>>>>>
79244>>>>>
79244>>>>>    End_Procedure
79245>>>>>
79245>>>>>
79245>>>>>    Function Setup_Report Returns Integer
79247>>>>>        Integer iErr iStatus eMode
79247>>>>>        Boolean bActiveViewer bChildReport bMultiReports bOk
79247>>>>>
79247>>>>>        Get Child_rpt_state to bChildReport
79248>>>>>
79248>>>>>        If not bChildReport Begin
79250>>>>>
79250>>>>>            // This makes sure that we are pointing to the new winprint2 engine object.
79250>>>>>            // normally this will be the new winprint, but it can be redirected
79250>>>>>            Get phoWinPrint to WinPrintID
79251>>>>>
79251>>>>>            // winprint must have installed printer. If not installed, generate error and stop the report
79251>>>>>            Get ArePrintersInstalled to bOk
79252>>>>>            If not bOk Begin
79254>>>>>                Error DFERR_WINPRINT C_$NoInstalledPrinters
79255>>>>>>
79255>>>>>                Function_Return 1
79256>>>>>            End
79256>>>>>>
79256>>>>>
79256>>>>>            // check if selected printer is valid. If not, generate error and stop the report
79256>>>>>            Get IsPrinterValid to bOk
79257>>>>>            If not bOk Begin
79259>>>>>                Error DFERR_WINPRINT DFPrintError936    // Could not select a valid printer
79260>>>>>>
79260>>>>>                Function_Return 1
79261>>>>>            End
79261>>>>>>
79261>>>>>
79261>>>>>            // make sure it is ok to start a new report but try to be smart about it.
79261>>>>>            // if a report is active (dsstarted or dsFinished) check to see if it is
79261>>>>>            // finished w/ no viewer. If so, assume the user closed the report and is done
79261>>>>>            // so just clear the report. If a viewer is present, declare an error.
79261>>>>>            Get DocumentStatus to iStatus
79262>>>>>            Get pbMultiReports to bMultiReports
79263>>>>>            // multi-report only in-progress is multi and it is started
79263>>>>>            Move (bMultiReports and iStatus=dsStarted) to bMultiReports
79264>>>>>            If not bMultiReports Begin
79266>>>>>                If (iStatus<>dsNotStarted) Begin
79268>>>>>                    Get IsViewerActive to bActiveViewer
79269>>>>>                    If (iStatus=dsFinished and not(bActiveViewer)) Begin
79271>>>>>                        Send DfClearDoc
79272>>>>>                    End
79272>>>>>>
79272>>>>>                    Else Begin
79273>>>>>                        Error DFERR_WINPRINT DFPrintError967
79274>>>>>>
79274>>>>>                        Function_Return 1
79275>>>>>                    End
79275>>>>>>
79275>>>>>                End
79275>>>>>>
79275>>>>>
79275>>>>>                // all new reports by default allow printing from viewer and they have the print job set up when you select print
79275>>>>>                // if you need to change these defaults, you can change these inside of Starting_main_report
79275>>>>>                // We only do this with non-multi-reports.
79275>>>>>                Send DFSetPrintDlgInPreview      True
79276>>>>>                Send DFSetEnablePrintFromPreview True
79277>>>>>
79277>>>>>            End
79277>>>>>>
79277>>>>>
79277>>>>>            // In the new winprint, this message is not needed and is a stub. For
79277>>>>>            // now it is in here for compatibility purposes
79277>>>>>            //You MUST always start a new report with this procedure
79277>>>>>            Send DFZeroCounters of (phoWinPrint(Self))
79278>>>>>            Send Clr_AllSubTotals
79279>>>>>
79279>>>>>        End
79279>>>>>>
79279>>>>>
79279>>>>>        Forward Get Setup_report to iErr
79281>>>>>
79281>>>>>        If (iErr=0) Begin
79283>>>>>            If not bChildReport Begin
79285>>>>>                // if part of a multi-report we don't do a new doc
79285>>>>>                If not bMultiReports Begin
79287>>>>>                    Get Output_Device_Mode to eMode
79288>>>>>                    Send DFNewDoc of (phoWinPrint(Self))  (eMode = PRINT_TO_WINDOW) // pass True of display while printing
79289>>>>>                End
79289>>>>>>
79289>>>>>                // Do new page if not part of a multi-report and we say don't do a new page
79289>>>>>                If (not(bMultiReports) or AutoNew_Page_State(Self)) Begin
79291>>>>>                    Set pbFirstPagePrinted to False // tells new page that this is the first time for this report
79292>>>>>                    Send DFNew_page
79293>>>>>                End
79293>>>>>>
79293>>>>>            End
79293>>>>>>
79293>>>>>        End
79293>>>>>>
79293>>>>>        Function_Return iErr
79294>>>>>    End_Function
79295>>>>>
79295>>>>>
79295>>>>>
79295>>>>>    // Cancel RO behavior - there is no device to close
79295>>>>>    //
79295>>>>>    Procedure Close_Output_Device
79297>>>>>    End_Procedure
79298>>>>>
79298>>>>>    // Cancel RO Behavior
79298>>>>>    //
79298>>>>>    Procedure Initialize_Output_Device
79300>>>>>    End_procedure
79301>>>>>
79301>>>>>
79301>>>>>    Function Output_Device_Mode Returns Integer
79303>>>>>        Integer hoId
79303>>>>>        String DevMode
79303>>>>>        Get Private.Output_Device_Mode to DevMode
79304>>>>>        If (DevMode=PRINT_TO_UNDEFINED) Begin
79306>>>>>            Get Report_View_Id to hoId
79307>>>>>            If hoID ;                Get OutPut_Device_Mode of hoID to DevMode
79310>>>>>            If (DevMode=PRINT_TO_UNDEFINED) ;                Move PRINT_TO_WINDOW to DevMode
79313>>>>>        End
79313>>>>>>
79313>>>>>        Function_Return DevMode
79314>>>>>    End_Function // Output_Destination
79315>>>>>
79315>>>>>    Procedure Set Output_Device_Mode Integer DevMode
79317>>>>>        Set Private.Output_Device_Mode to DevMode
79318>>>>>    End_Procedure // Set Output_Device
79319>>>>>
79319>>>>>    // displays a metric ruler in .5 increments. This can be
79319>>>>>    // sent to make it easy to see how fields and labels should
79319>>>>>    // be moved for alignment.
79319>>>>>    //
79319>>>>>    Procedure ShowRuler
79321>>>>>        integer i
79321>>>>>        number n
79321>>>>>        for i from 0 to 30
79327>>>>>>
79327>>>>>            Send DFWritePos of (phoWinPrint(self)) (String(i)) FONT_DEFAULT i -1 0
79328>>>>>            Move (i+.5) to n
79329>>>>>            Send DFWritePos of (phoWinPrint(self)) "." FONT_DEFAULT n -1 0
79330>>>>>        Loop
79331>>>>>>
79331>>>>>        Send DFWriteln of (phoWinPrint(self)) ''  FONT_DEFAULT FONT_DEFAULT -1
79332>>>>>    End_procedure
79333>>>>>
79333>>>>>      // status panel related agumentations to handle the auto-previewer
79333>>>>>
79333>>>>>      Procedure Update_Status string sVal
79335>>>>>         Integer eMode
79335>>>>>         Get Output_device_mode to eMode
79336>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
79338>>>>>            Send SetProgressCaption  of (phoWinPrint(self)) sVal
79339>>>>>         End
79339>>>>>>
79339>>>>>         Else Begin
79340>>>>>            forward Send Update_Status sVal
79342>>>>>         end
79342>>>>>>
79342>>>>>      End_Procedure
79343>>>>>
79343>>>>>      Procedure Start_Status
79345>>>>>         Integer eMode
79345>>>>>         string sTitle sCaption
79345>>>>>         Get Output_device_mode to eMode
79346>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
79348>>>>>            Get Report_Caption to sCaption
79349>>>>>            Get Report_Title to sTitle
79350>>>>>            If (sTitle<>"" and sCaption<>"") begin
79352>>>>>                Move ( sCaption- ":" * sTitle) to sTitle
79353>>>>>            end
79353>>>>>>
79353>>>>>            else begin
79354>>>>>                Move (sCaption - sTitle) to sTitle
79355>>>>>            end
79355>>>>>>
79355>>>>>            Send SetReportTitle of (phoWinPrint(self)) sTitle
79356>>>>>         End
79356>>>>>>
79356>>>>>         Else Begin
79357>>>>>            forward Send Start_status
79359>>>>>         end
79359>>>>>>
79359>>>>>      End_Procedure
79360>>>>>
79360>>>>>      Procedure Resume_Status
79362>>>>>         Integer eMode
79362>>>>>         Get Output_device_mode to eMode
79363>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
79365>>>>>            Send DfPreviewNoWait of (phoWinPrint(self))
79366>>>>>         End
79366>>>>>>
79366>>>>>         Else Begin
79367>>>>>            forward Send Resume_Status
79369>>>>>         end
79369>>>>>>
79369>>>>>      End_Procedure
79370>>>>>
79370>>>>>      Procedure End_Status
79372>>>>>         Integer eMode
79372>>>>>         Get Output_device_mode to eMode
79373>>>>>         If (error_processing_state(self)) Begin
79375>>>>>            Send DFClosePreview
79376>>>>>         end
79376>>>>>>
79376>>>>>         If (eMode=PRINT_TO_WINDOW) Begin
79378>>>>>         End
79378>>>>>>
79378>>>>>         Else Begin
79379>>>>>            forward Send End_Status
79381>>>>>         end
79381>>>>>>
79381>>>>>      End_Procedure
79382>>>>>
79382>>>>>    Function Report_Interrupt Returns Integer
79384>>>>>         integer eStat
79384>>>>>         String sMess
79384>>>>>         Boolean bActiveViewer
79384>>>>>         Get IsViewerActive to bActiveViewer
79385>>>>>         If (Error_Check_State(self)) begin
79387>>>>>            Move C_$AnErrorWishToCancel to sMess
79388>>>>>         end
79388>>>>>>
79388>>>>>         Else begin
79389>>>>>            Move  C_$CancelThisReport to sMess
79390>>>>>         end
79390>>>>>>
79390>>>>>         If bActiveViewer Begin
79392>>>>>            Get PreviewYesNoBox of (phoWinPrint(self)) C_$ReportInterrupt sMess to eStat
79393>>>>>         end
79393>>>>>>
79393>>>>>         Else Begin
79394>>>>>            Get YesNo_Box sMess C_$ReportInterrupt to eStat
79395>>>>>         End
79395>>>>>>
79395>>>>>
79395>>>>>         Function_Return (eStat=MBR_YES)
79396>>>>>
79396>>>>>  End_Function
79397>>>>>
79397>>>>>  Function Test_KeyPressed Returns Integer
79399>>>>>     Boolean bStop bError bActiveViewer
79399>>>>>     integer eMode
79399>>>>>     // winreport will do this also, but this makes sure that this gets called
79399>>>>>     // for each body loop -- even if the body loop prints nothing
79399>>>>>     Send PumpMsgQueue of (phoWinPrint(self)) // permit painting
79400>>>>>     Get IsViewerActive to bActiveViewer
79401>>>>>     Get Output_device_mode to eMode
79402>>>>>     If bActiveViewer Begin
79404>>>>>        Get ViewerWantsToClose of (phoWinPrint(self)) to bStop
79405>>>>>        Get Error_Check_State to bError
79406>>>>>        if (bStop or bError) begin
79408>>>>>            Get Report_Interrupt to bStop
79409>>>>>        end
79409>>>>>>
79409>>>>>     end
79409>>>>>>
79409>>>>>     Else Begin
79410>>>>>        Forward Get Test_KeyPressed to bStop
79412>>>>>        If (eMode=PRINT_TO_WINDOW and not(bStop)) Begin
79414>>>>>            Send DfPreviewNoWait
79415>>>>>        end
79415>>>>>>
79415>>>>>     End
79415>>>>>>
79415>>>>>
79415>>>>>     Function_Return bStop
79416>>>>>  End_Function
79417>>>>>
79417>>>>>    Procedure OnClosingView
79419>>>>>        Send DFClearDoc
79420>>>>>    end_procedure
79421>>>>>
79421>>>>>
79421>>>>>    // Attempt to make this as intuitive as possible. You cannot invoke this when a
79421>>>>>    // report is active. If a report is not finished, you cannot do this.
79421>>>>>    // If a report is finsihed it may or may not have a viewer present.
79421>>>>>    // If a viewer is not present, we will clear the exising report (making the assumption
79421>>>>>    // that a modeless viewer was closed and the report will not be invoked again). If a viewer
79421>>>>>    // is active, we will pass this through to the winprint object which will show an error
79421>>>>>
79421>>>>>    Function DFPrintSetupDialog Returns Boolean// invoke printer setup dialog
79423>>>>>        Integer iStatus
79423>>>>>        Boolean bActiveViewer bOk
79423>>>>>        // we must have printers installed for this to work
79423>>>>>        Get ArePrintersInstalled to bOk
79424>>>>>        If not bOk Begin
79426>>>>>            Error DFERR_WINPRINT C_$NoInstalledPrinters
79427>>>>>>
79427>>>>>        End
79427>>>>>>
79427>>>>>        Else Begin
79428>>>>>            Get DocumentStatus to iStatus
79429>>>>>            If (iStatus=dsFinished) Begin
79431>>>>>                Get IsViewerActive to bActiveViewer
79432>>>>>                If not bActiveViewer Begin
79434>>>>>                    Send DfClearDoc
79435>>>>>                End
79435>>>>>>
79435>>>>>            End
79435>>>>>>
79435>>>>>            // the winprint object will generate an error if the status is not dsNotStarted.
79435>>>>>            // we want those errors
79435>>>>>            Get DFPrintSetupDialog of (phoWinPrint(Self)) to bOk
79436>>>>>        End
79436>>>>>>
79436>>>>>        Function_Return bOk
79437>>>>>    End_Procedure
79438>>>>>
79438>>>>>    // It is better to use DFPrintSetupDialog which tells you if the dialog was canceled
79438>>>>>    Procedure DFPrintSetup // invoke printer setup dialog
79440>>>>>        Boolean bOk
79440>>>>>        Get DFPrintSetupDialog to bOk
79441>>>>>    End_Procedure
79442>>>>>
79442>>>>>    Procedure DFClearDoc // clear document, remove viewer
79444>>>>>        Send DFClearDoc of (phoWinPrint(self))
79445>>>>>    end_procedure
79446>>>>>
79446>>>>>    Procedure DFEndDocument // tell winprint that the report is complete
79448>>>>>        Send DfEndDocument of (phoWinPrint(self))
79449>>>>>    end_procedure
79450>>>>>
79450>>>>>    Procedure DFClosePreview //close the previewer, does not clear the document
79452>>>>>        Send DfClosePreview of (phoWinPrint(self))
79453>>>>>    end_procedure
79454>>>>>
79454>>>>>    Procedure DFPrintDialog // popup print job dialog
79456>>>>>        Send DFPrintDialog of (phoWinPrint(self))
79457>>>>>    End_procedure
79458>>>>>
79458>>>>>    Procedure DFPrint // print with printer dialog
79460>>>>>        Send DFPrint of (phoWinPrint(self))
79461>>>>>    End_procedure
79462>>>>>
79462>>>>>    Procedure DFPrintDoc // print without printer dialog
79464>>>>>        Send DFPrintDoc of (phoWinPrint(self))
79465>>>>>    End_Procedure
79466>>>>>
79466>>>>>    Procedure DFPreviewWait // invoke previewer in modal mode
79468>>>>>       Send DFPreviewWait of (phoWinPrint(self))
79469>>>>>    End_Procedure
79470>>>>>
79470>>>>>    Procedure DFPreviewNoWait // invoke previwer in modeless mode
79472>>>>>       Send DFPreviewNoWait of (phoWinPrint(self))
79473>>>>>    End_Procedure
79474>>>>>
79474>>>>>    Procedure DFPreview // invokde previewer based on pbModalViewer property
79476>>>>>       Boolean bModalViewer
79476>>>>>       Get pbModalViewer to bModalViewer
79477>>>>>       If bModalViewer Begin
79479>>>>>           Send DFPreviewWait
79480>>>>>       end
79480>>>>>>
79480>>>>>       else Begin
79481>>>>>           Send DFPreviewNoWait
79482>>>>>       end
79482>>>>>>
79482>>>>>   End_Procedure
79483>>>>>
79483>>>>>    // Print report to appropriate device (printer, preview) based
79483>>>>>    // on output_device_mode
79483>>>>>    //
79483>>>>>    Procedure PrintReport
79485>>>>>        Integer eMode
79485>>>>>        Get OutPut_Device_Mode to eMode
79486>>>>>        If ((eMode=PRINT_TO_WINDOW) or (eMode=DEFERRED_PRINT_TO_WINDOW)) Begin
79488>>>>>           Send DFPreview
79489>>>>>        end
79489>>>>>>
79489>>>>>        Else If (eMode=PRINT_TO_PRINTER_NO_DIALOG) Begin
79492>>>>>           Send DFPrintDoc // print, no print job dialog
79493>>>>>        end
79493>>>>>>
79493>>>>>        Else Begin // (eMode=PRINT_TO_PRINTER)
79494>>>>>           Send DFPrint // print with print job dialog
79495>>>>>        end
79495>>>>>>
79495>>>>>    End_Procedure
79496>>>>>
79496>>>>>
79496>>>>>    Procedure DFSetPrinterPaper integer ePaperType
79498>>>>>        Send DFSetPrinterPaper of (phoWinPrint(self)) ePaperType
79499>>>>>    End_Procedure
79500>>>>>
79500>>>>>    Function DFGetPrinterPaper returns integer //ePaperType
79502>>>>>        integer ePaperType
79502>>>>>        Get DFGetPrinterPaper of (phoWinPrint(self)) to ePaperType
79503>>>>>        Function_return ePaperType
79504>>>>>    end_function
79505>>>>>
79505>>>>>
79505>>>>>    Procedure DFSetPrinterBin integer eBinType
79507>>>>>        Send DFSetPrinterBin of (phoWinPrint(self)) eBinType
79508>>>>>    End_Procedure
79509>>>>>
79509>>>>>    Function DFGetPrinterBin returns integer //eBinType
79511>>>>>        integer eBinType
79511>>>>>        Get DFGetPrinterBin of (phoWinPrint(self)) to eBinType
79512>>>>>        Function_return eBinType
79513>>>>>    end_function
79514>>>>>
79514>>>>>
79514>>>>>    Procedure DFSetPrinterResolution integer eResType
79516>>>>>        Send DFSetPrinterResolution of (phoWinPrint(self)) eResType
79517>>>>>    End_Procedure
79518>>>>>
79518>>>>>    Function DFGetPrinterResolution returns integer //eResType
79520>>>>>        Boolean eResType
79520>>>>>        Get DFGetPrinterResolution of (phoWinPrint(self)) to eResType
79521>>>>>        Function_return eResType
79522>>>>>    end_function
79523>>>>>
79523>>>>>
79523>>>>>    Procedure DFSetLandscape boolean bIsLandscape
79525>>>>>        Send DFSetLandscape of (phoWinPrint(self)) bIsLandscape
79526>>>>>    End_Procedure
79527>>>>>
79527>>>>>    Function DFGetLandscape returns boolean // bIsLandscape
79529>>>>>        Boolean bIsLandscape
79529>>>>>        Get DFGetLandscape of (phoWinPrint(self)) to bIsLandscape
79530>>>>>        Function_return bIsLandscape
79531>>>>>    end_function
79532>>>>>
79532>>>>>    Procedure DFSetMetrics integer eType
79534>>>>>        Send DFSetMetrics of (phoWinPrint(self)) eType
79535>>>>>    End_Procedure
79536>>>>>
79536>>>>>    Function DFGetMetrics returns integer
79538>>>>>        integer eType
79538>>>>>        Get DFGetMetrics of (phoWinPrint(self)) to eType
79539>>>>>        Function_return eType
79540>>>>>    end_function
79541>>>>>
79541>>>>>
79541>>>>>    Procedure DFSetPrintDlgInPreview boolean bShowDialog
79543>>>>>        Set PrintDlgInPreview of (phoWinPrint(self)) to bShowDialog
79544>>>>>    End_Procedure
79545>>>>>
79545>>>>>    Function DFGetPrintDlgInPreview returns boolean
79547>>>>>        boolean bShowDialog
79547>>>>>        Get PrintDlgInPreview of (phoWinPrint(self)) to bShowDialog
79548>>>>>        Function_return bShowDialog
79549>>>>>    end_function
79550>>>>>
79550>>>>>
79550>>>>>    Procedure DFSetEnablePrintFromPreview boolean bEnablePrint
79552>>>>>        Set EnablePrintFromPreview of (phoWinPrint(self)) to bEnablePrint
79553>>>>>    End_Procedure
79554>>>>>
79554>>>>>    Function DFGetEnablePrintFromPreview returns boolean
79556>>>>>        boolean bEnablePrint
79556>>>>>        Get EnablePrintFromPreview of (phoWinPrint(self)) to bEnablePrint
79557>>>>>        Function_return bEnablePrint
79558>>>>>    end_function
79559>>>>>
79559>>>>>
79559>>>>>
79559>>>>>    Procedure DFSetMargins number nLeft number nTop number nRight number nBottom
79561>>>>>        Send DFSetMargins of (phoWinPrint(self)) nLeft nTop nRight nBottom
79562>>>>>    End_Procedure
79563>>>>>
79563>>>>>    Procedure DFSetTopBottom number nTop number nBottom Boolean bAllPages
79565>>>>>        Send DFSetTopBottom of (phoWinPrint(self)) nTop nBottom bAllPages
79566>>>>>    End_Procedure
79567>>>>>
79567>>>>>
79567>>>>>    Procedure DFSetDevice string sPrinterName
79569>>>>>        Send DFSetDevice of (phoWinPrint(self)) sPrinterName
79570>>>>>    End_Procedure
79571>>>>>
79571>>>>>    Function DFGetCurrentDevice returns string // sPrinterName
79573>>>>>        String sPrinterName
79573>>>>>        Get DFGetCurrentDevice of (phoWinPrint(self)) to sPrinterName
79574>>>>>        Function_return sPrinterName
79575>>>>>    end_function
79576>>>>>
79576>>>>>
79576>>>>>    Procedure DFSetUserDefinedPapersize number nLength number nWidth
79578>>>>>        Send DFSetUserDefinedPapersize of (phoWinPrint(self)) nLength nWidth
79579>>>>>    End_Procedure
79580>>>>>
79580>>>>>    Function DFGetUserDefinedLength returns number
79582>>>>>        number nSize
79582>>>>>        Get DFGetUserDefinedLength of (phoWinPrint(self)) to nSize
79583>>>>>        Function_return nSize
79584>>>>>    end_function
79585>>>>>
79585>>>>>    Function DFGetUserDefinedWidth returns number
79587>>>>>        number nSize
79587>>>>>        Get DFGetUserDefinedWidth of (phoWinPrint(self)) to nSize
79588>>>>>        Function_return nSize
79589>>>>>    end_function
79590>>>>>
79590>>>>>
79590>>>>>    Procedure DFSetNumberOfCopies integer iCopies
79592>>>>>        Send DFSetNumberOfCopies of (phoWinPrint(self)) iCopies
79593>>>>>    End_Procedure
79594>>>>>
79594>>>>>    Procedure DFPrinterBinFirstPage integer eBinType
79596>>>>>        Send DFPrinterBinFirstPage of (phoWinPrint(self)) eBinType
79597>>>>>    End_Procedure
79598>>>>>
79598>>>>>    Procedure DFClearPrinter
79600>>>>>        Send DFClearPrinter of (phoWinPrint(self))
79601>>>>>    End_Procedure
79602>>>>>
79602>>>>>    Function DFGetDFColor integer iRed integer iGreen integer iBlue returns integer
79604>>>>>        integer iWPColor
79604>>>>>        Get DFGetDFColor of (phoWinPrint(self)) iRed iGreen iBlue to iWPColor
79605>>>>>        Function_return iWPColor
79606>>>>>    end_function
79607>>>>>
79607>>>>>    Function RGBToWPColor integer iRgb returns integer
79609>>>>>        integer iWPColor
79609>>>>>        Get RGBToWPColor of (phoWinPrint(self)) iRGB to iWPColor
79610>>>>>        Function_return iWPColor
79611>>>>>    end_function
79612>>>>>
79612>>>>>
79612>>>>>End_Class
79613>>>Use Windows.pkg
79613>>>
79613>>>Use cSoforDataDictionary.dd
79613>>>Use cAutoDataDictionary.dd
79613>>>Use cFuvarlevelDataDictionary.dd
79613>>>
79613>>>Use MonthCalendarPrompt.dg
Including file: MonthCalendarPrompt.dg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\MonthCalendarPrompt.dg)
79613>>>>>// Month Calendar Prompt dialog
79613>>>>>
79613>>>>>
79613>>>>>Use cMonthCalendarPrompt.pkg
Including file: cMonthCalendarPrompt.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cMonthCalendarPrompt.pkg)
79613>>>>>>>Use cMonthCalendar.pkg
Including file: cMonthCalendar.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cMonthCalendar.pkg)
79613>>>>>>>>>Use Windows.pkg
79613>>>>>>>>>Use Commctrl.pkg
79613>>>>>>>>>Use tWinStructs.pkg
79613>>>>>>>>>Use cWinControlEx.pkg
Including file: cWinControlEx.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cWinControlEx.pkg)
79613>>>>>>>>>>>Use cWinControl.pkg
79613>>>>>>>>>>>// This adds proper navigation and default button support for
79613>>>>>>>>>>>// external classes
79613>>>>>>>>>>>
79613>>>>>>>>>>>Class cWinControlEx is a cWinControl
79614>>>>>>>>>>>    Import_Class_Protocol Standard_Form_Mixin
79615>>>>>>>>>>>    Procedure Construct_Object
79617>>>>>>>>>>>        Forward Send Construct_Object
79619>>>>>>>>>>>        Send define_standard_Form_Mixin
79620>>>>>>>>>>>    End_Procedure
79621>>>>>>>>>>>    
79621>>>>>>>>>>>    Function item_count Integer iItem Returns Integer
79623>>>>>>>>>>>        Function_Return 1
79624>>>>>>>>>>>    End_Function
79625>>>>>>>>>>>    
79625>>>>>>>>>>>    Procedure External_SetFocus
79627>>>>>>>>>>>        Send notify_focus_change 1
79628>>>>>>>>>>>    End_Procedure
79629>>>>>>>>>>>
79629>>>>>>>>>>>    Procedure External_KillFocus
79631>>>>>>>>>>>        Send notify_focus_change 0
79632>>>>>>>>>>>    End_Procedure
79633>>>>>>>>>>>
79633>>>>>>>>>>>    Procedure End_Construct_Object
79635>>>>>>>>>>>        Forward Send End_Construct_Object
79637>>>>>>>>>>>        Set External_Message WM_SETFOCUS  to External_SetFocus
79638>>>>>>>>>>>        Set External_Message WM_KILLFOCUS to External_KillFocus
79639>>>>>>>>>>>    End_Procedure
79640>>>>>>>>>>>        
79640>>>>>>>>>>>End_Class
79641>>>>>>>>>>>
79641>>>>>>>>>
79641>>>>>>>>>Class cMonthCalendar is a cWinControlEx
79642>>>>>>>>>    Procedure Construct_Object
79644>>>>>>>>>        Integer iResult
79644>>>>>>>>>        tWinInitCommonControlsEX InitCC
79644>>>>>>>>>        tWinInitCommonControlsEX InitCC
79644>>>>>>>>>
79644>>>>>>>>>        Forward Send Construct_Object
79646>>>>>>>>>
79646>>>>>>>>>        Move (SizeOfType (tWinInitCommonControlsEX)) to InitCC.dwSize
79647>>>>>>>>>        Move ICC_DATE_CLASSES to InitCC.dwICC
79648>>>>>>>>>        Move (InitCommonControlsEx(AddressOf(InitCC))) to iResult
79649>>>>>>>>>        
79649>>>>>>>>>        Set External_Class_Name 'cMonthCalendar' to 'SysMonthCal32'
79650>>>>>>>>>        Set External_Message WM_LBUTTONDBLCLK to msg_OnLButtonDblClick
79651>>>>>>>>>        
79651>>>>>>>>>        Set Border_Style to Border_Normal
79652>>>>>>>>>        
79652>>>>>>>>>        Property Boolean pbNoToday False
79653>>>>>>>>>        Property Boolean pbNoTodayCircle False
79654>>>>>>>>>        Property Boolean pbMultiSelect False
79655>>>>>>>>>        Property Boolean pbWeekNumbers False
79656>>>>>>>>>        Property Integer piMaxSelectedCount 90
79657>>>>>>>>>        
79657>>>>>>>>>        // this is minimum Dialog units required for a single picker rectangle
79657>>>>>>>>>        Property Integer piMinWidth 0
79658>>>>>>>>>        Property Integer piMinHeight 0
79659>>>>>>>>>
79659>>>>>>>>>        // stores initial date before control is activated
79659>>>>>>>>>        Property Date pdPrivateDate 
79660>>>>>>>>>        // if multi-select, this is the end range
79660>>>>>>>>>        Property Date pdPrivateDate2 
79661>>>>>>>>>        
79661>>>>>>>>>    End_Procedure
79662>>>>>>>>>    
79662>>>>>>>>>    // returns control's value when single select
79662>>>>>>>>>    Function SelectedDate Returns Date
79664>>>>>>>>>        tWinSystemTime CurrentSystemTime
79664>>>>>>>>>        tWinSystemTime CurrentSystemTime
79664>>>>>>>>>        Integer iRetval
79664>>>>>>>>>        DateTime dtSel
79664>>>>>>>>>        Handle hWnd
79664>>>>>>>>>        Get Window_Handle to hWnd
79665>>>>>>>>>        If (hWnd) Begin
79667>>>>>>>>>            Move (Windows_Message (MCM_GETCURSEL, 0, AddressOf (CurrentSystemTime))) to iRetval
79668>>>>>>>>>            Move (DateSetDay(dtSel,CurrentSystemTime.wDay)) to dtSel
79669>>>>>>>>>            Move (DateSetMonth(dtSel,CurrentSystemTime.wMonth)) to dtSel
79670>>>>>>>>>            Move (DateSetYear(dtSel,CurrentSystemTime.wYear)) to dtSel
79671>>>>>>>>>        End
79671>>>>>>>>>>
79671>>>>>>>>>        Else Begin
79672>>>>>>>>>            Get pdPrivateDate to dtSel
79673>>>>>>>>>        End
79673>>>>>>>>>>
79673>>>>>>>>>        Function_Return (Date(dtSel))
79674>>>>>>>>>    End_Function
79675>>>>>>>>>
79675>>>>>>>>>    // returns control's values when multi select
79675>>>>>>>>>    Function SelectedDateRange Returns Date[]
79677>>>>>>>>>        tWinSystemTime[2] CurrentSystemTime
79677>>>>>>>>>        tWinSystemTime[2] CurrentSystemTime
79678>>>>>>>>>        Integer iRetval
79678>>>>>>>>>        DateTime dtSel1 dtsel2
79678>>>>>>>>>        Date[] dtSel
79679>>>>>>>>>        Handle hWnd
79679>>>>>>>>>        Get Window_Handle to hWnd
79680>>>>>>>>>        If (hWnd) Begin
79682>>>>>>>>>            Move (Windows_Message (MCM_GETSELRANGE, 0, AddressOf (CurrentSystemTime))) to iRetval
79683>>>>>>>>>            
79683>>>>>>>>>            Move (DateSetDay(dtSel1,CurrentSystemTime[0].wDay)) to dtSel1
79684>>>>>>>>>            Move (DateSetMonth(dtSel1,CurrentSystemTime[0].wMonth)) to dtSel1
79685>>>>>>>>>            Move (DateSetYear(dtSel1,CurrentSystemTime[0].wYear)) to dtSel1
79686>>>>>>>>>            
79686>>>>>>>>>            Move (DateSetDay(dtSel2,CurrentSystemTime[1].wDay)) to dtSel2
79687>>>>>>>>>            Move (DateSetMonth(dtSel2,CurrentSystemTime[1].wMonth)) to dtSel2
79688>>>>>>>>>            Move (DateSetYear(dtSel2,CurrentSystemTime[1].wYear)) to dtSel2
79689>>>>>>>>>            
79689>>>>>>>>>            Move dtSel1 to dtSel[0]
79690>>>>>>>>>            Move dtsel2 to dtSel[1]
79691>>>>>>>>>        End
79691>>>>>>>>>>
79691>>>>>>>>>        Else Begin
79692>>>>>>>>>            Get pdPrivateDate to dtSel[0]
79693>>>>>>>>>            Get pdPrivateDate2 to dtSel[1]
79694>>>>>>>>>        End
79694>>>>>>>>>>
79694>>>>>>>>>        Function_Return dtSel
79695>>>>>>>>>    End_Function
79696>>>>>>>>>
79696>>>>>>>>>    // Set control's value when single select
79696>>>>>>>>>    Procedure SetSelectedDate Date dDate
79698>>>>>>>>>        tWinSystemTime CurrentSystemTime
79698>>>>>>>>>        tWinSystemTime CurrentSystemTime
79698>>>>>>>>>        Integer iRetval
79698>>>>>>>>>        Handle hWnd
79698>>>>>>>>>        
79698>>>>>>>>>        Get Window_Handle to hWnd
79699>>>>>>>>>        Set pdPrivateDate to dDate
79700>>>>>>>>>        If (hWnd) Begin
79702>>>>>>>>>            Move (DateGetDay(dDate)) to CurrentSystemTime.wDay
79703>>>>>>>>>            Move (DateGetMonth(dDate)) to CurrentSystemTime.wMonth
79704>>>>>>>>>            Move (DateGetYear(dDate)) to CurrentSystemTime.wYear
79705>>>>>>>>>    
79705>>>>>>>>>           Move (Windows_Message (MCM_SETCURSEL, 0, AddressOf (CurrentSystemTime))) to iRetval        
79706>>>>>>>>>        End
79706>>>>>>>>>>
79706>>>>>>>>>    End_Procedure
79707>>>>>>>>>
79707>>>>>>>>>    // Set control's values when multi select
79707>>>>>>>>>    Procedure SetSelectedDateRange Date dDate Date dDate2
79709>>>>>>>>>        tWinSystemTime[] CurrentSystemTime
79709>>>>>>>>>        tWinSystemTime[] CurrentSystemTime
79710>>>>>>>>>        Integer iRetval
79710>>>>>>>>>        Handle hWnd
79710>>>>>>>>>
79710>>>>>>>>>        Get Window_Handle to hWnd
79711>>>>>>>>>        Set pdPrivateDate to dDate
79712>>>>>>>>>        Set pdPrivateDate2 to dDate2
79713>>>>>>>>>        If (hWnd) Begin
79715>>>>>>>>>            Move (DateGetDay(dDate)) to CurrentSystemTime[0].wDay
79716>>>>>>>>>            Move (DateGetMonth(dDate)) to CurrentSystemTime[0].wMonth
79717>>>>>>>>>            Move (DateGetYear(dDate)) to CurrentSystemTime[0].wYear
79718>>>>>>>>>
79718>>>>>>>>>            Move (DateGetDay(dDate2)) to CurrentSystemTime[1].wDay
79719>>>>>>>>>            Move (DateGetMonth(dDate2)) to CurrentSystemTime[1].wMonth
79720>>>>>>>>>            Move (DateGetYear(dDate2)) to CurrentSystemTime[1].wYear
79721>>>>>>>>>    
79721>>>>>>>>>            Move (Windows_Message (MCM_SETSELRANGE, 0, AddressOf (CurrentSystemTime))) to iRetval        
79722>>>>>>>>>        End
79722>>>>>>>>>>
79722>>>>>>>>>    End_Procedure
79723>>>>>>>>>    
79723>>>>>>>>>    // augment to set dates from control, so they can be accessed after the control is closed
79723>>>>>>>>>    Procedure Remove_Object
79725>>>>>>>>>        Date[] SelDate 
79726>>>>>>>>>        If (pbMultiSelect(Self)) Begin
79728>>>>>>>>>            Get SelectedDateRange to SelDate
79729>>>>>>>>>            Set pdPrivateDate2 to SelDate[1]
79730>>>>>>>>>        End
79730>>>>>>>>>>
79730>>>>>>>>>        Else Begin
79731>>>>>>>>>            Get SelectedDate to SelDate[0]
79732>>>>>>>>>        End
79732>>>>>>>>>>
79732>>>>>>>>>        Set pdPrivateDate to SelDate[0]
79733>>>>>>>>>        Forward Send Remove_Object
79735>>>>>>>>>    End_Procedure
79736>>>>>>>>>
79736>>>>>>>>>    Procedure Page Integer iState
79738>>>>>>>>>        Integer iRetval iSize iHeight iWidth
79738>>>>>>>>>        tWinRect WindowRect
79738>>>>>>>>>        tWinRect WindowRect
79738>>>>>>>>>        Date dDate dDate2
79738>>>>>>>>>        Handle hWnd
79738>>>>>>>>>        Integer  iMaxSelectedCount
79738>>>>>>>>>        Boolean bNoToday bWeekNumbers bMultiSelect bNoTodayCircle
79738>>>>>>>>>        
79738>>>>>>>>>        If (iState<>1) Begin
79740>>>>>>>>>            Forward Send Page iState
79742>>>>>>>>>            Procedure_Return
79743>>>>>>>>>        End
79743>>>>>>>>>>
79743>>>>>>>>>        
79743>>>>>>>>>        Set Icon to 'ActionCalendar.ico'
79744>>>>>>>>>
79744>>>>>>>>>        Get pbNoToday to bNoToday
79745>>>>>>>>>        Get pbNoTodayCircle to bNoTodayCircle
79746>>>>>>>>>        Get pbMultiSelect to bMultiSelect
79747>>>>>>>>>        Get pbWeekNumbers to bWeekNumbers
79748>>>>>>>>>        Get piMaxSelectedCount to iMaxSelectedCount
79749>>>>>>>>>
79749>>>>>>>>>        Set Window_Style MCS_MULTISELECT to bMultiSelect
79750>>>>>>>>>        Set Window_Style MCS_NOTODAY to bNoToday
79751>>>>>>>>>        Set Window_Style MCS_NOTODAYCIRCLE to bNoTodayCircle
79752>>>>>>>>>        Set Window_Style MCS_WEEKNUMBERS to bWeekNumbers
79753>>>>>>>>>        Forward Send Page iState
79755>>>>>>>>>
79755>>>>>>>>>        Get Window_Handle to hWnd
79756>>>>>>>>>        // support double click
79756>>>>>>>>>        Move (SetClassLong(hWnd,GCL_STYLE,CS_DBLCLKS ior CS_GLOBALCLASS)) to iRetval
79757>>>>>>>>>        // set range when multi select
79757>>>>>>>>>        Move (Windows_Message(MCM_SETMAXSELCOUNT,iMaxSelectedCount,0)) to iRetval
79758>>>>>>>>>        
79758>>>>>>>>>        // store minimum size for calendar control and set the size to this by default
79758>>>>>>>>>        Move (Windows_Message (MCM_GETMINREQRECT, 0, AddressOf(WindowRect))) to iRetval
79759>>>>>>>>>        Get GuiToDialog WindowRect.bottom WindowRect.right to iSize
79760>>>>>>>>>        Move (Hi(iSize)) to iHeight
79761>>>>>>>>>        Move (Low(iSize)) to iWidth
79762>>>>>>>>>        Set piMinWidth to iWidth
79763>>>>>>>>>        Set piMinHeight to iHeight
79764>>>>>>>>>        Set Size to iHeight iWidth
79765>>>>>>>>>        
79765>>>>>>>>>        // now that we are activated set starting date or date range
79765>>>>>>>>>        Get pdPrivateDate to dDate
79766>>>>>>>>>        If (pbMultiSelect(Self)) Begin
79768>>>>>>>>>            Get pdPrivateDate2 to dDate2
79769>>>>>>>>>            Send SetSelectedDateRange dDate dDate2
79770>>>>>>>>>        End
79770>>>>>>>>>>
79770>>>>>>>>>        Else Begin
79771>>>>>>>>>            Send SetSelectedDate dDate
79772>>>>>>>>>        End
79772>>>>>>>>>>
79772>>>>>>>>>    End_Procedure
79773>>>>>>>>>
79773>>>>>>>>>    Procedure Notify Integer wParam Integer lParam
79775>>>>>>>>>        Integer iRetval
79775>>>>>>>>>        DateTime dtSel dtSel2
79775>>>>>>>>>        tWintagNMSelChange CalenderInfo
79775>>>>>>>>>        tWintagNMSelChange CalenderInfo
79775>>>>>>>>>        Boolean bMulti
79775>>>>>>>>>        
79775>>>>>>>>>        Move (MemCopy (AddressOf (CalenderInfo), lParam, SizeOfType (tWintagNMSelChange))) to iRetval
79776>>>>>>>>>        If (CalenderInfo.nmHdr.code = MCN_SELCHANGE) Begin
79778>>>>>>>>>            Get pbMultiSelect to bMulti
79779>>>>>>>>>            Move (DateSetDay(dtSel,CalenderInfo.stSelStart.wDay)) to dtSel
79780>>>>>>>>>            Move (DateSetMonth(dtSel,CalenderInfo.stSelStart.wMonth)) to dtSel
79781>>>>>>>>>            Move (DateSetYear(dtSel,CalenderInfo.stSelStart.wYear)) to dtSel
79782>>>>>>>>>            If bMulti Begin
79784>>>>>>>>>                Move (DateSetDay(dtSel,CalenderInfo.stSelEnd.wDay)) to dtSel2
79785>>>>>>>>>                Move (DateSetMonth(dtSel,CalenderInfo.stSelEnd.wMonth)) to dtSel2
79786>>>>>>>>>                Move (DateSetYear(dtSel,CalenderInfo.stSelEnd.wYear)) to dtSel2
79787>>>>>>>>>            End
79787>>>>>>>>>>
79787>>>>>>>>>            Send OnChange (Date(dtSel)) (Date(dtSel2))
79788>>>>>>>>>        End
79788>>>>>>>>>>
79788>>>>>>>>>    End_Procedure
79789>>>>>>>>>
79789>>>>>>>>>    // sent whenever there is a selection change within the calendar
79789>>>>>>>>>    Procedure OnChangeDate Date dDate Date dDate2
79791>>>>>>>>>    End_Procedure
79792>>>>>>>>>
79792>>>>>>>>>    // sent when a click occurs in the calendar 
79792>>>>>>>>>    Procedure OnClick
79794>>>>>>>>>    End_Procedure
79795>>>>>>>>>    
79795>>>>>>>>>    // sent when a double click occurs in the calendar 
79795>>>>>>>>>    Procedure OnDoubleClick
79797>>>>>>>>>    End_Procedure
79798>>>>>>>>>    
79798>>>>>>>>>    // sends OnClick if the double click is on a calendar day
79798>>>>>>>>>    Procedure OnLButtonDblClick Integer wParam Integer lParam
79800>>>>>>>>>        Boolean bDayHit
79800>>>>>>>>>        Get MonthDayHit to bDayHit
79801>>>>>>>>>        If bDayHit Begin
79803>>>>>>>>>            Send OnDoubleClick
79804>>>>>>>>>        End
79804>>>>>>>>>>
79804>>>>>>>>>    End_Procedure
79805>>>>>>>>>
79805>>>>>>>>>    // sends OnClick if the click is on a calendar day
79805>>>>>>>>>    Procedure OnWmLButtonUp Integer wParam Integer lParam
79807>>>>>>>>>        Boolean bDayHit
79807>>>>>>>>>        Get MonthDayHit to bDayHit
79808>>>>>>>>>        If bDayHit Begin
79810>>>>>>>>>            Send OnClick
79811>>>>>>>>>        End
79811>>>>>>>>>>
79811>>>>>>>>>    End_Procedure
79812>>>>>>>>>    
79812>>>>>>>>>    // returns true if the month calander is up and the mouse is over a day
79812>>>>>>>>>    Function MonthDayHit Returns Boolean
79814>>>>>>>>>        Integer iRet
79814>>>>>>>>>        Get Windows_Message MCM_GETCURRENTVIEW 0 0 to iRet
79815>>>>>>>>>        If (iRet=MCMV_MONTH) Begin
79817>>>>>>>>>            Get HitTest to iRet
79818>>>>>>>>>            Function_Return (iRet=MCHT_CALENDARDATE)
79819>>>>>>>>>        End
79819>>>>>>>>>>
79819>>>>>>>>>        Function_Return False
79820>>>>>>>>>    End_Function
79821>>>>>>>>>    
79821>>>>>>>>>    // return what was hit in the control
79821>>>>>>>>>    Function HitTest Returns Integer
79823>>>>>>>>>        tWinMCHitTestInfo HitInfo
79823>>>>>>>>>        tWinMCHitTestInfo HitInfo
79823>>>>>>>>>        Handle hWnd iRet
79823>>>>>>>>>        Integer iVoid
79823>>>>>>>>>        Pointer lpPt
79823>>>>>>>>>        tWinPoint Pt
79823>>>>>>>>>        tWinPoint Pt
79823>>>>>>>>>        Get Window_Handle to hWnd
79824>>>>>>>>>        Move (AddressOf(Pt)) to lpPt
79825>>>>>>>>>        Move (GetCursorPos(lpPt)) to iVoid
79826>>>>>>>>>        Move (ScreenToClient(hWnd, lpPt)) to iVoid
79827>>>>>>>>>        Move Pt to HitInfo.Pt
79828>>>>>>>>>        Move (SizeOfType(tWinMCHitTestInfo)) to HitInfo.cbSize
79829>>>>>>>>>        Get WindowsMessage MCM_HITTEST 0 (AddressOf(HitInfo)) to iRet
79830>>>>>>>>>        Function_Return HitInfo.uHit
79831>>>>>>>>>    End_Function
79832>>>>>>>>>    
79832>>>>>>>>>End_Class
79833>>>>>>>
79833>>>>>>>// peMouseSelectOk choices
79833>>>>>>>Enum_List
79833>>>>>>>    Define msoClick
79833>>>>>>>    Define msoDblClick
79833>>>>>>>    Define msoNone
79833>>>>>>>End_Enum_List
79833>>>>>>>
79833>>>>>>>// It is expected that this class will only be used inside of ModalPanel and
79833>>>>>>>// will be used as a prompt object component in a framework style application.
79833>>>>>>>// If you wish to Use a month calendar in some other non prompt situation, 
79833>>>>>>>// use cMonthCalendar
79833>>>>>>>
79833>>>>>>>Class cMonthCalendarPrompt is a cMonthCalendar
79834>>>>>>>
79834>>>>>>>    Procedure Construct_Object
79836>>>>>>>
79836>>>>>>>        Forward Send Construct_Object
79838>>>>>>>
79838>>>>>>>        Property Integer peUpdateMode umPromptValue
79839>>>>>>>
79839>>>>>>>        Property Integer peMouseSelectOk msoClick
79840>>>>>>>        
79840>>>>>>>        Property Date pdSeedValue
79841>>>>>>>
79841>>>>>>>        // if multi-select, this is the end range
79841>>>>>>>        Property Date pdSeedValue2
79842>>>>>>>
79842>>>>>>>        Property Handle phmPromptUpdateCallback 0
79843>>>>>>>
79843>>>>>>>        Property Integer phoInvokingObject
79844>>>>>>>        
79844>>>>>>>        Property Integer peStoredUpdateMode
79845>>>>>>>        Property Handle  phmStoredPromptUpdateCallback
79846>>>>>>>        Property Boolean pbStoredWeekNumbers
79847>>>>>>>        Property Boolean pbStoredNoToday
79848>>>>>>>        Property Boolean pbStoredNoTodayCircle
79849>>>>>>>        Property Boolean pbStoredMultiSelect
79850>>>>>>>        Property Integer piStoredMaxSelectedCount
79851>>>>>>>        Property Integer peStoredpeMouseSelectOk
79852>>>>>>>
79852>>>>>>>        // internally set by list
79852>>>>>>>        // these must be set upon closing the list and can be used for manual list updates
79852>>>>>>>        Property Boolean pbCanceled
79853>>>>>>>
79853>>>>>>>    End_Procedure
79854>>>>>>>        
79854>>>>>>>    Procedure OnStoreDefaults
79856>>>>>>>        Integer iVal
79856>>>>>>>        Boolean bVal
79856>>>>>>>
79856>>>>>>>        Get peUpdateMode to iVal
79857>>>>>>>        Set peStoredUpdateMode to iVal
79858>>>>>>>        
79858>>>>>>>        Get phmPromptUpdateCallback to iVal       
79859>>>>>>>        Set phmStoredPromptUpdateCallback to iVal       
79860>>>>>>>
79860>>>>>>>        Get pbMultiSelect to bVal       
79861>>>>>>>        Set pbStoredMultiSelect to bVal       
79862>>>>>>>
79862>>>>>>>        Get pbNoToday to bVal       
79863>>>>>>>        Set pbStoredNoToday to bVal       
79864>>>>>>>
79864>>>>>>>        Get pbNoTodayCircle to bVal       
79865>>>>>>>        Set pbStoredNoTodayCircle to bVal       
79866>>>>>>>
79866>>>>>>>        Get pbWeekNumbers to bVal       
79867>>>>>>>        Set pbStoredWeekNumbers to bVal       
79868>>>>>>>
79868>>>>>>>        Get piMaxSelectedCount to iVal       
79869>>>>>>>        Set piStoredMaxSelectedCount to iVal  
79870>>>>>>>        
79870>>>>>>>        Get peMouseSelectOk to iVal       
79871>>>>>>>        Set peStoredpeMouseSelectOk to iVal       
79872>>>>>>>        
79872>>>>>>>    End_Procedure
79873>>>>>>>
79873>>>>>>>    Procedure OnRestoreDefaults
79875>>>>>>>        Integer iVal
79875>>>>>>>        Boolean bVal
79875>>>>>>>
79875>>>>>>>        Get peStoredUpdateMode to iVal
79876>>>>>>>        Set peUpdateMode to iVal
79877>>>>>>>        
79877>>>>>>>        Get phmStoredPromptUpdateCallback to iVal       
79878>>>>>>>        Set phmPromptUpdateCallback to iVal       
79879>>>>>>>
79879>>>>>>>        Get pbStoredMultiSelect to bVal       
79880>>>>>>>        Set pbMultiSelect to bVal       
79881>>>>>>>
79881>>>>>>>        Get pbStoredNoToday to bVal       
79882>>>>>>>        Set pbNoToday to bVal       
79883>>>>>>>
79883>>>>>>>        Get pbStoredNoTodayCircle to bVal       
79884>>>>>>>        Set pbNoTodayCircle to bVal       
79885>>>>>>>
79885>>>>>>>        Get pbStoredWeekNumbers to bVal       
79886>>>>>>>        Set pbWeekNumbers to bVal       
79887>>>>>>>
79887>>>>>>>        Get piStoredMaxSelectedCount to iVal       
79888>>>>>>>        Set piMaxSelectedCount to iVal       
79889>>>>>>>
79889>>>>>>>        Get peStoredpeMouseSelectOk to iVal       
79890>>>>>>>        Set peMouseSelectOk to iVal       
79891>>>>>>>
79891>>>>>>>    End_Procedure
79892>>>>>>>
79892>>>>>>>    Procedure Add_Focus Handle hoParent Returns Integer
79894>>>>>>>        Integer eMode
79894>>>>>>>        Set pbCanceled to True // assume cancel unless changed
79895>>>>>>>        Get peUpdateMode to eMode
79896>>>>>>>        If (eMode<>umPromptNonInvoking) Begin
79898>>>>>>>            Send OnStoreDefaults
79899>>>>>>>        End
79899>>>>>>>>
79899>>>>>>>        Send InitializePrompt
79900>>>>>>>        Forward Send Add_Focus hoParent
79902>>>>>>>    End_Procedure
79903>>>>>>>        
79903>>>>>>>    // augment to send OnRestoreDefaults.
79903>>>>>>>    Procedure Release_Focus
79905>>>>>>>        Integer eUpdateMode
79905>>>>>>>        Get peUpdateMode to eUpdateMode
79906>>>>>>>        Forward Send Release_Focus
79908>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
79910>>>>>>>            Send OnRestoreDefaults
79911>>>>>>>        End
79911>>>>>>>>
79911>>>>>>>    End_Procedure
79912>>>>>>>
79912>>>>>>>    // This is only called in a successful close
79912>>>>>>>    Procedure ClosePrompt
79914>>>>>>>        Handle hoInvokingObject
79914>>>>>>>        Handle hmCallBack
79914>>>>>>>        Integer eUpdateMode
79914>>>>>>>        Date[] dDates
79915>>>>>>>        
79915>>>>>>>        Set pbCanceled to False
79916>>>>>>>        
79916>>>>>>>        Get peUpdateMode to eUpdateMode
79917>>>>>>>        // if non-invoking there is by definition, no move value out
79917>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
79919>>>>>>>            
79919>>>>>>>            If (eUpdateMode=umPromptValue) Begin
79921>>>>>>>                Send OnMoveValueOutByValue
79922>>>>>>>            End
79922>>>>>>>>
79922>>>>>>>            Else If (eUpdateMode=umPromptCustom) Begin
79925>>>>>>>                Send OnMoveValueOutByCustom
79926>>>>>>>            End
79926>>>>>>>>
79926>>>>>>>            Get phmPromptUpdateCallback to hmCallBack
79927>>>>>>>            If hmCallBack Begin
79929>>>>>>>                Get phoInvokingObject to hoInvokingObject
79930>>>>>>>                If (pbMultiSelect(Self)) Begin
79932>>>>>>>                    Get SelectedDateRange to dDates
79933>>>>>>>                    Send hmCallBack of hoInvokingObject Self dDates[0] dDates[1]
79934>>>>>>>                    
79934>>>>>>>                End
79934>>>>>>>>
79934>>>>>>>                Else Begin
79935>>>>>>>                    Get SelectedDate to dDates[0]
79936>>>>>>>                    Send hmCallBack of hoInvokingObject Self dDates[0]
79937>>>>>>>                End
79937>>>>>>>>
79937>>>>>>>            End
79937>>>>>>>>
79937>>>>>>>        End
79937>>>>>>>>
79937>>>>>>>
79937>>>>>>>        Send Close_Panel
79938>>>>>>>    End_Procedure
79939>>>>>>>
79939>>>>>>>    Procedure OnMoveValueOutByValue
79941>>>>>>>        Handle hoInvokingObject
79941>>>>>>>        Date dSelDate
79941>>>>>>>        Boolean bMulti
79941>>>>>>>        // we can only do an automatic move value out with
79941>>>>>>>        // single select. If multi-select you will probably want to
79941>>>>>>>        // use a callback method (hmCallBack) to update the values. 
79941>>>>>>>        Get pbMultiSelect to bMulti
79942>>>>>>>        If (not(bMulti)) Begin
79944>>>>>>>            Get SelectedDate to dSelDate
79945>>>>>>>            Get phoInvokingObject to hoInvokingObject
79946>>>>>>>            Set Value of hoInvokingObject to dSelDate
79947>>>>>>>            Set Item_Changed_State of hoInvokingObject to True
79948>>>>>>>        End
79948>>>>>>>>
79948>>>>>>>    End_Procedure
79949>>>>>>>
79949>>>>>>>    Procedure OnMoveValueOutByCustom
79951>>>>>>>    End_Procedure
79952>>>>>>>        
79952>>>>>>>    // called before the list is activated. 
79952>>>>>>>    Procedure InitializePrompt
79954>>>>>>>        Handle hoInvokingObject
79954>>>>>>>        Integer eUpdateMode
79954>>>>>>>        Boolean bMulti 
79954>>>>>>>        Date dValue
79954>>>>>>>
79954>>>>>>>        Get peUpdateMode to eUpdateMode
79955>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
79957>>>>>>>
79957>>>>>>>            Get Focus of Desktop to hoInvokingObject
79958>>>>>>>            If (hoInvokingObject<=Desktop) Begin
79960>>>>>>>                Error DFERR_PROGRAM "Calendar Prompt has no invoking object"
79961>>>>>>>>
79961>>>>>>>                Procedure_Return
79962>>>>>>>            End
79962>>>>>>>>
79962>>>>>>>
79962>>>>>>>            Set phoInvokingObject to hoInvokingObject
79963>>>>>>>            Send Prompt_Callback to hoInvokingObject Self
79964>>>>>>>            Get peUpdateMode to eUpdateMode
79965>>>>>>>        End
79965>>>>>>>>
79965>>>>>>>
79965>>>>>>>        Get pdSeedValue to dValue
79966>>>>>>>        Get pbMultiSelect to bMulti
79967>>>>>>>        If (not(bMulti) and eUpdateMode=umPromptValue and dValue=0) Begin
79969>>>>>>>            Get Value of hoInvokingObject to dValue
79970>>>>>>>            Set pdSeedValue to dValue
79971>>>>>>>        End
79971>>>>>>>>
79971>>>>>>>        Send OnSeedData
79972>>>>>>>        Set pdSeedValue to 0
79973>>>>>>>        Set pdSeedValue2 to 0
79974>>>>>>>    End_Procedure
79975>>>>>>>    
79975>>>>>>>    Procedure OnSeedData 
79977>>>>>>>        Boolean bMulti
79977>>>>>>>        Date dValue dValue2
79977>>>>>>>        Integer iMax iRange
79977>>>>>>>        DateTime dt1 dt2
79977>>>>>>>        Get pbMultiSelect to bMulti
79978>>>>>>>        Get pdSeedValue to dValue
79979>>>>>>>        If (not(bMulti)) Begin
79981>>>>>>>            // if no date, use current date
79981>>>>>>>            If (dValue=0) Begin
79983>>>>>>>                Move (CurrentDateTime()) to dValue
79984>>>>>>>            End
79984>>>>>>>>
79984>>>>>>>            Send SetSelectedDate dValue    
79985>>>>>>>        End
79985>>>>>>>>
79985>>>>>>>        Else Begin
79986>>>>>>>            Get pdSeedValue2 to dValue2 
79987>>>>>>>            // if no dates, use current date
79987>>>>>>>            If (dValue=0 and dValue2=0) Begin
79989>>>>>>>                Move (CurrentDateTime()) to dValue
79990>>>>>>>            End
79990>>>>>>>>
79990>>>>>>>            // if only one date, make that the range
79990>>>>>>>            If (dValue=0) Begin
79992>>>>>>>                Move dValue2 to dValue
79993>>>>>>>            End
79993>>>>>>>>
79993>>>>>>>            Else If (dValue2=0) Begin
79996>>>>>>>                Move dValue to dValue2
79997>>>>>>>            End
79997>>>>>>>>
79997>>>>>>>            
79997>>>>>>>            // test for valid range
79997>>>>>>>            Get piMaxSelectedCount to iMax
79998>>>>>>>            Move dValue to dt1
79999>>>>>>>            Move dValue2 to dt2
80000>>>>>>>            Move (SpanTotalDays(dt1 - dt2)) to iRange
80001>>>>>>>            If (iRange>iMax) Begin
80003>>>>>>>                Error DFERR_OPERATOR (SFormat(C_$DateRangeExceeded,iMax))
80004>>>>>>>>
80004>>>>>>>                Move dValue to dValue2
80005>>>>>>>            End
80005>>>>>>>>
80005>>>>>>>            
80005>>>>>>>            Send SetSelectedDateRange dValue dValue2
80006>>>>>>>        End
80006>>>>>>>>
80006>>>>>>>    End_Procedure
80007>>>>>>>
80007>>>>>>>    Procedure OnDoubleClick
80009>>>>>>>        Integer eSelectOn
80009>>>>>>>        Get peMouseSelectOk to eSelectOn
80010>>>>>>>        If (eSelectOn=msoDblClick) Begin
80012>>>>>>>            Send Ok
80013>>>>>>>        End
80013>>>>>>>>
80013>>>>>>>    End_Procedure
80014>>>>>>>    
80014>>>>>>>    Procedure OnClick
80016>>>>>>>        Integer eSelectOn
80016>>>>>>>        Get peMouseSelectOk to eSelectOn
80017>>>>>>>        If (eSelectOn=msoClick) Begin
80019>>>>>>>            Send Ok
80020>>>>>>>        End
80020>>>>>>>>
80020>>>>>>>    End_Procedure
80021>>>>>>>
80021>>>>>>>    Procedure Ok Returns Integer
80023>>>>>>>        Send ClosePrompt
80024>>>>>>>    End_Procedure
80025>>>>>>>
80025>>>>>>>    Procedure Cancel Returns Integer
80027>>>>>>>        Send Close_Panel
80028>>>>>>>    End_Procedure
80029>>>>>>>        
80029>>>>>>>End_Class
80030>>>>>>>
80030>>>>>>>
80030>>>>>Use Dfclient.pkg
80030>>>>>
80030>>>>>Cd_Popup_Object oMonthCalendarPrompt is a ModalPanel
80048>>>>>>
80048>>>>>    Set Location to 10 10
80049>>>>>    Set Size to 145 145
80050>>>>>    // resizable
80050>>>>>    Set Border_Style to Border_Thick
80051>>>>>
80051>>>>>    Set Label to C_$DateSelector
80052>>>>>
80052>>>>>    Set piMinSize to 0 0 // set this dynamically // 145 145
80053>>>>>    Set piMaxSize to 310 460
80054>>>>>
80054>>>>>    // tells us if this been activated and sized yet
80054>>>>>    Property Boolean pbSizeInited False
80056>>>>>        
80056>>>>>    Object oCalendar is a cMonthCalendarPrompt
80058>>>>>        Set Size to 120 135 // not real size, will be assigned
80059>>>>>        Set Location to 5 5
80060>>>>>        Set Border_Style to Border_None
80061>>>>>    End_Object
80062>>>>>
80062>>>>>    Object oOKButton is a Button
80064>>>>>        Set Label to C_$OK
80065>>>>>        Set Default_State to True
80066>>>>>        Set Location to 129 34
80067>>>>>        Set peAnchors to anBottomRight
80068>>>>>        
80068>>>>>        Procedure OnClick
80071>>>>>            Send Ok of oCalendar
80072>>>>>        End_Procedure
80073>>>>>    End_Object
80074>>>>>
80074>>>>>    Object oCancelButton is a Button
80076>>>>>        Set Label to C_$Cancel
80077>>>>>        Set Location to 129 89
80078>>>>>        Set peAnchors to anBottomRight
80079>>>>>        
80079>>>>>        Procedure OnClick
80082>>>>>            Send Cancel of oCalendar
80083>>>>>        End_Procedure
80084>>>>>    End_Object
80085>>>>>
80085>>>>>    Procedure OnResize 
80088>>>>>        Integer iSize iHeight iWidth iMinSize
80088>>>>>        Boolean bInited
80088>>>>>
80088>>>>>        Get piMinHeight of oCalendar to iHeight
80089>>>>>        // when 0, the control has not yet been created. Nothing to do.
80089>>>>>        If (iHeight=0) Begin
80091>>>>>            Procedure_Return
80092>>>>>        End
80092>>>>>>
80092>>>>>
80092>>>>>        Get pbSizeInited to bInited
80093>>>>>        
80093>>>>>        Get piMinWidth of oCalendar to iWidth
80094>>>>>        Get piMinSize to iMinSize
80095>>>>>        // Minumum size of panel - add 1 to each to each for wiggle room
80095>>>>>        Move (iHeight+25+1) to iHeight
80096>>>>>        Move (iWidth+10+1) to iWidth
80097>>>>>         
80097>>>>>        Set piMinSize to iHeight iWidth
80098>>>>>
80098>>>>>        If (not(bInited))  Begin
80100>>>>>            Set Size to iHeight iWidth
80101>>>>>            Set pbSizeInited to True
80102>>>>>        End
80102>>>>>>
80102>>>>>        Else Begin
80103>>>>>            Send Adjust_Logicals
80104>>>>>            Get Size to iSize
80105>>>>>            If (Hi(iSize)<iHeight or Low(iSize)<iWidth) Begin
80107>>>>>                Set Size to (iHeight max Hi(iSize)) (iWidth max Low(iSize))
80108>>>>>                Get Size to iSize
80109>>>>>            End
80109>>>>>>
80109>>>>>            Set Size of oCalendar to (Hi(iSize) - 25) (Low(iSize) - 10)
80110>>>>>        End
80110>>>>>>
80110>>>>>        
80110>>>>>    End_Procedure
80111>>>>>    
80111>>>>>    Procedure Add_Focus Handle hoParent Returns Integer
80114>>>>>        Forward Send Add_Focus hoParent
80116>>>>>        Send OnResize
80117>>>>>    End_Procedure
80118>>>>>
80118>>>>>    On_Key kCancel Send KeyAction to oCancelButton
80119>>>>>
80119>>>>>Cd_End_Object
80121>>>>>>
80121>>>
80121>>>ACTIVATE_VIEW Activate_oSoforReport7 FOR oSoforReport7
80131>>>>
80131>>>Object oSoforReport7 is a ReportView
80133>>>    Set Location to 6 6
80134>>>    Set Size to 100 202
80135>>>    Set Label to "Sof‹r jelent‚s"
80136>>>
80136>>>
80136>>>    Object oSofor_DD is a cSoforDataDictionary
80138>>>    End_Object 
80139>>>
80139>>>    Object oAuto_DD is a cAutoDataDictionary
80141>>>    End_Object 
80142>>>
80142>>>    Object oFuvarlevel_DD is a cFuvarlevelDataDictionary
80144>>>        Set DDO_Server To oAuto_DD
80145>>>        Set DDO_Server To oSofor_DD
80146>>>        Property Date pdStartfuvarl_datum
80148>>>        Property Date pdStopfuvarl_datum
80150>>>
80150>>>        Procedure OnConstrain 
80153>>>            Date dStart dStop
80153>>>
80153>>>            Get pdStartfuvarl_datum To dStart
80154>>>            Get pdStopfuvarl_datum To dStop
80155>>>
80155>>>            Case Begin
80155>>>                Case (dStart <> 0 and dStop <> 0)
80157>>>                    Constrain Fuvarlevel.fuvarl_datum between dStart and dStop
80161>>>                    Case Break
80162>>>                Case (dStart <> 0)
80165>>>                    Constrain Fuvarlevel.fuvarl_datum GE dStart
80167>>>                    Case Break
80168>>>                Case (dStop <> 0)
80171>>>                    Constrain Fuvarlevel.fuvarl_datum LE dStop
80173>>>            Case End
80173>>>        End_Procedure 
80174>>>    End_Object 
80175>>>
80175>>>    Set Main_DD To oFuvarlevel_DD
80176>>>
80176>>>
80176>>>
80176>>>    Object ofuvarl_datumSelection is a Group
80178>>>        Set Size to 35 179
80179>>>        Set Location to 5 12
80180>>>        Set Label to "Select Teljes¡t‚s d tuma"
80181>>>
80181>>>        Object oSelStart is a Form
80183>>>            Set Label to "From:"
80184>>>            Set Size to 13 60
80185>>>            Set Location to 13 30
80186>>>            Set Status_Help to "First value in selection range."
80187>>>            Set Label_Col_Offset to 2
80188>>>            Set Label_Justification_Mode to jMode_Right
80189>>>            Set Form_datatype to mask_date_window
80190>>>            
80190>>>            Set Prompt_Object to oMonthCalendarPrompt
80191>>>            Set Prompt_Button_Mode to PB_PromptOn
80192>>>        End_Object 
80193>>>
80193>>>        Object oSelStop is a Form
80195>>>            Set Label to "To:"
80196>>>            Set Size to 14 60
80197>>>            Set Location to 13 111
80198>>>            Set Status_Help to "Last value in selection range."
80199>>>            Set Label_Col_Offset to 2
80200>>>            Set Label_Justification_Mode to jMode_Right
80201>>>            Set Form_datatype to mask_date_window
80202>>>            
80202>>>            Set Prompt_Object to oMonthCalendarPrompt
80203>>>            Set Prompt_Button_Mode to PB_PromptOn
80204>>>        End_Object 
80205>>>        
80205>>>
80205>>>
80205>>>        Function StartValue returns String
80208>>>            string sValue
80208>>>            Get Value of oSelStart to sValue
80209>>>            Function_return sValue
80210>>>        End_Function 
80211>>>
80211>>>        Function StopValue Returns String
80214>>>            string sValue
80214>>>            Get Value of oSelStop to sValue
80215>>>            Function_return sValue
80216>>>        End_Function 
80217>>>
80217>>>    End_Object 
80218>>>
80218>>>    Object oPrintTo is a RadioGroup
80220>>>        Set Size to 38 118
80221>>>        Set Location to 50 12
80222>>>        Set Label to "Send Report to"
80223>>>
80223>>>        Object oRadio1 is a Radio
80225>>>            Set Label to "Report Viewer"
80226>>>            Set Size to 10 61
80227>>>            Set Location to 12 6
80228>>>            Set Status_Help to "Prints the report to screen"
80229>>>        End_Object 
80230>>>
80230>>>        Object oRadio2 is a Radio
80232>>>            Set Label to "Printer"
80233>>>            Set Size to 10 42
80234>>>            Set Location to 24 6
80235>>>            Set Status_Help to "Prints the report to printer"
80236>>>        End_Object 
80237>>>
80237>>>
80237>>>        Function IsToPrinter Returns boolean
80240>>>            integer iRadio
80240>>>            Get Current_radio to iRadio
80241>>>            Function_return (iRadio=1)
80242>>>        End_Function 
80243>>>
80243>>>    End_Object 
80244>>>
80244>>>    Object oBtnPrint is a Button
80246>>>        Set Label to "Print"
80247>>>        Set Location to 45 140
80248>>>        Set Status_Help to "Print the Selected report"
80249>>>        Set Default_State to TRUE
80250>>>        Procedure OnClick
80253>>>            Send StartReport
80254>>>        End_Procedure
80255>>>    End_Object 
80256>>>
80256>>>    Object oBtnPrinterSetup is a Button
80258>>>        Set Label to "Printer Setup"
80259>>>        Set Location to 62 140
80260>>>        Set Status_Help to "Set up printer for report"
80261>>>        Procedure OnClick
80264>>>            Send DFPrintSetup of oReport
80265>>>        End_Procedure
80266>>>    End_Object 
80267>>>
80267>>>    Object oBtnCancel is a Button
80269>>>        Set Label to "Cancel"
80270>>>        Set Location to 79 140
80271>>>        Set Status_Help to "Close this Panel"
80272>>>        Procedure OnClick
80275>>>            Send Close_Panel
80276>>>        End_Procedure
80277>>>    End_Object 
80278>>>
80278>>>
80278>>>
80278>>>    Object oReport is a cWinReport2
80280>>>
80280>>>        Set Report_Title to "Sof‹r jelent‚s"
80281>>>
80281>>>        // Set DDO, Index and breaks for the report
80281>>>        Set Server to oFuvarlevel_DD
80282>>>        
80282>>>        Report_Breaks Fuvarlevel.fuvarl_sofor_azonosito
80296>>>        
80296>>>        Set Ordering to 5
80297>>>
80297>>>        Function Starting_Main_Report Returns Integer
80300>>>            Boolean bErr
80300>>>            Send DFSetMetrics wpm_cm
80301>>>            Send DFSetmargins 1 1 1 1
80302>>>            //Send DFSetLandscape false // This can be used to force a page orientation
80302>>>            Forward Get Starting_Main_Report to bErr
80304>>>            Function_return bErr
80305>>>        End_Function 
80306>>>
80306>>>        // Page_Top is printed first at the top margin of each page
80306>>>        Procedure Page_Top 
80309>>>            string  sFont
80309>>>            integer iFontSize
80309>>>
80309>>>            Move "arial" to sFont
80310>>>            Move 10 to iFontSize
80311>>>
80311>>>            DFFont sFont
80312>>>            DFFontSize iFontSize
80313>>>            DFBeginHeader DFPageTop
80314>>>                DFHeaderFrame Hdr_NoFrame
80315>>>                DFHeaderPos   Hdr_Left
80316>>>                DFWriteLn ("Page:" * "#pagecount#") (Font_Right)
80317>>>            DFEndHeader
80319>>>
80319>>>        End_Procedure 
80320>>>
80320>>>        // Report_Header is printed once in a report after Page_Top
80320>>>        //Procedure Report_Header
80320>>>        //    string  sFont
80320>>>        //    integer iFontSize
80320>>>        //    Move "arial" to sFont
80320>>>        //    Move 10 to iFontSize
80320>>>        //    DFFont sFont
80320>>>        //    DFFontSize iFontSize
80320>>>        //    DFBeginHeader  DFReportHeader
80320>>>        //        DFHeaderFrame  Hdr_Margins 0.01
80320>>>        //        DFHeaderPos    Hdr_Left
80320>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
80320>>>        //        DFWrite     "Report_Header" (Font_Bold+Font_Center)
80320>>>        //    DFEndHeader
80320>>>        //End_Procedure
80320>>>
80320>>>        Procedure Page_Header 
80323>>>            integer iFill iBorder iStyle
80323>>>            string  sFont sReportTitle
80323>>>            integer iFontSize
80323>>>
80323>>>            Move "arial" to sFont
80324>>>            Move 16 to iFontSize
80325>>>            Move (Font_bold + rgb_White) to iStyle
80326>>>            Move (rgb_dGrey) to iFill
80327>>>            Move (rgb_dGrey) to iBorder
80328>>>            Get Report_Title to sReportTitle
80329>>>
80329>>>            DFFont sFont
80330>>>            DFFontSize iFontSize
80331>>>            DFBeginHeader DFPageHeader
80332>>>                DFHeaderPos   Hdr_Left
80333>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
80334>>>                DFWritelnPos sReportTitle 0.1 iStyle
80335>>>                DFHeaderMargin HM_BottomOuter 0.08
80336>>>            DFEndHeader
80338>>>
80338>>>        End_Procedure 
80339>>>
80339>>>        // Page_Title appears on every page after Page_Header
80339>>>        //Procedure Page_Title
80339>>>        //    string  sFont
80339>>>        //    integer iFontSize
80339>>>        //    Move "arial" to sFont
80339>>>        //    Move 10 to iFontSize
80339>>>        //    DFFont sFont
80339>>>        //    DFFontSize iFontSize
80339>>>        //    DFBeginHeader  DFPageTitle
80339>>>        //        DFHeaderFrame  Hdr_Margins 0.01
80339>>>        //        DFHeaderPos    Hdr_Left
80339>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
80339>>>        //        DFWrite     "Page_Title" (Font_Bold+Font_Center)
80339>>>        //    DFEndHeader
80339>>>        //End_Procedure
80339>>>
80339>>>        Procedure SubHeader1 
80342>>>            string  sFont 
80342>>>            integer iFontSize iStyle
80342>>>            integer iFill iBorder iHeaderStyle
80342>>>
80342>>>            Move "arial" to sFont
80343>>>            Move 10 to iFontSize
80344>>>            Move (Font_Bold + rgb_dBlue) to iStyle
80345>>>            Move (Font_Bold + rgb_dBlue) to iHeaderStyle
80346>>>            Move (rgb_dGrey) to iBorder
80347>>>            Get DFGetDFColor 242 242 242 to iFill
80348>>>
80348>>>            DFFont sFont
80349>>>            DFFontSize iFontSize
80350>>>            DFBeginHeader DFSubHeader 1
80351>>>                DFHeaderLineCheck 5
80352>>>                DFHeaderWrap   HDR_Wrap
80353>>>                DFHeaderPos    HDR_Left
80354>>>                DFHeaderFrame  Hdr_Margins 0.01 iBorder iFill
80355>>>                DFHeaderMargin hm_BottomOuter 0.08
80356>>>                DFHeaderMargin hm_TopInner    0.04
80357>>>                DFHeaderMargin hm_BottomInner 0.04
80358>>>
80358>>>                // display fields to be placed in this sub-header
80358>>>                DFWritePos "Sof‹r neve:"                 0.1 iHeaderStyle -1 4.9
80359>>>                DFWritePos Sofor.sofor_nev                5 iStyle -1
80360>>>                DFWriteLn
80361>>>
80361>>>                // write the heading for the body section
80361>>>                DFFontSize 1 // create a very small space on top and below the horizontal bar
80362>>>                DFWriteLn
80363>>>                DFWriteLine DFGR_CURRLINE DFGR_CURRLINE DFGR_RB_MARGIN DFGR_HORI iBorder
80364>>>                DFWriteLn
80365>>>                DFFontSize iFontSize
80366>>>                DFWritePos "D tum"                        0.08 iHeaderStyle -1 2.13
80367>>>                DFWritePos "Munkaid‹ (¢ra)"               (2.29 + 3.58) (iHeaderStyle + Font_Right) -1 3.58
80368>>>                DFWritePos "Kil¢m‚ter"                    (5.95 + 2.3) (iHeaderStyle + Font_Right) -1 2.3
80369>>>                DFWriteLn
80370>>>
80370>>>            DFEndHeader
80372>>>
80372>>>        End_Procedure 
80373>>>
80373>>>        Procedure Body 
80376>>>            string  sFont 
80376>>>            integer iFontSize iStyle
80376>>>
80376>>>            Move "arial" to sFont
80377>>>            Move 10 to iFontSize
80378>>>            Move (font_default) to iStyle
80379>>>
80379>>>            DFFont sFont
80380>>>            DFFontSize iFontSize
80381>>>
80381>>>            DFWritePos Fuvarlevel.fuvarl_datum        0.08 iStyle -1 2.13
80382>>>            DFWritePos Fuvarlevel.fuvarl_munkaido_menyiseg (2.29 + 3.58) (iStyle + Font_Right) 0 3.58
80383>>>            Send Add_SubTotal 1 Fuvarlevel.fuvarl_munkaido_menyiseg
80384>>>            DFWritePos Fuvarlevel.fuvarl_teljesitett_km (5.95 + 2.3) (iStyle + Font_Right) 0 2.3
80385>>>            DFWriteLn
80386>>>            Send Add_SubTotal 2 Fuvarlevel.fuvarl_teljesitett_km
80387>>>
80387>>>        End_Procedure 
80388>>>
80388>>>        Procedure SubTotal1 
80391>>>            string  sFont 
80391>>>            integer iFontSize iStyle iFill iBorder
80391>>>            number  nAmount
80391>>>
80391>>>            Move "arial" to sFont
80392>>>            Move 10 to iFontSize
80393>>>            Move (font_bold) to iStyle
80394>>>            Move (rgb_dGrey) to iBorder
80395>>>            Get DFGetDFColor 242 242 242 to iFill
80396>>>
80396>>>            DFFont sFont
80397>>>            DFFontSize iFontSize
80398>>>            DFBeginHeader DFSubTotal 1
80399>>>                DFHeaderPos   Hdr_Left
80400>>>                DFHeaderWrap  Hdr_NoWrap
80401>>>                DFHeaderFrame HDR_Margins 0.01 iBorder iFill
80402>>>                DFHeaderMargin hm_BottomOuter 0.16
80403>>>                DFHeaderMargin hm_TopInner 0.04
80404>>>                DFHeaderMargin hm_BottomInner 0.04
80405>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
80406>>>
80406>>>                Get SubTotal ( 1 + 0) to nAmount
80407>>>                Send Add_SubTotal ( 1 + 3) nAmount
80408>>>                DFWritePos nAmount (2.29 + 3.58) (iStyle + Font_Right) 0 3.58
80409>>>                Get SubTotal ( 2 + 0) to nAmount
80410>>>                Send Add_SubTotal ( 2 + 3) nAmount
80411>>>                DFWritePos nAmount (5.95 + 2.3) (iStyle + Font_Right) 0 2.3
80412>>>                DFWriteLn
80413>>>            DFEndHeader
80415>>>
80415>>>        End_Procedure 
80416>>>
80416>>>        Procedure Total 
80419>>>            string  sFont 
80419>>>            integer iFontSize iStyle iFill iBorder
80419>>>            number  nAmount
80419>>>
80419>>>            Move "arial" to sFont
80420>>>            Move 10 to iFontSize
80421>>>            Move (font_bold) to iStyle
80422>>>            Move (rgb_Grey) to iFill
80423>>>            Move (rgb_dGrey) to iBorder
80424>>>
80424>>>            DFFont sFont
80425>>>            DFFontSize iFontSize
80426>>>            DFBeginHeader DFTotal
80427>>>                DFHeaderPos   Hdr_Left
80428>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder iFill
80429>>>
80429>>>                Get SubTotal ( 1 + 3) to nAmount
80430>>>                DFWritePos nAmount (2.29 + 3.58) (iStyle + Font_Right) 0 3.58
80431>>>                Get SubTotal ( 2 + 3) to nAmount
80432>>>                DFWritePos nAmount (5.95 + 2.3) (iStyle + Font_Right) 0 2.3
80433>>>                DFWriteLn
80434>>>            DFEndHeader
80436>>>
80436>>>        End_Procedure 
80437>>>
80437>>>        // Report_Footer is printed once on the last page before Page_Footer
80437>>>        //Procedure Report_Footer
80437>>>        //    string  sFont
80437>>>        //    integer iFontSize
80437>>>        //    Move "arial" to sFont
80437>>>        //    Move 10 to iFontSize
80437>>>        //    DFFont sFont
80437>>>        //    DFFontSize iFontSize
80437>>>        //    DFBeginHeader DFReportFooter
80437>>>        //        DFHeaderFrame  Hdr_Margins 0.01
80437>>>        //        DFHeaderPos    Hdr_Left
80437>>>        //        DFHeaderMargin Hm_BottomOuter 0.08
80437>>>        //        DFWrite     "Report_Footer" (Font_Bold+Font_Center)
80437>>>        //    DFEndHeader
80437>>>        //End_Procedure
80437>>>
80437>>>        Procedure Page_Footer 
80440>>>            string sStart sStop sText
80440>>>            string  sFont 
80440>>>            integer iFontSize iStyle
80440>>>
80440>>>            Move "arial" to sFont
80441>>>            Move 10 to iFontSize
80442>>>            Move (font_default) to iStyle
80443>>>
80443>>>            DFFont sFont
80444>>>            DFFontSize iFontSize
80445>>>            DFBeginHeader DFPageFooter
80446>>>                DFHeaderFrame hdr_NoFrame
80447>>>                DFHeaderPos   hdr_Left
80448>>>
80448>>>                Get pdStartfuvarl_datum of oFuvarlevel_DD to sStart
80449>>>                Get pdStopfuvarl_datum  of oFuvarlevel_DD to sStop
80450>>>                Get SelectionCriteraDescription "Fuvarlevel.fuvarl_datum" sStart sStop to sText
80451>>>                If (sText<>"") begin
80453>>>                    DFWriteLnPos sText 0.1
80454>>>                end
80454>>>>
80454>>>
80454>>>            DFEndHeader
80456>>>        End_Procedure 
80457>>>
80457>>>        // Page_Bottom is printed last at the bottom margin of each page
80457>>>        Procedure Page_Bottom 
80460>>>            string sFont
80460>>>            integer iFontSize iBorder iStyle
80460>>>            DateTime dtDT
80460>>>
80460>>>            Move (CurrentDateTime()) to dtDT
80461>>>
80461>>>            Move "arial" to sFont
80462>>>            Move 10 to iFontSize
80463>>>            Move (font_default) to iStyle
80464>>>            Move (rgb_dGrey) to iBorder
80465>>>
80465>>>            DFFont sFont
80466>>>            DFFontSize iFontSize
80467>>>            DFBeginHeader DFPageBottom
80468>>>                DFHeaderFrame Hdr_Margins 0.01 iBorder
80469>>>                DFHeaderPos Hdr_Left
80470>>>                DFWriteln ("Report Printed on" * string(dtDT)) (iStyle+Font_Center)
80471>>>            DFEndHeader
80473>>>
80473>>>        End_Procedure 
80474>>>
80474>>>        // Returns string with description of selection ranges
80474>>>        // Pass: Selection title, start value and end value. Return: description
80474>>>        Function SelectionCriteraDescription string sTitle string sStart string sStop returns String
80477>>>            string sText
80477>>>            If (sStart=""  AND sStop="")  function_return ""
80480>>>            If (sStart="0" AND sStop="0") function_return ""
80483>>>            If (sStart<>"" AND sStop<>"") begin
80485>>>                Move ("between" * sStart * "and" * sStop) to sText
80486>>>            end
80486>>>>
80486>>>            Else if (sStart > "") begin
80489>>>                Move ("starting at" * sStart) to sText
80490>>>            end
80490>>>>
80490>>>            Else if (sStop > "") begin
80493>>>                Move ("up to" * sStop) to sText
80494>>>            End
80494>>>>
80494>>>            function_return (sTitle * sText)
80495>>>        End_Function
80496>>>
80496>>>    End_Object 
80497>>>
80497>>>    Procedure StartReport 
80500>>>        Boolean bToPrinter
80500>>>        String sValue
80500>>>        Date dStart dStop
80500>>>
80500>>>        // Set all selection critera properties
80500>>>        Get StartValue of ofuvarl_datumSelection to sValue
80501>>>        Set pdStartfuvarl_datum of oFuvarlevel_DD To sValue
80502>>>
80502>>>        Get StopValue of ofuvarl_datumSelection to sValue
80503>>>        Set pdStopfuvarl_datum of oFuvarlevel_DD To sValue
80504>>>
80504>>>
80504>>>        // determine if direct print
80504>>>        Get IsToPrinter of oPrintTo to bToPrinter
80505>>>        Set OutPut_Device_Mode of oReport to (If(bToPrinter, PRINT_TO_PRINTER, PRINT_TO_WINDOW))
80506>>>
80506>>>        // run the report
80506>>>        Send Run_Report of oReport
80507>>>
80507>>>    End_Procedure 
80508>>>
80508>>>End_Object 
80509>
80509>        Procedure Activate_About
80512>            Send DoAbout "" "" "" "" ""
80513>        End_Procedure
80514>
80514>    End_Object
80515>
80515>End_Object
80516>
80516>Start_UI
80517>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 45562
Total Resources: 0
Total Commands : 80516
Total Windows  : 1
Total Pages    : 1
Static Data    : 497541
Message area   : 560646
Total Blocks   : 28877
