Compiling Program: C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\SzallitmanyozoCeg.src
Memory Available: 2147483646
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\dfallent.pkd)
75288>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardCommandBarSystem.pkg)
75288>>>// these are all the packages used in a standard MDI menubar/toolbar system
75288>>>
75288>>>Use cCJCommandBarSystem.pkg
75288>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardMenuItemClasses.pkg)
75288>>>>>Use Dfpanel.pkg
75288>>>>>Use cCJCommandBarSystem.pkg
75288>>>>>Use LanguageText.pkg
75288>>>>>
75288>>>>>
75288>>>>>Class cCJUndoMenuItem is a cCJMenuItem
75289>>>>>    
75289>>>>>    Procedure Construct_Object
75291>>>>>        Forward Send Construct_Object
75293>>>>>        Set psCaption   to C_$CaptionUndo
75294>>>>>        Set psToolTip to C_$ToolTipUndo
75295>>>>>        Set psDescription to C_$DescUndo
75296>>>>>        Set psImage to "ActionUndo.ico"
75297>>>>>        Set pbActiveUpdate to True
75298>>>>>        Set psCategory to C_$CategoryEdit
75299>>>>>        Set psShortcut to C_$Key_Ctrl_Z
75300>>>>>    End_Procedure
75301>>>>>
75301>>>>>    Procedure OnExecute Variant vCommandBarControl
75303>>>>>        Send Undo of (focus(Self))
75304>>>>>    End_Procedure
75305>>>>>    
75305>>>>>    Function IsEnabled Returns Boolean
75307>>>>>        Boolean bEnabled
75307>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
75308>>>>>        Function_Return bEnabled
75309>>>>>    End_Function
75310>>>>>         
75310>>>>>End_Class
75311>>>>>
75311>>>>>
75311>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
75312>>>>>    
75312>>>>>    Procedure Construct_Object
75314>>>>>        Forward Send Construct_Object
75316>>>>>        Set psCaption   to C_$CaptionDelete
75317>>>>>        Set psToolTip to C_$ToolTipDelete
75318>>>>>        Set psDescription to C_$DescDelete
75319>>>>>        Set psImage to "actionDelete.ico"
75320>>>>>        Set psShortcut to C_$Key_Delete
75321>>>>>        Set pbActiveUpdate to True
75322>>>>>        Set psCategory to C_$CategoryEdit
75323>>>>>    End_Procedure
75324>>>>>
75324>>>>>
75324>>>>>    Procedure OnExecute Variant vCommandBarControl
75326>>>>>        Send Delete of (focus(Self))
75327>>>>>    End_Procedure
75328>>>>>    
75328>>>>>    Function IsEnabled Returns Boolean
75330>>>>>        Boolean bEnabled
75330>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
75331>>>>>        Function_Return bEnabled
75332>>>>>    End_Function
75333>>>>>         
75333>>>>>End_Class
75334>>>>>
75334>>>>>
75334>>>>>Class cCJCutMenuItem is a cCJMenuItem
75335>>>>>    
75335>>>>>    Procedure Construct_Object
75337>>>>>        Forward Send Construct_Object
75339>>>>>        Set psCaption   to C_$CaptionCut
75340>>>>>        Set psToolTip to C_$TooltipCut
75341>>>>>        Set psDescription to C_$DescCut
75342>>>>>        Set psImage to "actionCut.ico"
75343>>>>>        Set psShortcut to C_$Key_Ctrl_X
75344>>>>>        Set pbActiveUpdate to True
75345>>>>>        Set psCategory to C_$CategoryEdit
75346>>>>>    End_Procedure
75347>>>>>
75347>>>>>
75347>>>>>    Procedure OnExecute Variant vCommandBarControl
75349>>>>>        Send Cut of (focus(Self))
75350>>>>>    End_Procedure
75351>>>>>    
75351>>>>>    Function IsEnabled Returns Boolean
75353>>>>>        Boolean bEnabled
75353>>>>>        Get CanCut of (Focus(Self)) to bEnabled
75354>>>>>        Function_Return bEnabled
75355>>>>>    End_Function
75356>>>>>         
75356>>>>>End_Class
75357>>>>>
75357>>>>>
75357>>>>>Class cCJCopyMenuItem is a cCJMenuItem
75358>>>>>    
75358>>>>>    Procedure Construct_Object
75360>>>>>        Forward Send Construct_Object
75362>>>>>        Set psCaption   to C_$CaptionCopy
75363>>>>>        Set psToolTip to C_$ToolTipCopy
75364>>>>>        Set psDescription to C_$DescCopy
75365>>>>>        Set psImage to "actionCopy.ico"
75366>>>>>        Set psShortcut to C_$Key_Ctrl_C
75367>>>>>        Set pbActiveUpdate to True
75368>>>>>        Set psCategory to C_$CategoryEdit
75369>>>>>    End_Procedure
75370>>>>>
75370>>>>>
75370>>>>>    Procedure OnExecute Variant vCommandBarControl
75372>>>>>        Send Copy of (focus(Self))
75373>>>>>    End_Procedure
75374>>>>>    
75374>>>>>    Function IsEnabled Returns Boolean
75376>>>>>        Boolean bEnabled
75376>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
75377>>>>>        Function_Return bEnabled
75378>>>>>    End_Function
75379>>>>>         
75379>>>>>End_Class
75380>>>>>
75380>>>>>
75380>>>>>Class cCJPasteMenuItem is a cCJMenuItem
75381>>>>>    
75381>>>>>    Procedure Construct_Object
75383>>>>>        Forward Send Construct_Object
75385>>>>>        Set psCaption   to C_$CaptionPaste
75386>>>>>        Set psToolTip to C_$ToolTipPaste
75387>>>>>        Set psDescription to C_$DescPaste
75388>>>>>        Set psImage to "actionPaste.ico"
75389>>>>>        Set pbActiveUpdate to True
75390>>>>>        Set psShortcut to C_$Key_Ctrl_V
75391>>>>>        Set psCategory to C_$CategoryEdit
75392>>>>>    End_Procedure
75393>>>>>
75393>>>>>
75393>>>>>    Procedure OnExecute Variant vCommandBarControl
75395>>>>>        Send Paste of (focus(Self))
75396>>>>>    End_Procedure
75397>>>>>    
75397>>>>>    Function IsEnabled Returns Boolean
75399>>>>>        Boolean bEnabled
75399>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
75400>>>>>        Function_Return bEnabled
75401>>>>>    End_Function
75402>>>>>         
75402>>>>>End_Class
75403>>>>>
75403>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
75404>>>>>    
75404>>>>>    Procedure Construct_Object
75406>>>>>        Forward Send Construct_Object
75408>>>>>        Set psCaption   to C_$CaptionSelectAll
75409>>>>>        Set psToolTip to C_$ToolTipSelectAll
75410>>>>>        Set psDescription to C_$DescSelectAll
75411>>>>>        Set pbActiveUpdate to True
75412>>>>>        Set psShortcut to C_$Key_Ctrl_A
75413>>>>>        Set psCategory to C_$CategoryEdit
75414>>>>>    End_Procedure
75415>>>>>
75415>>>>>
75415>>>>>    Procedure OnExecute Variant vCommandBarControl
75417>>>>>        Send Select_All of (focus(Self))
75418>>>>>    End_Procedure
75419>>>>>    
75419>>>>>    Function IsEnabled Returns Boolean
75421>>>>>        Boolean bEnabled
75421>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
75422>>>>>        Function_Return bEnabled
75423>>>>>    End_Function
75424>>>>>         
75424>>>>>End_Class
75425>>>>>
75425>>>>> 
75425>>>>>Class cCJExitMenuItem is a cCJMenuItem
75426>>>>>
75426>>>>>    Procedure Construct_Object
75428>>>>>        Forward Send Construct_Object
75430>>>>>        Set psCaption to C_$CaptionExit
75431>>>>>        Set psToolTip to C_$ToolTipExit
75432>>>>>        Set psDescription to C_$ToolTipExit
75433>>>>>        Set psShortcut to C_$Key_Alt_F4
75434>>>>>        Set psCategory to C_$CategoryFile
75435>>>>>    End_Procedure
75436>>>>>
75436>>>>>    Procedure OnExecute Variant vCommandBarControl
75438>>>>>        Send Exit_Application of Desktop
75439>>>>>    End_Procedure
75440>>>>>
75440>>>>>End_Class           
75441>>>>>
75441>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
75442>>>>>
75442>>>>>    Procedure Construct_Object
75444>>>>>        Forward Send Construct_Object
75446>>>>>        Set psCaption to C_$CaptionHelp
75447>>>>>        Set psDescription to C_$ToolTipHelp
75448>>>>>        Set psToolTip to C_$DescHelp
75449>>>>>        Set psImage to "ActionHelp.ico"
75450>>>>>        Set psShortcut to "F1"
75451>>>>>        Set psCategory to C_$CategoryHelp
75452>>>>>    End_Procedure
75453>>>>>    
75453>>>>>    Procedure OnExecute Variant vCommandBarControl
75455>>>>>        Send Help of (Focus(Self))
75456>>>>>    End_Procedure
75457>>>>>
75457>>>>>End_Class
75458>>>>>
75458>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
75459>>>>>
75459>>>>>    Procedure Construct_Object
75461>>>>>        Forward Send Construct_Object
75463>>>>>        Set psCaption to C_$CaptionAddStatusbar
75464>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
75465>>>>>        Set psDescription to  C_$DescAddStatusbar
75466>>>>>        Set psCategory to C_$CategoryWindow
75467>>>>>    End_Procedure
75468>>>>>
75468>>>>>    Procedure OnExecute Variant vCommandBarControl
75470>>>>>        Handle hoCommandBars hoClientArea
75470>>>>>        Get CommandBarSystemObject to hoCommandBars
75471>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75472>>>>>        If hoClientArea Begin
75474>>>>>            // the clientarea's parent panel has message
75474>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
75475>>>>>        End
75475>>>>>>
75475>>>>>    End_Procedure
75476>>>>>
75476>>>>>     Function IsChecked Returns Boolean
75478>>>>>        Boolean bOn
75478>>>>>        Handle hoCommandBars hoClientArea
75478>>>>>        Get CommandBarSystemObject to hoCommandBars
75479>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75480>>>>>        If hoClientArea Begin
75482>>>>>            // the clientarea's parent panel has message
75482>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
75483>>>>>        End
75483>>>>>>
75483>>>>>        Function_Return bOn
75484>>>>>     End_Function
75485>>>>>End_Class
75486>>>>>
75486>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
75487>>>>>
75487>>>>>    Procedure Construct_Object
75489>>>>>        Forward Send Construct_Object
75491>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
75492>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
75493>>>>>        Set psDescription to C_$DescAutoArrangeIcons
75494>>>>>        Set psCategory to C_$CategoryWindow
75495>>>>>    End_Procedure
75496>>>>>
75496>>>>>    Procedure OnExecute Variant vCommandBarControl
75498>>>>>        Handle hoCommandBars hoClientArea
75498>>>>>        Get CommandBarSystemObject to hoCommandBars
75499>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75500>>>>>        If hoClientArea Begin
75502>>>>>            // the clientarea's parent panel has message
75502>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
75503>>>>>        End
75503>>>>>>
75503>>>>>    End_Procedure
75504>>>>>    
75504>>>>>     Function IsChecked Returns Boolean
75506>>>>>        Boolean bOn
75506>>>>>        Handle hoCommandBars hoClientArea
75506>>>>>        Get CommandBarSystemObject to hoCommandBars
75507>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75508>>>>>        If hoClientArea Begin
75510>>>>>            // the clientarea's parent panel has message
75510>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
75511>>>>>        End
75511>>>>>>
75511>>>>>        Function_Return bOn
75512>>>>>     End_Function
75513>>>>>End_Class
75514>>>>>
75514>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
75515>>>>>
75515>>>>>    Procedure Construct_Object
75517>>>>>        Forward Send Construct_Object
75519>>>>>        Set psCaption to C_$CaptionRestoreMenus
75520>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
75521>>>>>        Set psDescription to C_$DescRestoreMenus
75522>>>>>        Set psCategory to C_$CategoryWindow
75523>>>>>    End_Procedure
75524>>>>>
75524>>>>>    Procedure OnExecute Variant vCommandBarControl
75526>>>>>        Handle hoCommandBars
75526>>>>>        Get CommandBarSystemObject to hoCommandBars
75527>>>>>        Send RestoreLayout of hoCommandBars
75528>>>>>    End_Procedure
75529>>>>>    
75529>>>>>End_Class
75530>>>>>
75530>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
75531>>>>>
75531>>>>>    Procedure Construct_Object
75533>>>>>        Forward Send Construct_Object
75535>>>>>        Set psCaption to C_$CaptionCascade
75536>>>>>        Set psToolTip to C_$ToolTipCascade
75537>>>>>        Set psDescription to  C_$DescCascade
75538>>>>>        Set psImage to "ActionCascade.ico"
75539>>>>>        Set psCategory to C_$CategoryWindow
75540>>>>>    End_Procedure
75541>>>>>    
75541>>>>>    Procedure OnExecute Variant vCommandBarControl
75543>>>>>        Handle hoCommandBars hoClientArea
75543>>>>>        Get CommandBarSystemObject to hoCommandBars
75544>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75545>>>>>        If hoClientArea Begin
75547>>>>>            Send Cascade_Windows of hoClientArea
75548>>>>>        End
75548>>>>>>
75548>>>>>    End_Procedure
75549>>>>>End_Class
75550>>>>>
75550>>>>>Class cCJTileHorizontally is a cCJMenuItem
75551>>>>>
75551>>>>>    Procedure Construct_Object
75553>>>>>        Forward Send Construct_Object
75555>>>>>        Set psCaption to C_$CaptionTileHorizontally 
75556>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
75557>>>>>        Set psDescription to  C_$DescTileHorizontally
75558>>>>>        Set psImage to "ActionTileHorizontally.ico"
75559>>>>>        Set psCategory to C_$CategoryWindow
75560>>>>>    End_Procedure
75561>>>>>
75561>>>>>    Procedure OnExecute Variant vCommandBarControl
75563>>>>>        Handle hoCommandBars hoClientArea
75563>>>>>        Get CommandBarSystemObject to hoCommandBars
75564>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75565>>>>>        If hoClientArea Begin
75567>>>>>            Send Tile_Windows_Horizontal of hoClientArea
75568>>>>>        End
75568>>>>>>
75568>>>>>    End_Procedure
75569>>>>>End_Class
75570>>>>>
75570>>>>>Class cCJTileVertically is a cCJMenuItem
75571>>>>>
75571>>>>>    Procedure Construct_Object
75573>>>>>        Forward Send Construct_Object
75575>>>>>        Set psCaption to C_$CaptionTileVertically  
75576>>>>>        Set psToolTip to C_$ToolTipTileVertically
75577>>>>>        Set psDescription to  C_$DescTileVertically
75578>>>>>        Set psImage to "ActionTileVertically.ico"
75579>>>>>        Set psCategory to C_$CategoryWindow
75580>>>>>    End_Procedure
75581>>>>>
75581>>>>>    Procedure OnExecute Variant vCommandBarControl
75583>>>>>        Handle hoCommandBars hoClientArea
75583>>>>>        Get CommandBarSystemObject to hoCommandBars
75584>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75585>>>>>        If hoClientArea Begin
75587>>>>>            Send Tile_Windows_Vertical of hoClientArea
75588>>>>>        End
75588>>>>>>
75588>>>>>    End_Procedure
75589>>>>>End_Class
75590>>>>>
75590>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
75591>>>>>
75591>>>>>    Procedure Construct_Object
75593>>>>>        Forward Send Construct_Object
75595>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
75596>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
75597>>>>>        Set psDescription to  C_$DescMinimizeWindows
75598>>>>>        Set psCategory to C_$CategoryWindow
75599>>>>>    End_Procedure
75600>>>>>
75600>>>>>    Procedure OnExecute Variant vCommandBarControl
75602>>>>>        Handle hoCommandBars hoClientArea
75602>>>>>        Get CommandBarSystemObject to hoCommandBars
75603>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75604>>>>>        If hoClientArea Begin
75606>>>>>            // the clientarea's parent panel has message
75606>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
75607>>>>>        End
75607>>>>>>
75607>>>>>    End_Procedure
75608>>>>>End_Class
75609>>>>>
75609>>>>>
75609>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
75610>>>>>
75610>>>>>    Procedure Construct_Object
75612>>>>>        Forward Send Construct_Object
75614>>>>>        Set psCaption to C_$CaptionRestoreWindows
75615>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
75616>>>>>        Set psDescription to  C_$DescRestoreWindows
75617>>>>>        Set psCategory to C_$CategoryWindow
75618>>>>>    End_Procedure
75619>>>>>
75619>>>>>    Procedure OnExecute Variant vCommandBarControl
75621>>>>>        Handle hoCommandBars hoClientArea
75621>>>>>        Get CommandBarSystemObject to hoCommandBars
75622>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75623>>>>>        If hoClientArea Begin
75625>>>>>            // the clientarea's parent panel has message
75625>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
75626>>>>>        End
75626>>>>>>
75626>>>>>    End_Procedure
75627>>>>>End_Class
75628>>>>>
75628>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
75629>>>>>
75629>>>>>    Procedure Construct_Object
75631>>>>>        Forward Send Construct_Object
75633>>>>>        Set psCaption to C_$CaptionArrangeIcons  
75634>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
75635>>>>>        Set psDescription to  C_$DescArrangeIcons
75636>>>>>        Set psCategory to C_$CategoryWindow
75637>>>>>    End_Procedure
75638>>>>>
75638>>>>>    Procedure OnExecute Variant vCommandBarControl
75640>>>>>        Handle hoCommandBars hoClientArea
75640>>>>>        Get CommandBarSystemObject to hoCommandBars
75641>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75642>>>>>        If hoClientArea Begin
75644>>>>>            Send Arrange_Icons of hoClientArea
75645>>>>>        End
75645>>>>>>
75645>>>>>    End_Procedure
75646>>>>>
75646>>>>>End_Class
75647>>>>>    
75647>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJAboutMenuItem.pkg)
75647>>>>>Use cCJCommandBarSystem.pkg
75647>>>>>Use LanguageText.pkg
75647>>>>>
75647>>>>>// It is expected that if you use this class that you provide an about object that is
75647>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
75647>>>>>// because you may wish to create your own custom about package.
75647>>>>>
75647>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
75648>>>>>
75648>>>>>    Procedure Construct_Object
75650>>>>>        Forward Send Construct_Object
75652>>>>>        Set psCaption to C_$CaptionAbout
75653>>>>>        Set psDescription to C_$ToolTipAbout
75654>>>>>        Set psToolTip to C_$DescAbout
75655>>>>>        Set psImage to "ActionAbout.ico"
75656>>>>>        Set psCategory to C_$CategoryHelp
75657>>>>>    End_Procedure
75658>>>>>    
75658>>>>>    Procedure OnExecute Variant vCommandBarControl
75660>>>>>        Handle hoCommandBars hoClientArea
75660>>>>>        Get CommandBarSystemObject to hoCommandBars
75661>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75662>>>>>        If hoClientArea Begin
75664>>>>>            Send Activate_About of hoClientArea
75665>>>>>        End
75665>>>>>>
75665>>>>>    End_Procedure
75666>>>>>
75666>>>>>End_Class
75667>>>>>
75667>>>>>
75667>>>Use cCJDeoMenuItemClasses.pkg
75667>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJMDIWindowsMenuItem.pkg)
75667>>>>>Use cCJCommandBarSystem.pkg
75667>>>>>
75667>>>>>Register_Function Client_ID Returns Integer
75667>>>>>
75667>>>>>// only used by cCJMDIWIndowsMenuItem
75667>>>>>Class cCJMDIWindowItem is a cCJMenuItem
75668>>>>>
75668>>>>>    Procedure Construct_Object
75670>>>>>        Forward Send Construct_Object
75672>>>>>        Property Handle phWindow 0 // object id of view
75673>>>>>        Set pbControlFlagNoMovable to True
75674>>>>>        Set pbActiveUpdate to True
75675>>>>>    End_Procedure
75676>>>>>    
75676>>>>>    Procedure OnExecute Variant vCommandBarControl
75678>>>>>        Handle hWindow
75678>>>>>        Get phWindow to hWindow
75679>>>>>        Send Activate_View of hWindow
75680>>>>>    End_Procedure
75681>>>>>    
75681>>>>>End_Class                
75682>>>>>
75682>>>>>
75682>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
75683>>>>>    
75683>>>>>    Procedure Construct_Object
75685>>>>>        Forward Send Construct_Object
75687>>>>>        Property Handle[] phArrayOfWindows
75688>>>>>        Set peControlType to xtpControlPopup
75689>>>>>        Set psCategory to C_$CategoryWindow
75690>>>>>    End_Procedure
75691>>>>>    
75691>>>>>     // This adds MDI windows to the existing menu items.
75691>>>>>     // This removes any existing windows menus and always adds a new set to the end
75691>>>>>
75691>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
75693>>>>>        Handle  hClientArea hView
75693>>>>>        String  sLabel
75693>>>>>        Integer i iWindows
75693>>>>>        Handle[] hArrayOfWindows
75694>>>>>        Variant vItem
75694>>>>>        
75694>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
75694>>>>>        // also assume that destroying an action removes all menu instances of that action
75694>>>>>        Get phArrayOfWindows to hArrayOfWindows
75695>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
75696>>>>>        For i from 0 to (iWindows-1)
75702>>>>>>
75702>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
75703>>>>>        Loop
75704>>>>>>
75704>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
75705>>>>>
75705>>>>>        // Add all views to this menu. Create the action and add the item
75705>>>>>        Move 0 to i
75706>>>>>        Get Client_Id to hClientArea // object id of client area
75707>>>>>        If (hClientArea > 0) Begin
75709>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
75710>>>>>            While (hView <> 0)
75714>>>>>                If (Active_State(hView)) Begin
75716>>>>>                    // create the action
75716>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
75717>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
75718>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
75719>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
75720>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
75722>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
75723>>>>>                    End
75723>>>>>>
75723>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
75724>>>>>                    If (i=0) Begin
75726>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
75727>>>>>                    End
75727>>>>>>
75727>>>>>                    // Create a menu item for this action
75727>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
75728>>>>>                    Increment i
75729>>>>>                End
75729>>>>>>
75729>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
75730>>>>>            Loop
75731>>>>>>
75731>>>>>        End
75731>>>>>>
75731>>>>>
75731>>>>>        Set phArrayOfWindows to hArrayOfWindows
75732>>>>>
75732>>>>>     End_Procedure
75733>>>>>     
75733>>>>>End_Class
75734>>>>>
75734>
75734>Object oHtmlHelp is a cHtmlHelp
75736>End_Object
75737>
75737>Object oApplication is a cApplication
75739>    Set peHelpType to htHtmlHelp
75740>End_Object
75741>
75741>Object oToolTipController is a cToolTipController
75743>    Move Self to ghoToolTipController
75744>End_Object
75745>
75745>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oEditContextMenu.pkg)
75745>>>Use cCJStandardMenuItemClasses.pkg
75745>>>
75745>>>Object oEditContextMenu is a cCJContextMenu
75747>>>    
75747>>>    Move Self to Default_Form_Floating_Menu_ID
75748>>>    
75748>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75750>>>    End_Object
75751>>>    
75751>>>    Object oCutMenuItem is a cCJCutMenuItem
75753>>>        Set pbControlBeginGroup to True
75754>>>    End_Object
75755>>>    
75755>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75757>>>    End_Object
75758>>>
75758>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75760>>>    End_Object
75761>>>
75761>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75763>>>    End_Object
75764>>>
75764>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75766>>>        Set pbControlBeginGroup to True
75767>>>    End_Object
75768>>>
75768>>>End_Object
75769>>>
75769>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oDEOEditContextMenu17.pkg)
75769>>>Use Windows.pkg
75769>>>Use cCJStandardMenuItemClasses.pkg
75769>>>Use cCJDeoMenuItemClasses.pkg
75769>>>
75769>>>
75769>>>Object oDEOEditContextMenu17 is a cCJContextMenu
75771>>>    
75771>>>    Move Self to Default_dbFloating_Menu_ID
75772>>>    
75772>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75774>>>    End_Object
75775>>>    
75775>>>    Object oCutMenuItem is a cCJCutMenuItem
75777>>>        Set pbControlBeginGroup to True
75778>>>    End_Object
75779>>>    
75779>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75781>>>    End_Object
75782>>>
75782>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75784>>>    End_Object
75785>>>
75785>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75787>>>    End_Object
75788>>>
75788>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75790>>>        Set pbControlBeginGroup to True
75791>>>    End_Object
75792>>>
75792>>>    Object oPromptMenuItem is a cCJPromptMenuItem
75794>>>        Set pbControlBeginGroup to True
75795>>>    End_Object
75796>>>
75796>>>    Object oFindNextMenu is a cCJFindNextMenuItem
75798>>>        Set pbControlBeginGroup to True
75799>>>    End_Object
75800>>>
75800>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75802>>>    End_Object
75803>>>
75803>>>    Object oClearMenuItem is a cCJClearMenuItem
75805>>>        Set pbControlBeginGroup to True
75806>>>    End_Object
75807>>>
75807>>>    Object oClearAllMenu is a cCJClearAllMenuItem
75809>>>    End_Object
75810>>>
75810>>>    Object oSaveMenu is a cCJSaveMenuItem
75812>>>    End_Object
75813>>>    
75813>>>    Object oDeleteMenu is a cCJDeleteMenuItem
75815>>>    End_Object
75816>>>
75816>>>    Object oRememberitem is a cCJRememberFieldMenuItem
75818>>>        Set pbControlBeginGroup to True
75819>>>    End_Object
75820>>>
75820>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
75822>>>    End_Object
75823>>>
75823>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
75825>>>    End_Object
75826>>>
75826>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
75828>>>    End_Object
75829>>>
75829>>>End_Object
75830>
75830>Object oMain is a Panel
75832>    Set Label to "Fuvaroz s management"
75833>    Set Location to 4 3
75834>    Set Size to 300 450
75835>
75835>    Object oCommandBarSystem is a cCJCommandBarSystem
75837>        Set pbTimerUpdate to True
75838>
75838>        Procedure OnCreateCommandBars
75841>            Handle hoOptions
75841>            Get OptionsObject to hoOptions
75842>            Forward Send OnCreateCommandBars
75844>        End_Procedure
75845>
75845>        Object oMenuBar is a cCJMenuBar
75847>
75847>            Object oFileMenu is a cCJMenuItem
75849>                Set peControlType to xtpControlPopup          
75850>                Set psCaption   to "&File"
75851>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
75852>                Set psCategory to "Menus"
75853>
75853>                Object oClearMenuItem is a cCJClearMenuItem
75855>                    Set pbAddToDesignerMenu to True
75856>                End_Object
75857>
75857>                Object oClearAllMenu is a cCJClearAllMenuItem
75859>                    Set pbAddToDesignerMenu to True
75860>                End_Object
75861>
75861>                Object oPromptMenuItem is a cCJPromptMenuItem
75863>                    Set pbAddToDesignerMenu to True
75864>                    Set pbControlBeginGroup to True
75865>                End_Object
75866>
75866>                Object oFindMenuItem is a cCJFindMenuItem
75868>                    Set pbAddToDesignerMenu to True
75869>                    Set pbControlBeginGroup to True
75870>                End_Object
75871>
75871>                Object oFindNextMenu is a cCJFindNextMenuItem
75873>                    Set pbAddToDesignerMenu to True
75874>                End_Object
75875>
75875>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75877>                    Set pbAddToDesignerMenu to True
75878>                End_Object
75879>
75879>                Object oFindFirstMenu is a cCJFindFirstMenuItem
75881>                    Set pbAddToDesignerMenu to True
75882>                End_Object
75883>
75883>                Object oFindLastMenu is a cCJFindLastMenuItem
75885>                    Set pbAddToDesignerMenu to True
75886>                End_Object
75887>
75887>                Object oSaveMenuItem is a cCJSaveMenuItem
75889>                    Set pbAddToDesignerMenu to True
75890>                    Set pbControlBeginGroup to True
75891>                End_Object
75892>
75892>                Object oDeleteMenuItem is a cCJDeleteMenuItem
75894>                    Set pbAddToDesignerMenu to True
75895>                End_Object
75896>
75896>                Object oExitMenu is a cCJExitMenuItem
75898>                    Set pbControlBeginGroup to True
75899>                End_Object
75900>
75900>            End_Object
75901>
75901>            Object oViewMenu is a cCJMenuItem
75903>                Set peControlType to xtpControlPopup
75904>                Set psCaption to "&View"
75905>                Set psToolTip to "View"
75906>                Set psDescription to "Available Views"
75907>
75907>                Object oAutoEntryMenuItem is a cCJMenuItem
75909>                    Set psCaption to "AutoEntry"
75910>                    Set psTooltip to "AutoEntry"
75911>                
75911>                    Procedure OnExecute Variant vCommandBarControl
75914>                        Handle hoClient
75914>                        Get Client_Id to hoClient
75915>                        Send Activate_oAutoEntry of hoClient
75916>                    End_Procedure
75917>                End_Object
75918>
75918>                Object oSoforEntryMenuItem is a cCJMenuItem
75920>                    Set psCaption to "SoforEntry"
75921>                    Set psTooltip to "SoforEntry"
75922>                
75922>                    Procedure OnExecute Variant vCommandBarControl
75925>                        Handle hoClient
75925>                        Get Client_Id to hoClient
75926>                        Send Activate_oSoforEntry of hoClient
75927>                    End_Procedure
75928>                End_Object
75929>
75929>                Object oTermkMenuItem is a cCJMenuItem
75931>                    Set psCaption to "Term‚k"
75932>                    Set psTooltip to "Term‚k"
75933>                
75933>                    Procedure OnExecute Variant vCommandBarControl
75936>                        Handle hoClient
75936>                        Get Client_Id to hoClient
75937>                        Send Activate_oTermekEntry of hoClient
75938>                    End_Procedure
75939>                End_Object
75940>            End_Object
75941>            
75941>            Object oReportMenu is a cCJMenuItem
75943>                Set peControlType to xtpControlPopup          
75944>                Set psCaption to "&Report"
75945>                Set psToolTip to "Report"
75946>                Set psDescription to "Available Reports"
75947>            End_Object
75948>
75948>            Object oNavigateMenu is a cCJMenuItem
75950>                Set peControlType to xtpControlPopup      
75951>                Set psCaption to "&Navigate"    
75952>                Set psTooltip to "Navigate"    
75953>                Set psDescription to "Move to different areas of the application"
75954>
75954>                Object oNextAreaMenu is a cCJNextAreaMenu
75956>                End_Object
75957>
75957>                Object oPriorAreaMenu is a cCJPriorAreaMenu
75959>                End_Object
75960>
75960>                Object oNextViewMenu is a cCJNextViewMenu
75962>                End_Object
75963>
75963>                Object oPriorViewMenu is a cCJPriorViewMenu
75965>                End_Object
75966>
75966>                Object oPromptMenu is a cCJPromptMenuItem
75968>                    Set pbControlBeginGroup to True
75969>                End_Object
75970>
75970>                Object oZoomMenu is a cCJZoomMenuItem
75972>                End_Object
75973>
75973>            End_Object
75974>
75974>            Object oWindowMenu is a cCJMDIWindowsMenuItem
75976>                Set peControlType to xtpControlPopup
75977>                Set psCaption to "&Window"
75978>                Set psToolTip to "Window"
75979>                Set psDescription to "Display Current Views and set other display options."    
75980>
75980>                // These are the static windows items. More will be created in onInitPopup 
75980>                Object oDisplayOptionsMenu is a cCJMenuItem
75982>                    Set peControlType to xtpControlPopup          
75983>                    Set psCaption to "&Display Options"
75984>                    Set psToolTip to "Display Options"
75985>                    Set psDescription to "Set display options"
75986>
75986>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
75988>                    End_Object
75989>
75989>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
75991>                    End_Object
75992>
75992>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
75994>                        Set pbControlBeginGroup to True
75995>                    End_Object
75996>
75996>                End_Object
75997>
75997>                Object oCascadeMenu is a cCJCascadeMenuItem
75999>                    Set pbControlBeginGroup to True
76000>                End_Object
76001>
76001>                Object oHorizTile is a cCJTileHorizontally
76003>                End_Object
76004>
76004>                Object oVertTile is a cCJTileVertically
76006>                End_Object
76007>
76007>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
76009>                    Set pbControlBeginGroup to True
76010>                End_Object
76011>
76011>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
76013>                End_Object
76014>
76014>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
76016>                    Set pbControlBeginGroup to True
76017>                End_Object
76018>
76018>            End_Object
76019>
76019>            Object oHelpMenu is a cCJMenuItem
76021>                Set peControlType to xtpControlPopup    
76022>                Set psCaption to "&Help"
76023>                Set psDescription to "Access Information for learning and using this DataFlex application."
76024>                Set psToolTip to "Help"
76025>
76025>                Object oHelpMenuItem is a cCJHelpMenuItem 
76027>                End_Object
76028>
76028>                Object oAboutMenuItem is a cCJAboutMenuItem
76030>                End_Object
76031>
76031>            End_Object
76032>
76032>        End_Object
76033>
76033>        Object oFindToolBar is a cCJToolbar
76035>            Set psTitle to "Finding Toolbar"
76036>
76036>            Object oFindFirstTool is a cCJFindFirstMenuItem
76038>            End_Object
76039>
76039>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
76041>            End_Object
76042>
76042>            Object oFindMenuTool is a cCJFindMenuItem
76044>            End_Object
76045>
76045>            Object oFindNextTool is a cCJFindNextMenuItem
76047>            End_Object
76048>
76048>            Object oFindLastTool is a cCJFindLastMenuItem
76050>            End_Object
76051>
76051>            Object oPromptToolItem is a cCJPromptMenuItem
76053>                Set pbControlBeginGroup to True
76054>            End_Object
76055>
76055>        End_Object
76056>
76056>        Object oFileToolBar is a cCJToolbar
76058>            Set psTitle to "Data Entry Toolbar"
76059>
76059>            Object oClearToolItem is a cCJClearMenuItem
76061>                Set peControlStyle to xtpButtonIconAndCaption
76062>            End_Object
76063>
76063>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
76065>                Set peControlStyle to xtpButtonIconAndCaption
76066>            End_Object
76067>
76067>            Object oSaveToolItem is a cCJSaveMenuItem
76069>                Set peControlStyle to xtpButtonIconAndCaption
76070>                Set pbControlBeginGroup to True
76071>            End_Object
76072>
76072>            Object oDeleteToolItem is a cCJDeleteMenuItem
76074>                Set peControlStyle to xtpButtonIconAndCaption
76075>            End_Object
76076>
76076>        End_Object
76077>
76077>        Object oEditToolBar is a cCJToolbar
76079>            Set psTitle to "Edit Toolbar"
76080>
76080>            Object oCutToolbarItem is a cCJCutMenuItem
76082>            End_Object
76083>
76083>            Object oCopyToolbarItem is a cCJCopyMenuItem
76085>            End_Object
76086>
76086>            Object oPasteToolbarItem is a cCJPasteMenuItem
76088>            End_Object
76089>
76089>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
76091>                Set pbControlBeginGroup to True
76092>            End_Object
76093>
76093>        End_Object
76094>
76094>        Object oRememberToolbar is a cCJToolbar
76096>            Set psTitle to C_$Remember
76097>
76097>            Object oRememberItems is a cCJMenuItem
76099>
76099>                Set peControlType to xtpControlPopup
76100>                Set peControlStyle to xtpButtonCaption
76101>                Set psCaption to C_$Remember
76102>                
76102>                Object oMenuItem is a cCJRememberFieldMenuItem
76104>                    Set peControlStyle to xtpButtonIconAndCaption
76105>                End_Object
76106>                
76106>                Object oMenuItem is a cCJRememberLastFieldMenuItem
76108>                    Set peControlStyle to xtpButtonIconAndCaption
76109>                End_Object
76110>                
76110>                Object oMenuItem is a cCJUnRememberFieldMenuItem
76112>                    Set peControlStyle to xtpButtonIconAndCaption
76113>                End_Object
76114>                
76114>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
76116>                    Set peControlStyle to xtpButtonIconAndCaption
76117>                End_Object
76118>
76118>            End_Object
76119>            
76119>        End_Object
76120>        
76120>        Object oStatusBar is a cCJStatusBar
76122>
76122>            Object oStatusPane1 is a cCJStatusBarPane
76124>                Set piID to sbpIDIdlePane
76125>                Set pbStyleStretch to True
76126>            End_Object
76127>
76127>            Object oStatusPane2 is a cCJStatusBarPane
76129>                Set phoViewPane to Self
76130>                Set pbStyleStretch to True
76131>            End_Object
76132>
76132>        End_Object
76133>
76133>    End_Object
76134>
76134>    Object oClientArea is a ClientArea
76136>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\StdAbout.pkg)
76136>>>//************************************************************************
76136>>>// Confidential Trade Secret.
76136>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76136>>>// as an unpublished work.  All rights reserved.
76136>>>// DataFlex is a registered trademark of Data Access Corporation.
76136>>>//
76136>>>//************************************************************************
76136>>>//************************************************************************
76136>>>//
76136>>>// $File name  : StdAbout.pkg
76136>>>// $File title : Standard about object package for VDF
76136>>>// Notice      :
76136>>>// $Author(s)  : John Tuohy
76136>>>//
76136>>>// $Rev History
76136>>>//
76136>>>// JT 06/27/97   File created
76136>>>//************************************************************************
76136>>>
76136>>>// This provides a quick and simple way to create an about package for a program.
76136>>>// You need to create a message inside you client area called Activate_About.
76136>>>// Within this message you should send the message DoAbout passing needed
76136>>>// string information.
76136>>>//
76136>>>//       Procedure Activate_About
76136>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
76136>>>//       End_Procedure
76136>>>//    where: sTitle =     Name of application. If none provided, uses caption
76136>>>//                        bar title
76136>>>//           sVersion   = Version Line. If none provided, will be blank
76136>>>//           sCopyRight = Copyright Line. If none provided, will be blank
76136>>>//           sAuthor    = Author name, blank if none provided
76136>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
76136>>>//                        is used.
76136>>>// It is expected that you will place this in your own object package. For
76136>>>// example an order about package may look like this:
76136>>>//
76136>>>//   // OrderAbout.pkg
76136>>>//   Use StdAbout.pkg
76136>>>//   Procedure Activate_About
76136>>>//      String sTitle sCopyright sVersion sAuthor
76136>>>//      Move "My Order Entry System" to sTitle
76136>>>//      Move "Version 2.1" to sVersion
76136>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
76136>>>//      Move "John Smith"  to sAuthor
76136>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
76136>>>//   end_procedure
76136>>>//   // end of file.
76136>>>
76136>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\Dfabout.pkg)
76136>>>>>//************************************************************************
76136>>>>>// Confidential Trade Secret.
76136>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76136>>>>>// as an unpublished work.  All rights reserved.
76136>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
76136>>>>>//
76136>>>>>//************************************************************************
76136>>>>>//************************************************************************
76136>>>>>//
76136>>>>>// $File name  : DfAbout.pkg
76136>>>>>// $File title : About class support
76136>>>>>// Notice      :
76136>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
76136>>>>>//
76136>>>>>// $Rev History
76136>>>>>//
76136>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
76136>>>>>//                Windows for the size first. 
76136>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
76136>>>>>//                with anchor technique. Removed unnessary property in the
76136>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
76136>>>>>//                object To better look in Windows XP. Repositioned the close
76136>>>>>//                button in the sysinfo dialog To line up with the display area
76136>>>>>//                Replaced obsolete code and techniques. Removed dead code.
76136>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
76136>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
76136>>>>>//                the global Workspace object, if it is present
76136>>>>>// JJT 11/05/98   Added version information
76136>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
76136>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
76136>>>>>//                workspace package.
76136>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
76136>>>>>//                class can create this object.
76136>>>>>//                Cleaned up the interface (used correct classes and messages)
76136>>>>>//                Added workspace reporting support To sys-info.
76136>>>>>//                Turned off wrapping in the sys-info editor.
76136>>>>>// KR  ??/??/96   File created
76136>>>>>//************************************************************************
76136>>>>>Use LanguageText.pkg
76136>>>>>Use Windows.pkg
76136>>>>>Use DFbitmap.pkg
76136>>>>>Use GlobalFunctionsProcedures.pkg
76136>>>>>Use cTextEdit.pkg
76136>>>>>
76136>>>>>Use cli.pkg
Including file: cli.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cli.pkg)
76136>>>>>>>//*****************************************************************************
76136>>>>>>>//*** CLI.PKG                                                               ***
76136>>>>>>>//***                                                                       ***
76136>>>>>>>//*** Author: Ben Weijers                                                   ***
76136>>>>>>>//***         Data Access Nederland                                         ***
76136>>>>>>>//***         10 September 1998                                             ***
76136>>>>>>>//***                                                                       ***
76136>>>>>>>//*** Purpose:                                                              ***
76136>>>>>>>//***   CLI specific functionality. There are several connectivity kits     ***
76136>>>>>>>//***   based on  SQL/92 CLI. Those are:                                    ***
76136>>>>>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
76136>>>>>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
76136>>>>>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
76136>>>>>>>//***                                                                       ***
76136>>>>>>>//***   This package defines the common functionality for all CLI based     ***
76136>>>>>>>//***   drivers.                                                            ***
76136>>>>>>>//***                                                                       ***
76136>>>>>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
76136>>>>>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
76136>>>>>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
76136>>>>>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
76136>>>>>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
76136>>>>>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
76136>>>>>>>//***             Added SQLSERVER2012CLIENT return value for                ***
76136>>>>>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
76136>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
76136>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
76136>>>>>>>//***             mssqldrv.pkg                                              ***
76136>>>>>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
76136>>>>>>>//***             Added type mappings attributes                            ***
76136>>>>>>>//***   Updated:  october 11, 2013 (Current CK build: 6.0.0.18)             ***
76136>>>>>>>//***             Added DF_FILE_SQL_FILTER_EQ attribute                     ***
76136>>>>>>>//*****************************************************************************
76136>>>>>>>
76136>>>>>>>//*** We are not using ifndef below because that is not supported in Character Mode
76136>>>>>>>//*** Driver attributes
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>//------------------------------------------------------------
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>//-------------------------------------
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>//*** Replacement for logical column number that indicates all columns
76136>>>>>>>
76136>>>>>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
76136>>>>>>>
76136>>>>>>>//*** Possible DF_FIELD_READ_ONLY values
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
76136>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
76136>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>// Moved to Mssqldrv.pkg
76136>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
76136>>>>>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
76136>>>>>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
76136>>>>>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
76136>>>>>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
76136>>>>>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
76136>>>>>>>
76136>>>>>>>//*** Possible SQL Column type values
76136>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
76136>>>>>>>Define SQL_CHAR           For    1
76136>>>>>>>Define SQL_NUMERIC        For    2
76136>>>>>>>Define SQL_DECIMAL        For    3
76136>>>>>>>Define SQL_INTEGER        For    4
76136>>>>>>>Define SQL_SMALLINT       For    5
76136>>>>>>>Define SQL_FLOAT          For    6
76136>>>>>>>Define SQL_REAL           For    7
76136>>>>>>>Define SQL_DOUBLE         For    8
76136>>>>>>>Define SQL_DATETIME       For    9
76136>>>>>>>Define SQL_VARCHAR        For   12
76136>>>>>>>Define SQL_TYPE_DATE      For   91
76136>>>>>>>Define SQL_TYPE_TIME      For   92
76136>>>>>>>Define SQL_TYPE_TIMESTAMP for   93
76136>>>>>>>// Moved to mssqldrv.pkg
76136>>>>>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>Define SQL_DATE           For    9
76136>>>>>>>Define SQL_INTERVAL       For   10
76136>>>>>>>Define SQL_TIME           For   10
76136>>>>>>>Define SQL_TIMESTAMP      For   11
76136>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
76136>>>>>>>Define SQL_BINARY         For  (-2)
76136>>>>>>>Define SQL_VARBINARY      For  (-3)
76136>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
76136>>>>>>>Define SQL_BIGINT         For  (-5)
76136>>>>>>>Define SQL_TINYINT        For  (-6)
76136>>>>>>>Define SQL_BIT            For  (-7)
76136>>>>>>>Define SQL_WCHAR          For  (-8)
76136>>>>>>>Define SQL_WVARCHAR       For  (-9)
76136>>>>>>>Define SQL_WLONGVARCHAR   For (-10)
76136>>>>>>>Define SQL_GUID           For (-11)
76136>>>>>>>
76136>>>>>>>//*** Driver level attributes
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>//*** Error number constants
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>//*** Call driver function identifiers
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>//*** Init data source types
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>//*** Dummy strings used in the commands
76136>>>>>>>    String  CLI$StrDummy 255
76136>>>>>>>    Integer CLI$IntDummy
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>//*****************************************************************************
76136>>>>>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
76136>>>>>>>//***                                                                       ***
76136>>>>>>>//***   Setup a constraint for a file.                                      ***
76136>>>>>>>//*****************************************************************************
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>//*****************************************************************************
76136>>>>>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
76136>>>>>>>//***                                                                       ***
76136>>>>>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
76136>>>>>>>//*** will be set for the remainder of the session or until set again. To   ***
76136>>>>>>>//*** permanently set driver level attributes change the driver             ***
76136>>>>>>>//*** configuration file.                                                   ***
76136>>>>>>>//*****************************************************************************
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>
76136>>>>>>>//*****************************************************************************
76136>>>>>>>//*** Class  : cCLIHandler                                                  ***
76136>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76136>>>>>>>//***          call several CLI releated methods.                           ***
76136>>>>>>>//*****************************************************************************
76136>>>>>>>
76136>>>>>>>Class cCLIHandler Is An Array
76137>>>>>>>
76137>>>>>>>    Procedure Construct_Object Integer iImage
76139>>>>>>>        Forward Send Construct_object iImage
76141>>>>>>>
76141>>>>>>>        Property String  psDriverID       Public ""
76142>>>>>>>    End_Procedure // Construct_Object
76143>>>>>>>
76143>>>>>>>
76143>>>>>>>
76143>>>>>>>    //***
76143>>>>>>>    //*** Fucntion: CKRevsion
76143>>>>>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
76143>>>>>>>    //***
76143>>>>>>>
76143>>>>>>>    Function CKRevision Returns String
76145>>>>>>>        Local String  sDriverID
76145>>>>>>>        Local String  sRevision
76145>>>>>>>        Local String  sVoid
76145>>>>>>>        Local Integer iRetval
76145>>>>>>>
76145>>>>>>>        Get psDriverID To sDriverID
76146>>>>>>>        If (sDRiverID <> "") Begin
76148>>>>>>>            Move (Repeat(" ", 255)) To sRevision
76149>>>>>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76154>>>>>>>        End
76154>>>>>>>>
76154>>>>>>>
76154>>>>>>>        Function_Return sRevision
76155>>>>>>>    End_Function // CKRevision
76156>>>>>>>
76156>>>>>>>
76156>>>>>>>
76156>>>>>>>    //***
76156>>>>>>>    //*** Function: ExtractPartFromRevision
76156>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76156>>>>>>>    //***
76156>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76156>>>>>>>    //***
76156>>>>>>>
76156>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76158>>>>>>>        Local Integer iPartRev
76158>>>>>>>        Local Integer iCurrentPart
76158>>>>>>>        Local Integer iSeparatorPos
76158>>>>>>>
76158>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76161>>>>>>>
76161>>>>>>>        Move 0 To iCurrentPart
76162>>>>>>>        Repeat
76162>>>>>>>>
76162>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76163>>>>>>>            If (iSeparatorPos > 0) Begin
76165>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76166>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76167>>>>>>>                Increment iCurrentPart
76168>>>>>>>            End
76168>>>>>>>>
76168>>>>>>>            Else If (sRevision <> "") Begin
76171>>>>>>>                Move sRevision To iPartRev
76172>>>>>>>                Move "" To sRevision
76173>>>>>>>                Increment iCurrentPart
76174>>>>>>>            End
76174>>>>>>>>
76174>>>>>>>            Else ;                Move -1 To iPartRev
76176>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76178>>>>>>>
76178>>>>>>>        Function_Return iPartRev
76179>>>>>>>    End_Function // EcxtractPartFromRevision
76180>>>>>>>
76180>>>>>>>
76180>>>>>>>
76180>>>>>>>    //***
76180>>>>>>>    //*** Function: CKMajorRevision
76180>>>>>>>    //*** Purpose : Returns the major revision of the CK
76180>>>>>>>    //***
76180>>>>>>>
76180>>>>>>>    Function CKMajorRevision Returns Integer
76182>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76183>>>>>>>    End_Function // CKMajorRevision
76184>>>>>>>
76184>>>>>>>
76184>>>>>>>
76184>>>>>>>    //***
76184>>>>>>>    //*** Function: CKMinorRevision
76184>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76184>>>>>>>    //***
76184>>>>>>>
76184>>>>>>>    Function CKMinorRevision Returns Integer
76186>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76187>>>>>>>    End_Function // CKMinorRevision
76188>>>>>>>
76188>>>>>>>
76188>>>>>>>
76188>>>>>>>    //***
76188>>>>>>>    //*** Function: CKReleaseRevision
76188>>>>>>>    //*** Purpose : Returns the release revision of the CK
76188>>>>>>>    //***
76188>>>>>>>
76188>>>>>>>    Function CKReleaseRevision Returns Integer
76190>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76191>>>>>>>    End_Function // CKReleaseRevision
76192>>>>>>>
76192>>>>>>>
76192>>>>>>>
76192>>>>>>>    //***
76192>>>>>>>    //*** Function: CKBuildRevision
76192>>>>>>>    //*** Purpose : Returns the major revision of the CK
76192>>>>>>>    //***
76192>>>>>>>
76192>>>>>>>    Function CKBuildRevision Returns Integer
76194>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76195>>>>>>>    End_Function // CKBuildRevision
76196>>>>>>>
76196>>>>>>>
76196>>>>>>>
76196>>>>>>>    //***
76196>>>>>>>    //*** Function: IsMinimalRevision
76196>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76196>>>>>>>    //***
76196>>>>>>>
76196>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76198>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76201>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76204>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76207>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76210>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76213>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76217>>>>>>>            End
76217>>>>>>>>
76217>>>>>>>        End
76217>>>>>>>>
76217>>>>>>>
76217>>>>>>>        Function_Return (FALSE)
76218>>>>>>>    End_Function // IsMinimalRevision
76219>>>>>>>
76219>>>>>>>
76219>>>>>>>
76219>>>>>>>    //***
76219>>>>>>>    //*** Function: RegistrationName
76219>>>>>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
76219>>>>>>>    //***
76219>>>>>>>
76219>>>>>>>    Function RegistrationName Returns String
76221>>>>>>>        Local String  sRegistration
76221>>>>>>>        Local String  sDRiverId
76221>>>>>>>        Local String  sVoid
76221>>>>>>>        Local Integer iRetval
76221>>>>>>>
76221>>>>>>>        Get psDriverID To sDriverID
76222>>>>>>>        If (sDRiverID <> "") Begin
76224>>>>>>>            Move (Repeat(" ", 255)) To sRegistration
76225>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
76230>>>>>>>        End
76230>>>>>>>>
76230>>>>>>>
76230>>>>>>>        Function_Return sRegistration
76231>>>>>>>    End_Function // RegistrationName
76232>>>>>>>
76232>>>>>>>
76232>>>>>>>
76232>>>>>>>    //***
76232>>>>>>>    //*** Function: SerialNumber
76232>>>>>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
76232>>>>>>>    //***
76232>>>>>>>
76232>>>>>>>    Function SerialNumber Returns Integer
76234>>>>>>>        Local String  sDRiverId
76234>>>>>>>        Local String  sVoid
76234>>>>>>>        Local Integer iRetval
76234>>>>>>>
76234>>>>>>>        Get psDriverID To sDriverID
76235>>>>>>>        If (sDRiverID <> "") Begin
76237>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
76242>>>>>>>        End
76242>>>>>>>>
76242>>>>>>>
76242>>>>>>>        Function_Return iRetval
76243>>>>>>>    End_Function // SerialNumber
76244>>>>>>>
76244>>>>>>>
76244>>>>>>>
76244>>>>>>>    //***
76244>>>>>>>    //*** Function: MaxUsers
76244>>>>>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
76244>>>>>>>    //***
76244>>>>>>>
76244>>>>>>>    Function MaxUsers Returns Integer
76246>>>>>>>        Local String  sDRiverId
76246>>>>>>>        Local String  sVoid
76246>>>>>>>        Local Integer iRetval
76246>>>>>>>
76246>>>>>>>        Get psDriverID To sDriverID
76247>>>>>>>        If (sDRiverID <> "") Begin
76249>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
76254>>>>>>>        End
76254>>>>>>>>
76254>>>>>>>
76254>>>>>>>        Function_Return iRetval
76255>>>>>>>    End_Function // MaxUsers
76256>>>>>>>
76256>>>>>>>
76256>>>>>>>
76256>>>>>>>    //***
76256>>>>>>>    //*** Procedure: DumpStatus
76256>>>>>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
76256>>>>>>>    //***
76256>>>>>>>
76256>>>>>>>    Procedure DumpStatus String sFileName
76258>>>>>>>        Local String  sVoid
76258>>>>>>>        Local String  sDriverID
76258>>>>>>>        Local Integer iVoid
76258>>>>>>>
76258>>>>>>>        Get psDriverID To sDriverID
76259>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
76266>>>>>>>    End_Procedure // DumpStatus
76267>>>>>>>
76267>>>>>>>
76267>>>>>>>
76267>>>>>>>    //***
76267>>>>>>>    //*** Procedure: ReadConfiguration
76267>>>>>>>    //*** Purpose  : Reset all driver level configurable attributes to the
76267>>>>>>>    //***            default value and then reread the configuration.
76267>>>>>>>    //***
76267>>>>>>>
76267>>>>>>>    Procedure ReadConfiguration
76269>>>>>>>        Local String  sVoid
76269>>>>>>>        Local String  sDriverID
76269>>>>>>>        Local Integer iVoid
76269>>>>>>>
76269>>>>>>>        Get psDriverID To sDriverID
76270>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
76277>>>>>>>    End_Procedure // ReadConfiguration
76278>>>>>>>
76278>>>>>>>
76278>>>>>>>
76278>>>>>>>    //***
76278>>>>>>>    //*** Function: TextToRIMValue
76278>>>>>>>    //*** Purpose : Convert a text to the corresponding
76278>>>>>>>    //***           Generate_Record_ID_Method attribute value
76278>>>>>>>    //***
76278>>>>>>>
76278>>>>>>>    Function TextToRIMValue String sText Returns Integer
76280>>>>>>>        If (sText = "None") ;            Function_return RIM_NONE
76283>>>>>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
76287>>>>>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
76291>>>>>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
76295>>>>>>>    End_Function // TextToRIMValue
76296>>>>>>>
76296>>>>>>>
76296>>>>>>>
76296>>>>>>>    //***
76296>>>>>>>    //*** Function: RIMValueTotext
76296>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76296>>>>>>>    //***           corresponding text.
76296>>>>>>>    //***
76296>>>>>>>
76296>>>>>>>    Function RIMValueToText Integer iAttrValue Returns String
76298>>>>>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
76301>>>>>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
76305>>>>>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
76309>>>>>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
76313>>>>>>>    End_Function // RIMValueToText
76314>>>>>>>
76314>>>>>>>
76314>>>>>>>
76314>>>>>>>    //***
76314>>>>>>>    //*** Function: TextToROValue
76314>>>>>>>    //*** Purpose : Convert a text to the corresponding
76314>>>>>>>    //***           Generate_Record_ID_Method attribute value
76314>>>>>>>    //***
76314>>>>>>>
76314>>>>>>>    Function TextToROValue String sText Returns Integer
76316>>>>>>>        If (sText = "No") ;            Function_return RO_NO
76319>>>>>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
76323>>>>>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
76327>>>>>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
76331>>>>>>>    End_Function // TextToRIMValue
76332>>>>>>>
76332>>>>>>>
76332>>>>>>>
76332>>>>>>>    //***
76332>>>>>>>    //*** Function: ROValueTotext
76332>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76332>>>>>>>    //***           corresponding text.
76332>>>>>>>    //***
76332>>>>>>>
76332>>>>>>>    Function ROValueToText Integer iAttrValue Returns String
76334>>>>>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
76337>>>>>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
76341>>>>>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
76345>>>>>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
76349>>>>>>>    End_Function // RIMValueToText
76350>>>>>>>
76350>>>>>>>
76350>>>>>>>
76350>>>>>>>    //***
76350>>>>>>>    //*** Function: LastDriverError
76350>>>>>>>    //*** Purpose : Return the text f the last error geneated by the driver.
76350>>>>>>>    //***
76350>>>>>>>
76350>>>>>>>    Function LastDriverError Returns String
76352>>>>>>>        Local String  sDriverID
76352>>>>>>>        Local String  sLastError
76352>>>>>>>        Local String  sLastErrorLength
76352>>>>>>>        Local Integer iLastErrorLength
76352>>>>>>>        Local Integer iVoid
76352>>>>>>>
76352>>>>>>>        //*** Initialize
76352>>>>>>>        Move "" To sLastError
76353>>>>>>>
76353>>>>>>>        Get psDriverID To sDriverID
76354>>>>>>>        If (sDriverID <> "") Begin
76356>>>>>>>            //*** Get the text of the last error
76356>>>>>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
76357>>>>>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
76362>>>>>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
76363>>>>>>>
76363>>>>>>>            If (iLastErrorLength > 0) Begin
76365>>>>>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
76366>>>>>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
76371>>>>>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
76372>>>>>>>            End
76372>>>>>>>>
76372>>>>>>>        End
76372>>>>>>>>
76372>>>>>>>
76372>>>>>>>        Function_Return sLastError
76373>>>>>>>    End_Function // LastDriverError
76374>>>>>>>
76374>>>>>>>
76374>>>>>>>
76374>>>>>>>    //***
76374>>>>>>>    //*** Function: EnumerateTables
76374>>>>>>>    //*** Purpose : Enumerate the tables in a database
76374>>>>>>>    //***
76374>>>>>>>
76374>>>>>>>    Function EnumerateTables String sLogin Returns Integer
76376>>>>>>>        Local String  sDriver
76376>>>>>>>        Local String  sVoid
76376>>>>>>>        Local Integer iNumTables
76376>>>>>>>        Local Integer iVoid
76376>>>>>>>
76376>>>>>>>        Get psDriverID To sDriver
76377>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
76384>>>>>>>
76384>>>>>>>        Function_Return iNumTables
76385>>>>>>>    End_Function // EnumerateTables
76386>>>>>>>
76386>>>>>>>
76386>>>>>>>
76386>>>>>>>    //***
76386>>>>>>>    //*** Function: TableName
76386>>>>>>>    //*** Purpose : Returns the name of the table enumerated at the given position
76386>>>>>>>    //***
76386>>>>>>>
76386>>>>>>>    Function TableName Integer iIndex Returns String
76388>>>>>>>        Local String  sDriver
76388>>>>>>>        Local String  sTableName
76388>>>>>>>        Local String  sVoid
76388>>>>>>>        Local Integer iVoid
76388>>>>>>>
76388>>>>>>>        Get psDriverID To sDriver
76389>>>>>>>        If (sDriver <> "") Begin
76391>>>>>>>            Move (Repeat(" ", 255)) To sTableName
76392>>>>>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
76397>>>>>>>        End
76397>>>>>>>>
76397>>>>>>>
76397>>>>>>>        Function_Return sTableName
76398>>>>>>>    End_Function // TableName
76399>>>>>>>
76399>>>>>>>
76399>>>>>>>
76399>>>>>>>    //***
76399>>>>>>>    //*** Function: SchemaName
76399>>>>>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
76399>>>>>>>    //***
76399>>>>>>>
76399>>>>>>>    Function SchemaName Integer iIndex Returns String
76401>>>>>>>        Local String  sDriver
76401>>>>>>>        Local String  sSchemaName
76401>>>>>>>        Local String  sVoid
76401>>>>>>>        Local Integer iVoid
76401>>>>>>>
76401>>>>>>>        Get psDriverID To sDriver
76402>>>>>>>        If (sDriver <> "") Begin
76404>>>>>>>            Move (Repeat(" ", 255)) To sSchemaName
76405>>>>>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
76410>>>>>>>        End
76410>>>>>>>>
76410>>>>>>>
76410>>>>>>>        Function_Return sSchemaName
76411>>>>>>>    End_Function // SchemaName
76412>>>>>>>
76412>>>>>>>
76412>>>>>>>
76412>>>>>>>    //***
76412>>>>>>>    //*** Function: TableType
76412>>>>>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
76412>>>>>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
76412>>>>>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
76412>>>>>>>    //***
76412>>>>>>>
76412>>>>>>>    Function TableType Integer iIndex Returns String
76414>>>>>>>        Local String  sDriver
76414>>>>>>>        Local String  sTableType
76414>>>>>>>        Local String  sVoid
76414>>>>>>>        Local Integer iVoid
76414>>>>>>>
76414>>>>>>>        Get psDriverID To sDriver
76415>>>>>>>        If (sDriver <> "") Begin
76417>>>>>>>            Move (Repeat(" ", 25)) To sTableType
76418>>>>>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
76423>>>>>>>        End
76423>>>>>>>>
76423>>>>>>>
76423>>>>>>>        Function_Return sTableType
76424>>>>>>>    End_Function // TableType
76425>>>>>>>
76425>>>>>>>
76425>>>>>>>
76425>>>>>>>    //***
76425>>>>>>>    //*** Function: TableComment
76425>>>>>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
76425>>>>>>>    //***
76425>>>>>>>
76425>>>>>>>    Function TableComment Integer iIndex Returns String
76427>>>>>>>        Local String  sDriver
76427>>>>>>>        Local String  sTableComment
76427>>>>>>>        Local String  sVoid
76427>>>>>>>        Local Integer iVoid
76427>>>>>>>
76427>>>>>>>        Get psDriverID To sDriver
76428>>>>>>>        If (sDriver <> "") Begin
76430>>>>>>>            Move (Repeat(" ", 255)) To sTableComment
76431>>>>>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
76436>>>>>>>        End
76436>>>>>>>>
76436>>>>>>>
76436>>>>>>>        Function_Return sTableComment
76437>>>>>>>    End_Function // TableComment
76438>>>>>>>
76438>>>>>>>
76438>>>>>>>
76438>>>>>>>    //***
76438>>>>>>>    //*** Function: EnumerateColumns
76438>>>>>>>    //*** Purpose : Enumerate the columns in a table
76438>>>>>>>    //***
76438>>>>>>>
76438>>>>>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
76440>>>>>>>        Local String  sDriver
76440>>>>>>>        Local Integer iNumColumns
76440>>>>>>>        Local Integer iVoid
76440>>>>>>>
76440>>>>>>>        Get psDriverID To sDriver
76441>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
76448>>>>>>>
76448>>>>>>>        Function_Return iNumColumns
76449>>>>>>>    End_Function // EnumerateColumns
76450>>>>>>>
76450>>>>>>>
76450>>>>>>>
76450>>>>>>>    //***
76450>>>>>>>    //*** Function: ColumnName
76450>>>>>>>    //*** Purpose : Returns the name of the column enumerated at the given position
76450>>>>>>>    //***
76450>>>>>>>
76450>>>>>>>    Function ColumnName Integer iIndex Returns String
76452>>>>>>>        Local String  sDriver
76452>>>>>>>        Local String  sColumnName
76452>>>>>>>        Local String  sVoid
76452>>>>>>>        Local Integer iVoid
76452>>>>>>>
76452>>>>>>>        Get psDriverID To sDriver
76453>>>>>>>        If (sDriver <> "") Begin
76455>>>>>>>            Move (Repeat(" ", 255)) To sColumnName
76456>>>>>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
76461>>>>>>>        End
76461>>>>>>>>
76461>>>>>>>
76461>>>>>>>        Function_Return sColumnName
76462>>>>>>>    End_Function // ColumnName
76463>>>>>>>
76463>>>>>>>
76463>>>>>>>
76463>>>>>>>    //***
76463>>>>>>>    //*** Function: CLIDFDateToSQLDate
76463>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
76463>>>>>>>    //***
76463>>>>>>>
76463>>>>>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
76465>>>>>>>        Local String sSQLDate
76465>>>>>>>        Local Integer iOrgDateFmt
76465>>>>>>>        Local Integer iOrgDateSep
76465>>>>>>>
76465>>>>>>>        //*** Change date format to military, SQL dates are military dates
76465>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76468>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76471>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76474>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76477>>>>>>>
76477>>>>>>>        //*** We only need to convert if the date is 0
76477>>>>>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
76486>>>>>>>        Else ;            Move dDFDate To sSQLDate
76488>>>>>>>
76488>>>>>>>        //*** Change date format back to original
76488>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76491>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76494>>>>>>>
76494>>>>>>>        Function_Return sSQLDate
76495>>>>>>>    End_Function // CLIDFDateToSQLDate
76496>>>>>>>
76496>>>>>>>
76496>>>>>>>
76496>>>>>>>    //***
76496>>>>>>>    //*** Function: CLISQLDateToDFDate
76496>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
76496>>>>>>>    //***
76496>>>>>>>
76496>>>>>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
76498>>>>>>>        Local Date dDFDate
76498>>>>>>>        Local String sDummyDateValue
76498>>>>>>>        Local Integer iOrgDateFmt
76498>>>>>>>        Local Integer iOrgDateSep
76498>>>>>>>
76498>>>>>>>        //*** Change date format to military, SQL dates are military dates
76498>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76501>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76504>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76507>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76510>>>>>>>
76510>>>>>>>        //*** We only need to convert if the date is the dummy zero date value
76510>>>>>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
76517>>>>>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
76520>>>>>>>        Else ;            Move sSQLDate To dDFDate
76522>>>>>>>
76522>>>>>>>        //*** Change date format back to original
76522>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76525>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76528>>>>>>>
76528>>>>>>>        Function_Return dDFDate
76529>>>>>>>    End_Function // CLISQLDateToDFDate
76530>>>>>>>
76530>>>>>>>
76530>>>>>>>
76530>>>>>>>    //***
76530>>>>>>>    //*** Function: RedirectConnection
76530>>>>>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
76530>>>>>>>    //***           will point to another database but all tables will stay
76530>>>>>>>    //***           open!
76530>>>>>>>    //***
76530>>>>>>>
76530>>>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
76532>>>>>>>        Local String  sDriver
76532>>>>>>>        Local String  sVoid
76532>>>>>>>        Local Integer iResult
76532>>>>>>>        Local Integer iVoid
76532>>>>>>>
76532>>>>>>>        Get psDriverID To sDriver
76533>>>>>>>        If (sDriver <> "") Begin
76535>>>>>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
76540>>>>>>>        End
76540>>>>>>>>
76540>>>>>>>        Function_Return iResult
76541>>>>>>>    End_Function // RedirectConnect
76542>>>>>>>
76542>>>>>>>
76542>>>>>>>
76542>>>>>>>    //***
76542>>>>>>>    //*** Function: CreateConnectionID
76542>>>>>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
76542>>>>>>>    //***
76542>>>>>>>
76542>>>>>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
76544>>>>>>>        Local String  sDriver
76544>>>>>>>        Local Integer iResult
76544>>>>>>>        Local Integer iOptions
76544>>>>>>>
76544>>>>>>>        Get psDriverID to sDriver
76545>>>>>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
76548>>>>>>>        Else ;            Move iOpt to iOptions
76550>>>>>>>        If (sDriver <> "") Begin
76552>>>>>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
76557>>>>>>>        End
76557>>>>>>>>
76557>>>>>>>        Function_Return iResult
76558>>>>>>>    End_Function // CreateConnectionID
76559>>>>>>>
76559>>>>>>>
76559>>>>>>>
76559>>>>>>>    //***
76559>>>>>>>    //*** Function: DeleteConnectionID
76559>>>>>>>    //*** Purpose : Delete a DataFlex side connection id.
76559>>>>>>>    //***
76559>>>>>>>
76559>>>>>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
76561>>>>>>>        Local String  sDriver
76561>>>>>>>        Local Integer iResult
76561>>>>>>>        Local String sVoid
76561>>>>>>>
76561>>>>>>>        Get psDriverID To sDriver
76562>>>>>>>        If (sDriver <> "") Begin
76564>>>>>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
76569>>>>>>>        End
76569>>>>>>>>
76569>>>>>>>        Function_Return iResult
76570>>>>>>>    End_Function // DeleteConnectionID
76571>>>>>>>
76571>>>>>>>End_Class // cCLIHandler
76572>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 18.2\Pkg\DFBTRDRV.PKG)
76572>>>>>>>//****************************************************************************
76572>>>>>>>//
76572>>>>>>>// $File name  : DFBTRDRV.PKG
76572>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
76572>>>>>>>// Notice      : This package contains constants and commands, used to call
76572>>>>>>>//               specific functions in the DFBTRDRV.
76572>>>>>>>// $Author(s)  : Eddy Kleinjan
76572>>>>>>>//
76572>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
76572>>>>>>>// Created     : 01-07-97 @ 12:00:00
76572>>>>>>>//
76572>>>>>>>// Changed     : 04-04-2001.
76572>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
76572>>>>>>>//
76572>>>>>>>// Changed     : June 6, 2001
76572>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
76572>>>>>>>//
76572>>>>>>>//               Added DFBTR_DDF_OWNER command.
76572>>>>>>>//
76572>>>>>>>// Changed     : June 12, 2001
76572>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
76572>>>>>>>//
76572>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
76572>>>>>>>//
76572>>>>>>>// Changed     : August 4, 2004
76572>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
76572>>>>>>>//
76572>>>>>>>//               Added cDfbtrdrvHandler class.
76572>>>>>>>//               New functions in this class:
76572>>>>>>>//                  Function CKRevision Returns String
76572>>>>>>>//                  Function CkUsesUri Returns Integer
76572>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76572>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76572>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76572>>>>>>>//
76572>>>>>>>// Changed     : September 30, 2005
76572>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
76572>>>>>>>//
76572>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
76572>>>>>>>//****************************************************************************
76572>>>>>>>Use Ui
76572>>>>>>>//
76572>>>>>>>// Driver Indentification
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>//*** Driver attributes
76572>>>>>>>//
76572>>>>>>>// Call_Driver functions ID's
76572>>>>>>>//
76572>>>>>>>//
76572>>>>>>>// DFBTRFN_CONVERT_FILE options
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// DFBTRFN_SET_OWNER options
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to create all vars which may be needed
76572>>>>>>>// in other commands.
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to set the owner of a Btrieve file.
76572>>>>>>>// File must have been opened.
76572>>>>>>>// Filenumber needs to be passed.
76572>>>>>>>// To clear set the owner to "".
76572>>>>>>>// Examples:
76572>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
76572>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
76572>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
76572>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
76572>>>>>>>// To clear:
76572>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to parse DFBTR_SET_OWNVER
76572>>>>>>>// options.
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to parse for Callback
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to clear the owner of a Btrieve file.
76572>>>>>>>// File must have been opened.
76572>>>>>>>// Filenumber needs to be passed.
76572>>>>>>>// Examples:
76572>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to add a owner name to the internal list of ownernames
76572>>>>>>>// which will be tries when opening files.
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to remove all owners from the internal list of ownernames
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to set the owner name to be used when opening the DDF files.
76572>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
76572>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
76572>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to change the transaction type.
76572>>>>>>>// Valid types are:
76572>>>>>>>//     DFBTRTT_NONE
76572>>>>>>>//     DFBTRTT_EXCLUSIVE
76572>>>>>>>//     DFBTRTT_CONCURRENT
76572>>>>>>>//
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to get the current transaction type.
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to set explicit_locking
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to get explicit locking
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>//
76572>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
76572>>>>>>>//
76572>>>>>>>
76572>>>>>>>//*****************************************************************************
76572>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
76572>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76572>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
76572>>>>>>>//*****************************************************************************
76572>>>>>>>
76572>>>>>>>Class cDFBtrDrvHandler Is An Array
76573>>>>>>>
76573>>>>>>>    Procedure Construct_Object Integer iImage
76575>>>>>>>        Forward Send Construct_object iImage
76577>>>>>>>
76577>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
76578>>>>>>>    End_Procedure // Construct_Object
76579>>>>>>>
76579>>>>>>>
76579>>>>>>>
76579>>>>>>>    //***
76579>>>>>>>    //*** Function: CKRevsion
76579>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
76579>>>>>>>    //***
76579>>>>>>>
76579>>>>>>>    Function CKRevision Returns String
76581>>>>>>>        Local String  sDriverID
76581>>>>>>>        Local String  sRevision
76581>>>>>>>        Local String  sVoid
76581>>>>>>>        Local Integer iRetval
76581>>>>>>>
76581>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76581>>>>>>>        // This error would otherwise be raised when we have an older
76581>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76581>>>>>>>        Send Ignore_error To Error_object_Id 20491
76582>>>>>>>        Get psDriverID To sDriverID
76583>>>>>>>        Move (Repeat(" ", 255)) To sRevision
76584>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76589>>>>>>>        Send Trap_Error To Error_object_Id 20491
76590>>>>>>>        If (Trim(sRevision) = "") Begin
76592>>>>>>>            // Unable to get the revision. return all zeroes.
76592>>>>>>>            Move "0.0.0.0" To sRevision
76593>>>>>>>        End
76593>>>>>>>>
76593>>>>>>>        Function_Return sRevision
76594>>>>>>>    End_Function // CKRevision
76595>>>>>>>
76595>>>>>>>    Function CkUsesUri Returns Integer
76597>>>>>>>        Local String  sDriverID
76597>>>>>>>        Local String  sVoid1
76597>>>>>>>        Local String  sVoid2
76597>>>>>>>        Local Integer iRetval
76597>>>>>>>
76597>>>>>>>        Get psDriverID To sDriverID
76598>>>>>>>
76598>>>>>>>        Move 0 To iRetval
76599>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76599>>>>>>>        // This error would otherwise be raised when we have an older
76599>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
76599>>>>>>>        Send Ignore_error To Error_object_Id 20491
76600>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
76605>>>>>>>        Send Trap_Error To Error_object_Id 20491
76606>>>>>>>
76606>>>>>>>        Function_Return iRetval
76607>>>>>>>    End_Function // CKUsesUri
76608>>>>>>>
76608>>>>>>>
76608>>>>>>>
76608>>>>>>>    //***
76608>>>>>>>    //*** Function: ExtractPartFromRevsion
76608>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76608>>>>>>>    //***
76608>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76608>>>>>>>    //***
76608>>>>>>>
76608>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76610>>>>>>>        Local Integer iPartRev
76610>>>>>>>        Local Integer iCurrentPart
76610>>>>>>>        Local Integer iSeparatorPos
76610>>>>>>>
76610>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76613>>>>>>>
76613>>>>>>>        Move 0 To iCurrentPart
76614>>>>>>>        Repeat
76614>>>>>>>>
76614>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76615>>>>>>>            If (iSeparatorPos > 0) Begin
76617>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76618>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76619>>>>>>>                Increment iCurrentPart
76620>>>>>>>            End
76620>>>>>>>>
76620>>>>>>>            Else If (sRevision <> "") Begin
76623>>>>>>>                Move sRevision To iPartRev
76624>>>>>>>                Move "" To sRevision
76625>>>>>>>                Increment iCurrentPart
76626>>>>>>>            End
76626>>>>>>>>
76626>>>>>>>            Else ;                Move -1 To iPartRev
76628>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76630>>>>>>>
76630>>>>>>>        Function_Return iPartRev
76631>>>>>>>    End_Function // EcxtractPartFromRevision
76632>>>>>>>
76632>>>>>>>
76632>>>>>>>
76632>>>>>>>    //***
76632>>>>>>>    //*** Function: CKMajorRevision
76632>>>>>>>    //*** Purpose : Returns the major revision of the CK
76632>>>>>>>    //***
76632>>>>>>>
76632>>>>>>>    Function CKMajorRevision Returns Integer
76634>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76635>>>>>>>    End_Function // CKMajorRevision
76636>>>>>>>
76636>>>>>>>
76636>>>>>>>
76636>>>>>>>    //***
76636>>>>>>>    //*** Function: CKMinorRevision
76636>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76636>>>>>>>    //***
76636>>>>>>>
76636>>>>>>>    Function CKMinorRevision Returns Integer
76638>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76639>>>>>>>    End_Function // CKMinorRevision
76640>>>>>>>
76640>>>>>>>
76640>>>>>>>
76640>>>>>>>    //***
76640>>>>>>>    //*** Function: CKReleaseRevision
76640>>>>>>>    //*** Purpose : Returns the release revision of the CK
76640>>>>>>>    //***
76640>>>>>>>
76640>>>>>>>    Function CKReleaseRevision Returns Integer
76642>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76643>>>>>>>    End_Function // CKReleaseRevision
76644>>>>>>>
76644>>>>>>>
76644>>>>>>>
76644>>>>>>>    //***
76644>>>>>>>    //*** Function: CKBuildRevision
76644>>>>>>>    //*** Purpose : Returns the major revision of the CK
76644>>>>>>>    //***
76644>>>>>>>
76644>>>>>>>    Function CKBuildRevision Returns Integer
76646>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76647>>>>>>>    End_Function // CKBuildRevision
76648>>>>>>>
76648>>>>>>>
76648>>>>>>>
76648>>>>>>>    //***
76648>>>>>>>    //*** Function: IsMinimalRevision
76648>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76648>>>>>>>    //***
76648>>>>>>>
76648>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76650>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76653>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76656>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76659>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76662>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76665>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76669>>>>>>>            End
76669>>>>>>>>
76669>>>>>>>        End
76669>>>>>>>>
76669>>>>>>>
76669>>>>>>>        Function_Return (FALSE)
76670>>>>>>>    End_Function // IsMinimalRevision
76671>>>>>>>
76671>>>>>>>    //   Functions to query the Pervasive.SQL version:
76671>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
76671>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
76671>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
76671>>>>>>>    //
76671>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
76671>>>>>>>    //   in the following format:
76671>>>>>>>    //       <version>.<revision>.<type>
76671>>>>>>>    //   possible values for <type>:
76671>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
76671>>>>>>>    //         server using Workgroup authentication mode
76671>>>>>>>    //       C for client cache engine
76671>>>>>>>    //       D for DOS workstation
76671>>>>>>>    //       N for client Requester
76671>>>>>>>    //       S for NetWare server
76671>>>>>>>    //       T for 32-bit Windows server engine
76671>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
76671>>>>>>>    //
76671>>>>>>>    //   example:
76671>>>>>>>    //       8.50.T
76671>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
76671>>>>>>>    //   32-bits Windows server.
76671>>>>>>>    //
76671>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
76671>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
76671>>>>>>>    //
76671>>>>>>>    //   If the version information is not available or can not be obtained
76671>>>>>>>    //   the functions will return "0.0.0"
76671>>>>>>>
76671>>>>>>>
76671>>>>>>>    //***
76671>>>>>>>    //*** Function: PSQLRequesterVersionInfo
76671>>>>>>>    //*** Purpose : Returns the version information of the
76671>>>>>>>    //***           Pervasive.SQL Client requester.
76671>>>>>>>
76671>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76673>>>>>>>
76673>>>>>>>        Local String  sDriverID
76673>>>>>>>        Local String  sVersion
76673>>>>>>>        Local String  sVoid
76673>>>>>>>        Local Integer iRetval
76673>>>>>>>
76673>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76673>>>>>>>        // This error would otherwise be raised when we have an older
76673>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76673>>>>>>>        Send Ignore_error To Error_object_Id 20491
76674>>>>>>>        Get psDriverID To sDriverID
76675>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76676>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76681>>>>>>>        Send Trap_Error To Error_object_Id 20491
76682>>>>>>>        If (Trim(sVersion) = "") Begin
76684>>>>>>>            // Unable to get the revision. return all zeroes.
76684>>>>>>>            Move "0.0.0" To sVersion
76685>>>>>>>        End
76685>>>>>>>>
76685>>>>>>>        Function_Return sVersion
76686>>>>>>>    End_Function //  PSQLRequesterVersion
76687>>>>>>>
76687>>>>>>>    //***
76687>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
76687>>>>>>>    //*** Purpose : Returns the version information of the
76687>>>>>>>    //***           Pervasive.SQL Local Engine
76687>>>>>>>
76687>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76689>>>>>>>
76689>>>>>>>        Local String  sDriverID
76689>>>>>>>        Local String  sVersion
76689>>>>>>>        Local String  sVoid
76689>>>>>>>        Local Integer iRetval
76689>>>>>>>
76689>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76689>>>>>>>        // This error would otherwise be raised when we have an older
76689>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76689>>>>>>>        Send Ignore_error To Error_object_Id 20491
76690>>>>>>>        Get psDriverID To sDriverID
76691>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76692>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76697>>>>>>>        Send Trap_Error To Error_object_Id 20491
76698>>>>>>>        If (Trim(sVersion) = "") Begin
76700>>>>>>>            // Unable to get the revision. return all zeroes.
76700>>>>>>>            Move "0.0.0" To sVersion
76701>>>>>>>        End
76701>>>>>>>>
76701>>>>>>>        Function_Return sVersion
76702>>>>>>>    End_Function //  PSQLLocalEngineVersion
76703>>>>>>>
76703>>>>>>>    //***
76703>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
76703>>>>>>>    //*** Purpose : Returns the version information of the
76703>>>>>>>    //***           Pervasive.SQL Server Engine
76703>>>>>>>
76703>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76705>>>>>>>
76705>>>>>>>        Local String  sDriverID
76705>>>>>>>        Local String  sVersion
76705>>>>>>>        Local String  sVoid
76705>>>>>>>        Local Integer iRetval
76705>>>>>>>
76705>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76705>>>>>>>        // This error would otherwise be raised when we have an older
76705>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76705>>>>>>>        Send Ignore_error To Error_object_Id 20491
76706>>>>>>>        Get psDriverID To sDriverID
76707>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76708>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76713>>>>>>>        Send Trap_Error To Error_object_Id 20491
76714>>>>>>>        If (Trim(sVersion) = "") Begin
76716>>>>>>>            // Unable to get the revision. return all zeroes.
76716>>>>>>>            Move "0.0.0" To sVersion
76717>>>>>>>        End
76717>>>>>>>>
76717>>>>>>>        Function_Return sVersion
76718>>>>>>>    End_Function //  PSQLServerEngineVersion
76719>>>>>>>
76719>>>>>>>End_Class // cDfbtrdrvHandler
76720>>>>>>>
76720>>>>>
76720>>>>>
76720>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
76721>>>>>
76721>>>>>Register_Function phoWorkspace Returns Handle
76721>>>>>Register_Function Help_filename Returns String
76721>>>>>Register_Function GetHelpFile Returns String
76721>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
76721>>>>>
76721>>>>>//****************************************************************************
76721>>>>>// $Module type: FUNCTION
76721>>>>>// $Module name: Network_User_Name
76721>>>>>// $Author     : AK/VOO/KCR
76721>>>>>// Created     : 09-24-96 @ 19:17
76721>>>>>//
76721>>>>>// Description
76721>>>>>//    This function reads the current username Of windows and returns that
76721>>>>>//    name or an text unknown user
76721>>>>>//
76721>>>>>// $Rev History
76721>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
76721>>>>>//  07/25/2003  Replaced obsolete code
76721>>>>>//  09/24/1996  Module header created
76721>>>>>//****************************************************************************
76721>>>>>Function Network_User_Name for cDesktop Returns String
76723>>>>>    String sName
76723>>>>>    Integer iRetval iLength
76723>>>>>
76723>>>>>    Move 0 to iLength
76724>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
76725>>>>>    ZeroString iLength to sName
76726>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
76727>>>>>
76727>>>>>    If (iRetval = NO_ERROR) Begin
76729>>>>>        Function_Return (CString (sName))
76730>>>>>    End
76730>>>>>>
76730>>>>>    
76730>>>>>    Function_Return "User Unknown"
76731>>>>>End_Function
76732>>>>>
76732>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
76732>>>>>Type MEMORYSTATUS
76732>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
76732>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
76732>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
76732>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
76732>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
76732>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
76732>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
76732>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
76732>>>>>End_Type // MEMORYSTATUS
76732>>>>>
76732>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
76733>>>>>
76733>>>>>Struct tWinMemoryStatusEx
76733>>>>>    UInteger dwLength                
76733>>>>>    UInteger dwMemoryLoad          
76733>>>>>    UBigInt ullTotalPhys           
76733>>>>>    UBigInt ullAvailPhys           
76733>>>>>    UBigInt ullTotalPageFile       
76733>>>>>    UBigInt ullAvailPageFile       
76733>>>>>    UBigInt ullTotalVirtual        
76733>>>>>    UBigInt ullAvailVirtual        
76733>>>>>    UBigInt ullAvailExtendedVirtual
76733>>>>>End_Struct
76733>>>>>
76733>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
76734>>>>>
76734>>>>>Class SysinfoDisplay is a cTextEdit
76735>>>>>    Procedure Construct_Object
76737>>>>>        Forward Send Construct_Object
76739>>>>>
76739>>>>>        Set Location To 6 6
76740>>>>>        Set Size To 110 255
76741>>>>>        Set Read_Only_State To True
76742>>>>>        Set pbWrap to False
76743>>>>>    End_Procedure
76744>>>>>
76744>>>>>    //****************************************************************************
76744>>>>>    // $Module type: PROCEDURE
76744>>>>>    // $Module name: Show_Current_Directory
76744>>>>>    // $Author     : VOO
76744>>>>>    // Created     : 06-10-96 @ 15:24
76744>>>>>    //
76744>>>>>    // Description
76744>>>>>    //    This method will show the name Of the current directory in the system
76744>>>>>    //    information box
76744>>>>>    //
76744>>>>>    // $Rev History
76744>>>>>    //    06-10-96  Module header created
76744>>>>>    //****************************************************************************
76744>>>>>    Procedure Show_Current_Directory
76746>>>>>        String sDir
76746>>>>>
76746>>>>>        Get_Current_Directory To sDir
76747>>>>>
76747>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
76748>>>>>    End_Procedure
76749>>>>>
76749>>>>>    Procedure Show_Windows_Directory
76751>>>>>        String sWindir
76751>>>>>
76751>>>>>        Get_Windows_Directory To sWindir
76752>>>>>
76752>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
76753>>>>>    End_Procedure
76754>>>>>
76754>>>>>    Procedure Show_Current_User
76756>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
76757>>>>>    End_Procedure
76758>>>>>
76758>>>>>    Procedure Show_Number_Format
76760>>>>>        Integer iFormat
76760>>>>>        String sFormatText
76760>>>>>
76760>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
76763>>>>>        Move (Character (iFormat)) To sFormatText
76764>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
76765>>>>>
76765>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
76768>>>>>        Move (Character (iFormat)) to sFormatText
76769>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
76770>>>>>    End_Procedure
76771>>>>>
76771>>>>>    Procedure Show_Filelist_Name
76773>>>>>        String sFilename
76773>>>>>
76773>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
76776>>>>>
76776>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
76777>>>>>        Send AppendTextLn ""
76778>>>>>    End_Procedure
76779>>>>>
76779>>>>>    Procedure Show_Lock_Delay
76781>>>>>        Integer iLockdelay
76781>>>>>
76781>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
76784>>>>>
76784>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
76785>>>>>    End_Procedure
76786>>>>>
76786>>>>>    Procedure Show_Lock_Timeout
76788>>>>>        Integer iLockTimeout
76788>>>>>
76788>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
76791>>>>>
76791>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
76792>>>>>    End_Procedure
76793>>>>>
76793>>>>>    Procedure Show_Screen_Size
76795>>>>>        Integer iYscreensize iXscreensize
76795>>>>>
76795>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
76796>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
76797>>>>>
76797>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
76798>>>>>    End_Procedure
76799>>>>>
76799>>>>>    Procedure Show_Page_Size
76801>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
76802>>>>>    End_procedure
76803>>>>>
76803>>>>>    Procedure Show_Date
76805>>>>>        Date dToday
76805>>>>>
76805>>>>>        Sysdate dToday
76806>>>>>
76806>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
76807>>>>>    End_procedure
76808>>>>>
76808>>>>>    Procedure Show_Date_Format
76810>>>>>        Integer iDateFormat
76810>>>>>        String sDateFormat
76810>>>>>
76810>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
76813>>>>>        Case Begin
76813>>>>>            Case (iDateFormat = DF_DATE_USA)
76815>>>>>                Move C_$USA To sDateFormat
76816>>>>>                Case Break
76817>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
76820>>>>>                Move C_$European To sDateFormat
76821>>>>>                Case Break
76822>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
76825>>>>>                Move C_$Military To sDateFormat
76826>>>>>                Case Break
76827>>>>>            Case Else
76827>>>>>                Move C_$UnknownDateType To sDateFormat
76828>>>>>                Case Break
76829>>>>>        Case End
76829>>>>>
76829>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
76830>>>>>    End_Procedure
76831>>>>>
76831>>>>>    Procedure Show_Systemresources
76833>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76833>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76833>>>>>        Integer iRetval
76833>>>>>
76833>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
76834>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
76835>>>>>        If (iRetval = 0) Begin
76837>>>>>            Move (ShowLastError ()) to iRetval
76838>>>>>        End
76838>>>>>>
76838>>>>>
76838>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
76839>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
76840>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
76841>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
76842>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
76843>>>>>    End_Procedure
76844>>>>>
76844>>>>>    Procedure Show_Registration
76846>>>>>        String sRegName
76846>>>>>        Integer iSN iMaxUsers
76846>>>>>
76846>>>>>        Registration sRegName iSN
76847>>>>>>
76847>>>>>        
76847>>>>>        Get_Licensed_Max_Users to iMaxUsers
76848>>>>>
76848>>>>>        Send AppendTextLn ""
76849>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
76850>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
76851>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
76852>>>>>    End_Procedure
76853>>>>>
76853>>>>>    //****************************************************************************
76853>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
76853>>>>>    // To the workspace object passing the an object and message To send back
76853>>>>>    // To this object. It is expected that the workspace object will send this
76853>>>>>    // message for every line Of information it wants displayed (passing the
76853>>>>>    // information To be displayed
76853>>>>>    //****************************************************************************
76853>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
76853>>>>>
76853>>>>>    Procedure Show_ServicePack
76855>>>>>        String sKey sVersionDescription sVersion 
76855>>>>>        Handle hoRegistry
76855>>>>>        Boolean bExists bOpened
76855>>>>>        
76855>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
76856>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
76857>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
76858>>>>>
76858>>>>>        Move C_DFVersionRegistryRoot to sKey
76859>>>>>        Get KeyExists of hoRegistry sKey to bExists
76860>>>>>        If (bExists) Begin
76862>>>>>            Get OpenKey of hoRegistry sKey to bOpened
76863>>>>>            If (bOpened) Begin
76865>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
76866>>>>>                If (bExists) Begin
76868>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
76869>>>>>                End
76869>>>>>>
76869>>>>>                
76869>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
76870>>>>>                If (bExists) Begin
76872>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
76873>>>>>                End                
76873>>>>>>
76873>>>>>                Send CloseKey of hoRegistry
76874>>>>>            End
76874>>>>>>
76874>>>>>        End
76874>>>>>>
76874>>>>>        Send Destroy of hoRegistry
76875>>>>>
76875>>>>>        If (sVersionDescription <> "") Begin
76877>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
76878>>>>>           Send AppendTextLn ""
76879>>>>>        End
76879>>>>>>
76879>>>>>    End_Procedure
76880>>>>>    
76880>>>>>
76880>>>>>    Procedure Show_WorkspaceInformation
76882>>>>>        Integer hoWorkspace
76882>>>>>
76882>>>>>        If (ghoApplication <> 0) Begin
76884>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
76885>>>>>            If (hoWorkspace <> 0) Begin
76887>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
76888>>>>>                Send AppendTextLn ""
76889>>>>>            End
76889>>>>>>
76889>>>>>        End
76889>>>>>>
76889>>>>>    End_Procedure
76890>>>>>
76890>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
76892>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
76893>>>>>    End_Function
76894>>>>>
76894>>>>>    Procedure Show_Versions
76896>>>>>        Integer iVersion iRevision iBuild
76896>>>>>
76896>>>>>        Version_Information iVersion iRevision iBuild
76898>>>>>
76898>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
76899>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
76900>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
76901>>>>>    End_Procedure
76902>>>>>    
76902>>>>>    Function CKRevisionNumber String sDriverID Returns String
76904>>>>>        Handle hoCLIHandler
76904>>>>>        Handle hoDFBtrDrvHandler
76904>>>>>        String sCKRevision
76904>>>>>
76904>>>>>
76904>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
76906>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
76907>>>>>            Set psDriverID of hoCLIHandler to sDriverID
76908>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
76909>>>>>            Send Destroy of hoCLIHandler
76910>>>>>        End
76910>>>>>>
76910>>>>>        Else Begin
76911>>>>>            If (sDriverID = "DFBTRDRV") Begin
76913>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
76914>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
76915>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
76916>>>>>                Send Destroy of hoDFBtrDrvHandler
76917>>>>>            End
76917>>>>>>
76917>>>>>        End
76917>>>>>>
76917>>>>>        
76917>>>>>        Function_Return sCKRevision
76918>>>>>    End_Function
76919>>>>>    
76919>>>>>    
76919>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
76921>>>>>        
76921>>>>>        If (sDriverID = "DATAFLEX") Begin
76923>>>>>            Function_Return False
76924>>>>>        End
76924>>>>>>
76924>>>>>    
76924>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
76925>>>>>    End_Function    
76926>>>>>
76926>>>>>
76926>>>>>    //***
76926>>>>>    //*** BW
76926>>>>>    //*** Procedure: Show_Drivers
76926>>>>>    //*** Purpose  : Show loaded database drivers
76926>>>>>    //***
76926>>>>>
76926>>>>>    Procedure Show_Drivers
76928>>>>>        String sCurrentDriver sRevNumber
76928>>>>>        String sLoadedDrivers
76928>>>>>        Integer iNumberOfDrivers iCount
76928>>>>>        Boolean bOK
76928>>>>>
76928>>>>>        Move "" To sLoadedDrivers
76929>>>>>        Get_Attribute DF_NUMBER_DRIVERS To iNumberOfDrivers
76932>>>>>        For iCount From 1 To iNumberOfDrivers
76938>>>>>>
76938>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
76941>>>>>            If (sLoadedDrivers <> "") Begin
76943>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
76944>>>>>            End
76944>>>>>>
76944>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
76945>>>>>            If (bOK) Begin
76947>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
76948>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
76949>>>>>            End
76949>>>>>>
76949>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) To sLoadedDrivers
76950>>>>>        Loop
76951>>>>>>
76951>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
76952>>>>>    End_Procedure
76953>>>>>
76953>>>>>    Procedure Show_HelpFile
76955>>>>>        String sHelpFile
76955>>>>>        Integer eHelpType
76955>>>>>
76955>>>>>        If (ghoApplication <> 0) Begin
76957>>>>>            Get peHelpType Of ghoApplication To eHelpType
76958>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
76960>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
76961>>>>>            End
76961>>>>>>
76961>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
76964>>>>>                Get Help_filename Of Help_object_id To sHelpFile
76965>>>>>            End
76965>>>>>>
76965>>>>>            Else Begin
76966>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
76967>>>>>            End
76967>>>>>>
76967>>>>>
76967>>>>>            Send AppendTextLn ""
76968>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
76969>>>>>        End
76969>>>>>>
76969>>>>>    End_Procedure
76970>>>>>
76970>>>>>    Procedure Show_EnterAsTab
76972>>>>>        Boolean bEnterKeyAsTabKey
76972>>>>>        String sText
76972>>>>>
76972>>>>>        If (ghoApplication <> 0) Begin
76974>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
76975>>>>>            If (bEnterKeyAsTabKey) Begin
76977>>>>>                Move "True" To sText
76978>>>>>            End
76978>>>>>>
76978>>>>>            Else Begin
76979>>>>>                Move "False" To sText
76980>>>>>            End
76980>>>>>>
76980>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
76981>>>>>        End
76981>>>>>>
76981>>>>>    End_Procedure
76982>>>>>
76982>>>>>    //****************************************************************************
76982>>>>>    // $Module type: PROCEDURE
76982>>>>>    // $Module name: Add_Focus
76982>>>>>    // $Author     : VOO
76982>>>>>    // Created     : 24-09-96 @ 19:43
76982>>>>>    //
76982>>>>>    // Description
76982>>>>>    //    During activation we will remove the old information and add the newly
76982>>>>>    //    found systeminformation
76982>>>>>    //
76982>>>>>    // $Rev History
76982>>>>>    //    24-09-96  Module header created
76982>>>>>    //****************************************************************************
76982>>>>>    Procedure Add_Focus Integer hoRoot
76984>>>>>        Forward Send Add_Focus hoRoot
76986>>>>>
76986>>>>>        Send Delete_Data
76987>>>>>
76987>>>>>        Set Changed_State To False
76988>>>>>        Set Read_Only_State To True
76989>>>>>
76989>>>>>        Send Show_ServicePack
76990>>>>>        Send Show_Versions   
76991>>>>>        Send Show_Drivers         
76992>>>>>        Send Show_HelpFile
76993>>>>>        Send Show_Current_Directory
76994>>>>>        Send Show_Filelist_Name          
76995>>>>>        If (ghoApplication <> 0) Begin
76997>>>>>            Send Show_WorkSpaceInformation // added To show WS info
76998>>>>>        End
76998>>>>>>
76998>>>>>        Send Show_Current_User 
76999>>>>>        Send Show_Windows_Directory 
77000>>>>>        Send Show_Screen_Size
77001>>>>>        Send Show_Page_Size
77002>>>>>        Send Show_EnterAsTab        
77003>>>>>        Send Show_Number_Format
77004>>>>>        Send Show_Date_Format
77005>>>>>        Send Show_Lock_Delay
77006>>>>>        Send Show_Lock_Timeout
77007>>>>>        Send Show_Date
77008>>>>>        Send Show_Systemresources
77009>>>>>        Send Show_Registration
77010>>>>>        Send Beginning_of_Data
77011>>>>>
77011>>>>>        Set Icon to 'default.ico'
77012>>>>>    End_Procedure
77013>>>>>End_Class
77014>>>>>
77014>>>>>//****************************************************************************
77014>>>>>// $Module type: OBJECT
77014>>>>>// $Module name: Sysinfo_Dialog
77014>>>>>// $Author     : VOO
77014>>>>>// Created     : 24-09-96 @ 18:47
77014>>>>>//
77014>>>>>// Description
77014>>>>>//    This object shows the systeminformation on the screen
77014>>>>>//
77014>>>>>// $Rev History
77014>>>>>//    24-09-96  Module header created
77014>>>>>//****************************************************************************
77014>>>>>Class SysInfoDialog Is A ModalPanel
77015>>>>>    Procedure Construct_Object
77017>>>>>        Forward Send Construct_Object
77019>>>>>
77019>>>>>        Set Label to C_$SystemInformation
77020>>>>>        Set Size to 140 267
77021>>>>>        Set piMinSize to 140 267
77022>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77023>>>>>        Set Border_Style to Border_Thick
77024>>>>>
77024>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
77026>>>>>            Set peAnchors to anAll
77027>>>>>        End_Object
77028>>>>>
77028>>>>>        Object oCloseButton Is A Button
77030>>>>>            Set Label To C_$Close
77031>>>>>            Set Location To 120 210
77032>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
77033>>>>>            Set Default_State To True
77034>>>>>            Set peAnchors to anBottomRight
77035>>>>>        End_Object
77036>>>>>
77036>>>>>        On_Key kCancel Send Close_Panel
77037>>>>>    End_Procedure
77038>>>>>End_Class
77039>>>>>
77039>>>>>// Purpose:
77039>>>>>//
77039>>>>>// Ken Ross 12/17/96 5:16PM
77039>>>>>//
77039>>>>>Class AboutDialog Is A ModalPanel
77040>>>>>    Procedure Construct_Object
77042>>>>>        String sVdfRootDir
77042>>>>>
77042>>>>>        Forward Send Construct_Object
77044>>>>>
77044>>>>>        Set Label To C_$About
77045>>>>>        Set Size to 89 212
77046>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77047>>>>>
77047>>>>>        Object oSysInfoDialog Is A SysInfoDialog
77049>>>>>        End_Object
77050>>>>>
77050>>>>>        Object oBox Is A Container3d
77052>>>>>            Set Border_Style To Border_StaticEdge
77053>>>>>            Set Size to 63 202
77054>>>>>            Set Location To 4 5
77055>>>>>
77055>>>>>            Object oAboutGraphic Is A BitmapContainer
77057>>>>>                Set Border_Style To Border_None
77058>>>>>                Set Bitmap_Style To Bitmap_Center
77059>>>>>                Set Size To 48 48
77060>>>>>                Set Location To 7 2
77061>>>>>            End_Object
77062>>>>>
77062>>>>>            Object oProductName Is A TextBox
77064>>>>>                Set Label To C_$ProductName
77065>>>>>                Set Size To 10 45
77066>>>>>                Set Location To 8 53
77067>>>>>            End_Object
77068>>>>>
77068>>>>>            Object oVersion Is A TextBox
77070>>>>>                Set Label To C_$Version
77071>>>>>                Set Size To 10 25
77072>>>>>                Set Location To 21 53
77073>>>>>            End_Object
77074>>>>>
77074>>>>>            Object oCopyright Is A TextBox
77076>>>>>                Set Label To C_$Copyright
77077>>>>>                Set Size To 10 31
77078>>>>>                Set Location To 34 53
77079>>>>>            End_Object
77080>>>>>
77080>>>>>            Object oAuthor Is A TextBox
77082>>>>>                Set Label To C_$Author
77083>>>>>                Set Size To 10 22
77084>>>>>                Set Location To 46 53
77085>>>>>            End_Object
77086>>>>>        End_Object
77087>>>>>
77087>>>>>        Object oOKButton Is A Button
77089>>>>>            On_Item C_$OK Send Close_Panel
77090>>>>>            Set Size To 14 50
77091>>>>>            Set Location To 71 157
77092>>>>>        End_Object
77093>>>>>
77093>>>>>        Object oSysInfoButton Is A Button
77095>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
77096>>>>>            Set Size To 14 50
77097>>>>>            Set Location To 71 101
77098>>>>>        End_Object
77099>>>>>
77099>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
77100>>>>>
77100>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
77101>>>>>    End_Procedure
77102>>>>>
77102>>>>>    Procedure Set ProductName String sProductName
77104>>>>>        Set Label Of oProductName To sProductName
77105>>>>>    End_Procedure
77106>>>>>
77106>>>>>    Procedure Set Version String sVersion
77108>>>>>        Set Label Of oVersion To sVersion
77109>>>>>    End_Procedure
77110>>>>>
77110>>>>>    Procedure Set Copyright string sCopyright
77112>>>>>        Set Label Of oCopyright To sCopyright
77113>>>>>    End_Procedure
77114>>>>>
77114>>>>>    Procedure Set Author String sAuthor
77116>>>>>        Set Label Of oAuthor To sAuthor
77117>>>>>    End_Procedure
77118>>>>>
77118>>>>>    Procedure Set Logo string sLogo
77120>>>>>        // square bitmaps Of 42x42 work best
77120>>>>>        Set Bitmap Of oAboutGraphic To sLogo
77121>>>>>    End_Procedure
77122>>>>>
77122>>>>>    Procedure Show_Sysinfo
77124>>>>>        Send Popup_Modal Of oSysinfoDialog
77125>>>>>    End_Procedure
77126>>>>>
77126>>>>>    Procedure End_Construct_Object
77128>>>>>        Handle hoVersionInfo
77128>>>>>        Boolean bIncluded
77128>>>>>        Integer iMajor iMinor iRelease iBuild
77128>>>>>        String sLabel
77128>>>>>
77128>>>>>        Get Label Of oVersion To sLabel
77129>>>>>        If (sLabel = C_$VERSION) Begin
77131>>>>>            // set it To the version info Of the program, if available
77131>>>>>            If (ghoApplication <> 0) Begin
77133>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
77134>>>>>                If (hoVersionInfo <> 0) Begin
77136>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
77137>>>>>                    If (bIncluded) Begin
77139>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
77140>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
77141>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
77142>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
77143>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
77144>>>>>                        Set Version to sLabel
77145>>>>>                    End
77145>>>>>>
77145>>>>>                End
77145>>>>>>
77145>>>>>            End
77145>>>>>>
77145>>>>>        End
77145>>>>>>
77145>>>>>
77145>>>>>        Forward Send End_Construct_Object
77147>>>>>    End_Procedure
77148>>>>>End_Class
77149>>>
77149>>>// *************************************************************************
77149>>>//  Public message. This is the default message. It is expected that you will
77149>>>//   create your own message to override this
77149>>>// *************************************************************************
77149>>>
77149>>>Procedure Activate_About
77152>>>   Send DoAbout "" "" "" "" ""
77153>>>End_Procedure
77154>>>
77154>>>// *************************************************************************
77154>>>//  Public message. It is expected that you will send this message (most
77154>>>//  likely from Activate_About. This creates an about object, activates it
77154>>>//  and destroys it when done. It is not exepected that you will augment this.
77154>>>// *************************************************************************
77154>>>
77154>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
77157>>>        integer hoObj hoMain
77157>>>
77157>>>        // create object
77157>>>        Object About is an AboutDialog
77159>>>            // if no title passed use the label of the main panel
77159>>>            // (if a main panel exists).
77159>>>            if sTitle     eq '' Begin
77161>>>                Get Main_Window of desktop to hoMain
77162>>>                if hoMain Get Label of hoMain to sTitle
77165>>>            end
77165>>>>
77165>>>            set productname to sTitle
77166>>>            set version     to sVersion
77167>>>            set copyright   to sCopyRight
77168>>>            set author      to sAuthor
77169>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
77172>>>            Move self to hoObj // object Id
77173>>>        End_Object
77174>>>        Send Popup   of hoObj    // popup the about object
77175>>>        Send Destroy of hoObj // when done, it will be destroyed
77176>>>End_procedure
77177>        Use AutoEntry.vw
Including file: AutoEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\AutoEntry.vw)
77177>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\AutoEntry.vw
77177>>>// AutoEntry
77177>>>//
77177>>>
77177>>>Use DFClient.pkg
77177>>>Use DFEntry.pkg
77177>>>
77177>>>Use cAutoDataDictionary.dd
Including file: cAutoDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cAutoDataDictionary.dd)
77177>>>>>Use DataDict.pkg
77177>>>>>
77177>>>>>Open Auto
Including file: Auto.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\Auto.fd)
77179>>>>>Open Fuvarlevel
Including file: Fuvarlevel.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\Fuvarlevel.fd)
77181>>>>>
77181>>>>>Class cAutoDataDictionary is a DataDictionary
77182>>>>>    
77182>>>>>    Procedure Construct_Object
77184>>>>>        Forward Send Construct_Object
77186>>>>>        Set Main_File to Auto.File_Number
77187>>>>>
77187>>>>>        Set Add_Client_File to Fuvarlevel.File_Number
77188>>>>>
77188>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77189>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77190>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77191>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77192>>>>>
77192>>>>>        Set Field_Option Field Auto.auto_rendszam DD_AUTOFIND to True
77193>>>>>        Set Field_Mask Field Auto.auto_rendszam to "@@@-###"
77194>>>>>        Set Key_Field_State Field Auto.auto_rendszam to True
77195>>>>>
77195>>>>>    End_Procedure
77196>>>>>
77196>>>>>End_Class
77197>>>
77197>>>ACTIVATE_VIEW Activate_oAutoEntry FOR oAutoEntry
77207>>>>
77207>>>Object oAutoEntry is a dbView
77209>>>    Set Location to 5 5
77210>>>    Set Size to 38 247
77211>>>    Set Label To "AutoEntry"
77212>>>    Set Border_Style to Border_Thick
77213>>>
77213>>>
77213>>>    Object oAuto_DD is a cAutoDataDictionary
77215>>>    End_Object 
77216>>>
77216>>>    Set Main_DD To oAuto_DD
77217>>>    Set Server  To oAuto_DD
77218>>>
77218>>>
77218>>>
77218>>>    Object oAutoauto_rendszam is a dbForm
77220>>>        Entry_Item Auto.auto_rendszam
77221>>>        Set Size to 13 48
77222>>>        Set Location to 5 56
77223>>>        Set peAnchors to anTopLeftRight
77224>>>        Set Label to "Rendsz m"
77225>>>        Set Label_Justification_mode to jMode_Left
77226>>>        Set Label_Col_Offset to 51
77227>>>        Set Label_row_Offset to 0
77228>>>    End_Object 
77229>>>
77229>>>    Object oAutoauto_tipus is a dbForm
77231>>>        Entry_Item Auto.auto_tipus
77232>>>        Set Size to 13 186
77233>>>        Set Location to 20 56
77234>>>        Set peAnchors to anTopLeftRight
77235>>>        Set Label to "T¡pus"
77236>>>        Set Label_Justification_mode to jMode_Left
77237>>>        Set Label_Col_Offset to 51
77238>>>        Set Label_row_Offset to 0
77239>>>    End_Object 
77240>>>
77240>>>
77240>>>End_Object 
77241>        Use SoforEntry.vw
Including file: SoforEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\SoforEntry.vw)
77241>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\SoforEntry.vw
77241>>>// SoforEntry
77241>>>//
77241>>>
77241>>>Use DFClient.pkg
77241>>>Use DFEntry.pkg
77241>>>
77241>>>Use cSoforDataDictionary.dd
Including file: cSoforDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cSoforDataDictionary.dd)
77241>>>>>Use DataDict.pkg
77241>>>>>
77241>>>>>Open Sofor
Including file: Sofor.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\Sofor.fd)
77243>>>>>Open Fuvarlevel
77245>>>>>Open system_table
Including file: system_table.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\system_table.fd)
77247>>>>>
77247>>>>>Class cSoforDataDictionary is a DataDictionary
77248>>>>>    
77248>>>>>    Procedure Construct_Object
77250>>>>>        Forward Send Construct_Object
77252>>>>>        Set Main_File to Sofor.File_Number
77253>>>>>
77253>>>>>        Set Add_Client_File to Fuvarlevel.File_Number
77254>>>>>
77254>>>>>        Set Add_System_File to system_table.File_Number DD_Lock_On_All
77255>>>>>
77255>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77256>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77257>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77258>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77259>>>>>
77259>>>>>        Set Field_Option Field Sofor.sofor_azonosito DD_AUTOFIND to True
77260>>>>>        Set Field_Auto_Increment Field Sofor.sofor_azonosito to File_Field system_table.sofor_azonosito
77261>>>>>        Set Key_Field_State Field Sofor.sofor_azonosito to True
77262>>>>>
77262>>>>>        Set Field_Label_Long Field Sofor.sofor_nev to "Sof‹r neve"
77263>>>>>        Set Field_Label_Short Field Sofor.sofor_nev to "N‚v"
77264>>>>>
77264>>>>>    End_Procedure
77265>>>>>
77265>>>>>End_Class
77266>>>
77266>>>ACTIVATE_VIEW Activate_oSoforEntry FOR oSoforEntry
77276>>>>
77276>>>Object oSoforEntry is a dbView
77278>>>    Set Location to 5 5
77279>>>    Set Size to 38 236
77280>>>    Set Label To "SoforEntry"
77281>>>    Set Border_Style to Border_Thick
77282>>>
77282>>>
77282>>>    Object oSofor_DD is a cSoforDataDictionary
77284>>>    End_Object 
77285>>>
77285>>>    Set Main_DD To oSofor_DD
77286>>>    Set Server  To oSofor_DD
77287>>>
77287>>>
77287>>>
77287>>>    Object oSoforsofor_nev is a dbForm
77289>>>        Entry_Item Sofor.sofor_nev
77290>>>        Set Size to 13 186
77291>>>        Set Location to 5 45
77292>>>        Set peAnchors to anTopLeftRight
77293>>>        Set Label to "sofor nev"
77294>>>        Set Label_Justification_mode to jMode_Left
77295>>>        Set Label_Col_Offset to 40
77296>>>        Set Label_row_Offset to 0
77297>>>    End_Object 
77298>>>
77298>>>    Object oSoforsofor_szigsz is a dbForm
77300>>>        Entry_Item Sofor.sofor_szigsz
77301>>>        Set Size to 13 78
77302>>>        Set Location to 20 45
77303>>>        Set peAnchors to anTopLeftRight
77304>>>        Set Label to "sofor szigsz"
77305>>>        Set Label_Justification_mode to jMode_Left
77306>>>        Set Label_Col_Offset to 40
77307>>>        Set Label_row_Offset to 0
77308>>>    End_Object 
77309>>>
77309>>>
77309>>>End_Object 
77310>        Use TermekEntry.vw
Including file: TermekEntry.vw    (C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\TermekEntry.vw)
77310>>>// C:\DataFlex Projects\DataFlex_FF_2017\AppSrc\TermekEntry.vw
77310>>>// Term‚k
77310>>>//
77310>>>
77310>>>Use DFClient.pkg
77310>>>Use DFEntry.pkg
77310>>>
77310>>>Use cTermekDataDictionary.dd
Including file: cTermekDataDictionary.dd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\cTermekDataDictionary.dd)
77310>>>>>Use DataDict.pkg
77310>>>>>
77310>>>>>Open Termek
Including file: Termek.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\Termek.fd)
77312>>>>>Open FuvarlevelTetel
Including file: FuvarlevelTetel.fd    (C:\DataFlex Projects\DataFlex_FF_2017\DDSrc\FuvarlevelTetel.fd)
77314>>>>>Open system_table
77316>>>>>
77316>>>>>Class cTermekDataDictionary is a DataDictionary
77317>>>>>    
77317>>>>>    Procedure Construct_Object
77319>>>>>        Forward Send Construct_Object
77321>>>>>        Set Main_File to Termek.File_Number
77322>>>>>
77322>>>>>        Set Add_System_File to system_table.File_Number DD_Lock_On_All
77323>>>>>
77323>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77324>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77325>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77326>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77327>>>>>
77327>>>>>        Set Field_Option Field Termek.termek_azonosito DD_AUTOFIND to True
77328>>>>>        Set Field_Auto_Increment Field Termek.termek_azonosito to File_Field system_table.termek_azonosito
77329>>>>>        Set Key_Field_State Field Termek.termek_azonosito to True
77330>>>>>
77330>>>>>        Set Field_Label_Long Field Termek.termek_megnevezes to "N‚v"
77331>>>>>        Set Field_Label_Short Field Termek.termek_megnevezes to "N‚v"
77332>>>>>
77332>>>>>        Set Field_Label_Long Field Termek.termek_egysegar to "Egys‚g r (Ft)"
77333>>>>>        Set Field_Label_Short Field Termek.termek_egysegar to "µr (Ft)"
77334>>>>>
77334>>>>>    End_Procedure
77335>>>>>
77335>>>>>End_Class
77336>>>
77336>>>ACTIVATE_VIEW Activate_oTermekEntry FOR oTermekEntry
77346>>>>
77346>>>Object oTermekEntry is a dbView
77348>>>    Set Location to 5 5
77349>>>    Set Size to 38 241
77350>>>    Set Label To "Term‚k"
77351>>>    Set Border_Style to Border_Thick
77352>>>
77352>>>
77352>>>    Object oTermek_DD is a cTermekDataDictionary
77354>>>    End_Object 
77355>>>
77355>>>    Set Main_DD To oTermek_DD
77356>>>    Set Server  To oTermek_DD
77357>>>
77357>>>
77357>>>
77357>>>    Object oTermektermek_megnevezes is a dbForm
77359>>>        Entry_Item Termek.termek_megnevezes
77360>>>        Set Size to 13 186
77361>>>        Set Location to 5 50
77362>>>        Set peAnchors to anTopLeftRight
77363>>>        Set Label to "N‚v"
77364>>>        Set Label_Justification_mode to jMode_Left
77365>>>        Set Label_Col_Offset to 45
77366>>>        Set Label_row_Offset to 0
77367>>>    End_Object 
77368>>>
77368>>>    Object oTermektermek_egysegar is a dbForm
77370>>>        Entry_Item Termek.termek_egysegar
77371>>>        Set Size to 13 42
77372>>>        Set Location to 20 50
77373>>>        Set peAnchors to anTopLeftRight
77374>>>        Set Label to "Egys‚g r (Ft)"
77375>>>        Set Label_Justification_mode to jMode_Left
77376>>>        Set Label_Col_Offset to 45
77377>>>        Set Label_row_Offset to 0
77378>>>    End_Object 
77379>>>
77379>>>
77379>>>End_Object 
77380>
77380>        Procedure Activate_About
77383>            Send DoAbout "" "" "" "" ""
77384>        End_Procedure
77385>
77385>    End_Object
77386>
77386>End_Object
77387>
77387>Start_UI
77388>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 44376
Total Resources: 0
Total Commands : 77387
Total Windows  : 1
Total Pages    : 1
Static Data    : 467943
Message area   : 534296
Total Blocks   : 27776
